{"version":3,"sources":["useWSDataSource.js","Logo.js","LoadingScreen.js","index.js","utils.js"],"names":["reducer","state","msg","updatedState","concat","Object","toConsumableArray","console","groupCollapsed","length","table","groupEnd","useWSDataSource","url","websocket","React","useRef","_React$useState","useState","_React$useState2","slicedToArray","isConnected","setConnected","_React$useState3","_React$useState4","isErrored","setErrored","_React$useReducer","useReducer","_React$useReducer2","messages","appendMessage","_React$useState5","_React$useState6","persona","setPersona","_React$useState7","_React$useState8","location","setLocation","_React$useState9","_React$useState10","agents","setAgents","handleMessage","useCallback","cmd","JSON","parse","data","command","buffer","forEach","action","isPersonaDescription","caller","isLocationDescription","room","actor","name","description","id","node_id","desc","push","useEffect","current","onmessage","submitMessage","txt","text","is_self","actors","stringify","send","WebSocket","onopen","log","onerror","onclose","Logo","react_default","a","createElement","className","alt","src","LoadingScreen","isTimedOut","setTimedOut","timer","setTimeout","TIMEOUT_SECONDS","clearTimeout","style","height","width","display","alignItems","justifyContent","flexDirection","fontSize","marginTop","fontStyle","createWebSocketUrlFromBrowserUrl","wsProtocol","protocol","optionalServerHost","URL","searchParams","get","hostname","getDataModelAddress","window","Setting","props","clear","overflow","split","map","para","idx","key","Message","_ref","isSelf","onReply","isEditMode","setEditMode","classNames","includes","Fragment","onClick","opacity","pointerEvents","defaultValue","type","react_tippy","title","position","Entry","_ref2","selfId","ConnectedApp","_useWSDataSource","useMemo","textAlign","src_LoadingScreen","Chat","onSubmit","_ref3","enteredText","setEnteredText","chatContainerRef","getEntityId","agent","match","dataModelHost","scrollToBottom","scrollTop","scrollHeight","presentAgents","valid_messages","filter","m","lastMessage","currentRoom","room_id","present_agent_ids","getLocationState","showEmojiPicker","setShowEmojiPicker","selectedEmoji","setSelectedEmoji","chatInputRef","useLayoutEffect","focus","skipWords","tryPickEmojis","token","replace","word","indexOf","toLowerCase","flatMap","term","emojiIndex","search","o","native","autopickedEmoji","setTextTellAgent","message","elem","caretPos","createTextRange","range","move","select","selectionStart","setSelectionRange","setCaretPosition","cx","editing","cursor","role","aria-label","top","left","transform","zIndex","BlurClosingPicker","autoFocus","onBlur","onSelect","emoji","bottom","right","href","rel","target","aria-hidden","ref","e","preventDefault","value","onChange","onKeyPress","shiftKey","prefix","startsWith","suffix","endsWith","placeholder","float","agentName","getAgentName","agentId","backgroundColor","borderRadius","padding","marginRight","fadeShow","EmojiPicker","_ref4","objectWithoutProperties","handleClickOutside","dist_es","onClickOutside","rootElement","document","getElementById","ReactDOM","render"],"mappings":"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","file":"static/js/main.b534cc68.chunk.js","sourcesContent":["import React from \"react\";\nimport { zipToObject } from \"./utils\";\n\nconst reducer = (state, msg) => {\n  const updatedState = [...state, msg];\n  console.groupCollapsed(\"New message. Total: \" + updatedState.length);\n  console.table(updatedState);\n  console.groupEnd();\n  return updatedState;\n};\n\nexport function useWSDataSource(url) {\n  const websocket = React.useRef();\n  const [isConnected, setConnected] = React.useState(false);\n  const [isErrored, setErrored] = React.useState(false);\n  const [messages, appendMessage] = React.useReducer(reducer, []);\n  const [persona, setPersona] = React.useState(null);\n  const [location, setLocation] = React.useState(null);\n  const [agents, setAgents] = React.useState({});\n\n  const handleMessage = React.useCallback(\n    msg => {\n      const cmd = JSON.parse(msg.data);\n      if (cmd.command === \"actions\") {\n        const buffer = [];\n\n        cmd.data.forEach(action => {\n          const isRespawn = false; /* action.text.startsWith(\n            \"Your lost soul attempts to join the living...\"\n          );*/\n          const isPersonaDescription = action.caller === \"SpawnEvent\";\n          const isLocationDescription = action.caller === \"LookEvent\";\n          const hasUpdatedAgentsInfo = false; //!!action.present_agent_ids;\n\n          action.room = JSON.parse(action.room)\n          action.actor = JSON.parse(action.actor)\n\n          if (hasUpdatedAgentsInfo) {\n            setAgents(\n              zipToObject(action.room_agents[0], action.room_agents[1])\n            );\n          }\n          if (isPersonaDescription) {\n            setPersona({\n              name: action.actor.name,\n              description: action.actor.persona,\n              id: action.actor.node_id\n            });\n            if (isRespawn) {\n              buffer.push(action);\n            }\n            return;\n          } else if (isLocationDescription) {\n            setLocation({\n              name: action.room.name,\n              description:\n                action.room.desc +\n                \"\\n\" +\n                \"You notice: \" +\n                \"TODO add examine stuff here\" + \n                \".\",\n              id: action.room.node_id\n            });\n            buffer.push(action);\n          } else {\n            buffer.push(action);\n          }\n\n          buffer.forEach(msg => appendMessage(msg));\n        });\n      }\n    },\n    [appendMessage, setPersona, setAgents, setLocation]\n  );\n\n  React.useEffect(() => {\n    websocket.current.onmessage = handleMessage;\n  }, [handleMessage]);\n\n  const submitMessage = React.useCallback(\n    txt => {\n      appendMessage({\n        caller: \"say\",\n        text: txt,\n        is_self: true,\n        actors: [persona.id]\n      });\n\n      const msg = JSON.stringify({ command: \"act\", data: txt });\n      return websocket.current.send(msg);\n    },\n    [websocket, appendMessage, persona]\n  );\n\n  if (!websocket.current) {\n    websocket.current = new WebSocket(url);\n\n    // websocket.current.onmessage = handleMessage;\n\n    websocket.current.onopen = () => {\n      console.log(\"opened\");\n      setConnected(true);\n    };\n\n    websocket.current.onerror = websocket.current.onclose = () => {\n      console.log(\"errored\");\n      setConnected(false);\n      setErrored(true);\n      websocket.current = null;\n    };\n  }\n\n  return {\n    isConnected,\n    messages,\n    submitMessage,\n    persona,\n    location,\n    isErrored,\n    agents\n  };\n}\n","import React from \"react\";\n\nexport default function Logo() {\n  return (\n    <div className=\"header\">\n      <img alt=\"logo\" src=\"/scribe.png\" />\n      <div>\n        <h1>LIGHT</h1>\n        <span>Learning in Interactive Games with Humans and Text</span>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport Logo from \"./Logo\";\n\nfunction LoadingScreen() {\n  const [isTimedOut, setTimedOut] = React.useState(false);\n  const TIMEOUT_SECONDS = 10;\n\n  React.useEffect(() => {\n    if (!isTimedOut) {\n      const timer = setTimeout(() => {\n        setTimedOut(true);\n      }, TIMEOUT_SECONDS * 1000);\n      return () => clearTimeout(timer);\n    }\n  }, [isTimedOut, setTimedOut]);\n\n  return (\n    <div\n      style={{\n        height: \"100vh\",\n        width: \"100vw\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        flexDirection: \"column\"\n      }}\n    >\n      <div style={{ width: 500 }}>\n        <div style={{ width: 300 }}>\n          <Logo />\n        </div>\n        <div style={{ fontSize: 20, marginTop: 50, fontStyle: \"italic\" }}>\n          {isTimedOut ? (\n            <span>\n              It's been {TIMEOUT_SECONDS} seconds, there's likely a server\n              issue.\n            </span>\n          ) : (\n            <span>Hang tight. You are entering a new world...</span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default LoadingScreen;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./styles.css\";\nimport \"react-tippy/dist/tippy.css\";\nimport \"emoji-mart/css/emoji-mart.css\";\n\nimport { Tooltip } from \"react-tippy\";\nimport { Picker, emojiIndex } from \"emoji-mart\";\nimport cx from \"classnames\";\nimport onClickOutside from \"react-onclickoutside\";\n\nimport { useWSDataSource } from \"./useWSDataSource\";\nimport Logo from \"./Logo\";\nimport LoadingScreen from \"./LoadingScreen\";\n\nimport { setCaretPosition } from \"./utils\";\n\nconst port = 35496;\nconst createWebSocketUrlFromBrowserUrl = url => {\n  const wsProtocol = url.protocol === \"https:\" ? \"wss\" : \"ws\";\n  const optionalServerHost = new URL(url).searchParams.get(\"server\");\n  if (optionalServerHost) {\n    console.log(\"Using user-provided server hostname:\", optionalServerHost);\n  }\n  const websocketURL =\n    wsProtocol + \"://\" + (optionalServerHost || url.hostname) + \":\" + port + \"/socket\";\n  return websocketURL;\n};\n\nconst getDataModelAddress = () => {\n  return new URL(window.location).searchParams.get(\"data-model\");\n};\n\n// TODO: consider showing different agent's dialogues in\n// different colors\n//\n// const colors = [\n//   \"#edfff1\", //green,\n//   \"#fffded\", //yellow,\n//   \"#eee8ff\", // purple\n//   \"#e6efff\", //blue\n//   \"#ffe8eb\" //red\n// ];\n\nfunction Setting(props) {\n  return (\n    <div style={{ clear: \"both\", overflow: \"auto\" }}>\n      <div className=\"message type-setting\">\n        {props.text.split(\"\\n\").map((para, idx) => (\n          <p key={idx}>{para}</p>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction Message({ text, caller, actor, isSelf, onReply }) {\n  const [isEditMode, setEditMode] = React.useState(false);\n\n  let classNames = \"message type-dialogue \";\n  if ([\"tell\", \"say\", \"whisper\"].includes(caller)) {\n    text = \"&ldquo;\" + text + \"&rdquo;\";\n    classNames = \"message type-dialogue \";\n  }\n  classNames += isSelf ? \"me\" : \"other\";\n\n  if (isEditMode) {\n    return (\n      <div className={classNames}>\n        <div className=\"agent\">\n          <span>{actor}</span>\n          {isSelf ? null : (\n            <React.Fragment>\n              <i className=\"fa fa-reply\" onClick={() => onReply(actor)} />{\" \"}\n              <i\n                className=\"fa fa-commenting-o \"\n                onClick={() => setEditMode(true)}\n              />\n            </React.Fragment>\n          )}\n        </div>\n        <div style={{ opacity: 0, height: 1, pointerEvents: \"none\" }}>\n          {text}\n        </div>\n        <input className=\"edit-message\" defaultValue={text} />\n        <button type=\"submit\" onClick={() => setEditMode(false)}>\n          Suggest edit\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className={classNames}>\n      <div className=\"agent\">\n        <span>{actor}</span>\n        {isSelf ? null : (\n          <React.Fragment>\n            <Tooltip title={`tell ${actor}...`} position=\"top\">\n              <i className=\"fa fa-reply\" onClick={() => onReply(actor)} />\n            </Tooltip>{\" \"}\n            <Tooltip\n              title={`Do you think something else should have been said instead? Provide feedback via an edit...`}\n              position=\"top\"\n            >\n              <i\n                className=\"fa fa-commenting-o \"\n                onClick={() => setEditMode(true)}\n              />\n            </Tooltip>\n          </React.Fragment>\n        )}\n      </div>\n      {text}\n    </div>\n  );\n}\n\nfunction Entry({ msg, onReply, agents, selfId }) {\n  if ([\"LookEvent\", \"GoEvent\", \"ExamineEvent\", \"text\"].includes(msg.caller) || msg.caller === null) {\n    return <Setting text={msg.text} />;\n  } else {\n    return (\n      <Message\n        text={msg.text}\n        isSelf={msg.is_self || msg.actors[0] === selfId}\n        actor={agents[msg.actors[0]]}\n        onReply={onReply}\n      />\n    );\n  }\n}\n\nfunction ConnectedApp() {\n  const wsUrl = React.useMemo(\n    () => createWebSocketUrlFromBrowserUrl(window.location),\n    []\n  );\n  const {\n    isErrored,\n    messages,\n    submitMessage,\n    persona,\n    location,\n    agents\n  } = useWSDataSource(wsUrl);\n\n  if (isErrored)\n    return (\n      <div style={{ textAlign: \"center\", marginTop: 30, fontSize: 30 }}>\n        Could not connect to the server.\n      </div>\n    );\n\n  if (messages.length === 0) {\n    return <LoadingScreen />;\n  }\n\n  return (\n    <Chat\n      messages={messages}\n      onSubmit={submitMessage}\n      persona={persona}\n      // persona={{ name: \"a cow\" }}\n      location={location}\n      agents={agents}\n    />\n  );\n}\nfunction Chat({ messages, onSubmit, persona, location, agents }) {\n  const [enteredText, setEnteredText] = React.useState(\"\");\n  const chatContainerRef = React.useRef(null);\n  const getAgentName = agent => (agents ? agents[agent] : agent);\n  const getEntityId = agent => agent.match(/\\d+$/)[0];\n  const dataModelHost = getDataModelAddress();\n\n  const scrollToBottom = React.useCallback(\n    () =>\n      setTimeout(() => {\n        if (chatContainerRef.current)\n          chatContainerRef.current.scrollTop =\n            chatContainerRef.current.scrollHeight;\n      }, 0),\n    [chatContainerRef]\n  );\n\n  React.useEffect(() => {\n    scrollToBottom();\n  }, [scrollToBottom, messages]);\n\n  const defaultEmoji = \"â“\";\n  const { presentAgents } = getLocationState(messages);\n  const [showEmojiPicker, setShowEmojiPicker] = React.useState(false);\n  const [selectedEmoji, setSelectedEmoji] = React.useState(defaultEmoji);\n\n  const chatInputRef = React.useRef();\n  React.useLayoutEffect(() => {\n    chatInputRef.current.focus();\n  }, []);\n\n  React.useEffect(() => {\n    if (persona === null || persona.name === null) return;\n    const skipWords = [\"a\", \"the\", \"an\", \"of\", \"with\", \"holding\"];\n    const tryPickEmojis = !persona\n      ? []\n      : persona.name\n          .split(\" \")\n          .filter(token => !!token)\n          .map(token => token.replace(/\\.$/, \"\"))\n          .filter(word => skipWords.indexOf(word.toLowerCase()) === -1)\n          .flatMap(term =>\n            emojiIndex.search(term).map(o => {\n              return o.native;\n            })\n          );\n\n    const autopickedEmoji =\n      tryPickEmojis.length > 0 ? tryPickEmojis[0] : defaultEmoji;\n    setSelectedEmoji(autopickedEmoji);\n  }, [persona, setSelectedEmoji]);\n\n  const setTextTellAgent = React.useCallback(\n    agent => {\n      const message = `tell ${agent} \"\"`;\n      setEnteredText(message);\n      setTimeout(\n        () => setCaretPosition(chatInputRef.current, message.length - 1),\n        0 /* 0s timeout to schedule this task to occur after the layout is updated */\n      );\n    },\n    [setEnteredText, chatInputRef]\n  );\n\n  // console.log(selectedEmoji);\n  return (\n    <div className=\"App\">\n      <div className=\"sidebar\">\n        <Logo />\n        <div className=\"game-state\">\n          {persona ? (\n            <div className=\"persona\">\n              <div\n                className={cx(\"icon\", { editing: showEmojiPicker })}\n                style={{ cursor: \"pointer\" }}\n              >\n                <div className=\"overlay\">edit</div>\n                <span\n                  role=\"img\"\n                  aria-label=\"avatar\"\n                  onClick={() => setShowEmojiPicker(true)}\n                >\n                  {selectedEmoji}\n                </span>\n                {showEmojiPicker ? (\n                  <div\n                    style={{\n                      position: \"absolute\",\n                      top: \"80px\",\n                      left: \"50%\",\n                      transform: \"translateX(-50%)\",\n                      zIndex: 999\n                    }}\n                  >\n                    <BlurClosingPicker\n                      autoFocus={true}\n                      onBlur={() => setShowEmojiPicker(false)}\n                      onSelect={emoji => {\n                        // TODO: Send the selected emoji to the back-end so we can keep record it\n                        setSelectedEmoji(emoji.native);\n                        setShowEmojiPicker(false);\n                      }}\n                    />\n                  </div>\n                ) : null}\n              </div>\n              <h3>You are {persona.name}</h3>\n              {persona.description}\n              {dataModelHost && (\n                <Tooltip\n                  style={{ position: \"absolute\", bottom: 0, right: 5 }}\n                  title={`suggest changes for ${persona.name}`}\n                  position=\"bottom\"\n                >\n                  <a\n                    className=\"data-model-deep-link\"\n                    href={`${dataModelHost}/edit/${getEntityId(persona.id)}`}\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\"\n                  >\n                    <i className=\"fa fa-edit\" aria-hidden=\"true\" />\n                  </a>\n                </Tooltip>\n              )}\n            </div>\n          ) : null}\n          {location ? (\n            <div className=\"location\">\n              <h3>{location.name}</h3>\n              {location.description.split(\"\\n\").map((para, idx) => (\n                <p key={idx}>{para}</p>\n              ))}\n              {dataModelHost && (\n                <Tooltip\n                  style={{ position: \"absolute\", bottom: 0, right: 5 }}\n                  title={`suggest changes for ${\n                    location.name.split(\" the \")[1]\n                  }`}\n                  position=\"bottom\"\n                >\n                  <a\n                    className=\"data-model-deep-link\"\n                    href={`${dataModelHost}/edit/${getEntityId(location.id)}`}\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\"\n                  >\n                    <i className=\"fa fa-edit\" aria-hidden=\"true\" />\n                  </a>\n                </Tooltip>\n              )}\n            </div>\n          ) : null}\n        </div>\n        {/* <Map /> */}\n        {/* <div className=\"app-controls\">\n          <label>\n            <input\n              type=\"checkbox\"\n              checked={isAdminMode}\n              onChange={e => setAdminMode(!isAdminMode)}\n            />{\" \"}\n            Admin Mode\n          </label>\n        </div> */}\n      </div>\n      <div className=\"chat-wrapper\">\n        <div className=\"chat\" ref={chatContainerRef}>\n          <div className=\"chatlog\">\n            {messages.map((msg, idx) => (\n              <Entry\n                key={idx}\n                msg={msg}\n                agents={agents}\n                onReply={agent => setTextTellAgent(agent)}\n                selfId={persona.id}\n              />\n            ))}\n          </div>\n        </div>\n        <div className=\"controls\">\n          <form\n            style={{ display: \"flex\" }}\n            onSubmit={e => {\n              e.preventDefault();\n\n              if (!!enteredText) {\n                onSubmit(enteredText);\n                setEnteredText(\"\");\n                scrollToBottom();\n              }\n            }}\n          >\n            <input\n              ref={chatInputRef}\n              value={enteredText}\n              onChange={e => setEnteredText(e.target.value)}\n              onKeyPress={e => {\n                if (e.key === \"Enter\" && e.shiftKey) {\n                  const prefix = e.target.value.startsWith('\"') ? \"\" : '\"';\n                  const suffix = e.target.value.endsWith('\"') ? \"\" : '\"';\n                  setEnteredText(prefix + e.target.value + suffix);\n                }\n              }}\n              className=\"chatbox\"\n              placeholder=\"Enter text to interact with the world here...\"\n            />\n          </form>\n          <div className=\"actions\">\n            <div style={{ float: \"left\" }}>\n              {/* {location ? <span>{location.name} &mdash; </span> : null} */}\n              {presentAgents\n                .filter(id => id !== persona.id) // only show users other than self\n                .map(agent => {\n                  const agentName = getAgentName(agent);\n                  const agentId = getEntityId(agent);\n                  return (\n                    <span\n                      key={agentName}\n                      style={{\n                        backgroundColor: \"#eee\",\n                        borderRadius: 3,\n                        padding: \"1px 3px\",\n                        marginRight: 5\n                      }}\n                    >\n                      <span\n                        onClick={() => {\n                          setTextTellAgent(agentName);\n                        }}\n                      >\n                        {agentName}{\" \"}\n                        <Tooltip\n                          title={`tell ${agentName}...`}\n                          position=\"bottom\"\n                        >\n                          <i className=\"fa fa-comment-o\" aria-hidden=\"true\" />\n                        </Tooltip>\n                      </span>\n                      {dataModelHost && (\n                        <>\n                          {\" \"}\n                          <Tooltip\n                            title={`suggest changes for ${agentName}`}\n                            position=\"bottom\"\n                          >\n                            <a\n                              className=\"data-model-deep-link\"\n                              href={`${dataModelHost}/edit/${agentId}`}\n                              rel=\"noopener noreferrer\"\n                              target=\"_blank\"\n                            >\n                              <i className=\"fa fa-edit\" aria-hidden=\"true\" />\n                            </a>\n                          </Tooltip>\n                        </>\n                      )}\n                    </span>\n                  );\n                })}\n            </div>\n\n            <div\n              style={{\n                display: \"flex\",\n                alignItems: \"center\",\n                float: \"right\"\n              }}\n            >\n              <span\n                className={cx(\"hint-message\", \"fadeHidden\", {\n                  fadeShow: enteredText.length > 0 && enteredText[0] === '\"'\n                })}\n              >\n                Tip: Hit Shift+Enter to auto-wrap your entry in quotes\n              </span>\n            </div>\n\n            {[\n              // \"act\",\n              // \"say\",\n              // \"tell\"\n              // \"whisper\",\n              // \"applaud\",\n              // \"blush\",\n              // \"cry\",\n              // \"dance\",\n              // \"frown\",\n              // \"gasp\",\n              // \"grin\",\n              // \"groan\",\n              // \"growl\",\n              // \"laugh\",\n              // \"nod\",\n              // \"nudge\",\n              // \"ponder\",\n              // \"pout\",\n              // \"scream\",\n              // \"shrug\",\n              // \"sigh\",\n              // \"smile\",\n              // \"stare\",\n              // \"wave\",\n              // \"wink\",\n              // \"yawn\"\n            ].map(action => (\n              <span className=\"action\" key={action}>\n                {action}\n              </span>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst EmojiPicker = ({ onBlur, ...props }) => {\n  EmojiPicker.handleClickOutside = () => onBlur();\n  return <Picker {...props} />;\n};\nconst BlurClosingPicker = onClickOutside(EmojiPicker, {\n  handleClickOutside: () => EmojiPicker.handleClickOutside\n});\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<ConnectedApp />, rootElement);\n\nfunction getLocationState(messages) {\n  var valid_messages = messages.filter(\n    m => m.is_self !== true && m.caller !== null\n  );\n  if (valid_messages.length === 0) return [null, []];\n  var lastMessage = valid_messages[valid_messages.length - 1];\n\n  return {\n    currentRoom: lastMessage.room_id,\n    presentAgents: lastMessage.present_agent_ids\n  };\n}\n","export function zipToObject(keys, values) {\n  return keys.reduce((obj, k, i) => ({ ...obj, [k]: values[i] }), {});\n}\n\nexport function setCaretPosition(elem, caretPos) {\n  /* inspired from: https://stackoverflow.com/a/512542 */\n  if (elem != null) {\n    if (elem.createTextRange) {\n      var range = elem.createTextRange();\n      range.move(\"character\", caretPos);\n      range.select();\n    } else {\n      if (elem.selectionStart) {\n        elem.focus();\n        elem.setSelectionRange(caretPos, caretPos);\n      } else elem.focus();\n    }\n  }\n}\n"],"sourceRoot":""}