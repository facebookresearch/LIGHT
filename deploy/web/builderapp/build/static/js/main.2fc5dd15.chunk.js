(this["webpackJsonplight-datamodel"]=this["webpackJsonplight-datamodel"]||[]).push([[0],{169:function(e,t,a){e.exports=a(258)},174:function(e,t,a){},258:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(13),l=a.n(i),c=(a(174),a(22)),o=a(17),s=a(6),d=a(48),m=a(53),u=a(12);var p=function(e){var t=e.setPopover,a=r.a.useRef(),n=r.a.useState(void 0),i=Object(s.a)(n,2),l=i[0],c=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{onChange:function(e){c(void 0);var a=new FileReader;a.onload=function(e){c(JSON.parse(e.target.result))};var n=e.target.files[0];a.readAsText(n),t(!1)},type:"file",ref:a,style:{display:"none"}}),l&&r.a.createElement(o.a,{to:{pathname:"/world_builder",state:{data:l}}}),r.a.createElement(d.m,{icon:"upload",onClick:function(){return a.current.click()},text:"Upload File",shouldDismissPopover:!1}))};var b=function(e){var t=e.children,a=r.a.useState(!1),n=Object(s.a)(a,2),i=n[0],l=n[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.n,null,r.a.createElement(d.n.Group,{align:m.a.LEFT},r.a.createElement(d.n.Heading,null,"LIGHT Data Model"),r.a.createElement(d.n.Divider,null),r.a.createElement(c.b,{"data-testid":"link-explore",className:"btn-link",to:"/explore"},r.a.createElement(d.b,{className:"bp3-minimal",icon:"path-search",text:"Explore"})),r.a.createElement(c.b,{"data-testid":"link-create",className:"btn-link",to:"/create"},r.a.createElement(d.b,{className:"bp3-minimal",icon:"cube",text:"Create"})),r.a.createElement(c.b,{"data-testid":"link-review",className:"btn-link",to:"/review"},r.a.createElement(d.b,{className:"bp3-minimal",icon:"form",text:"Review Edits"})),r.a.createElement(d.p,{position:u.a.BOTTOM_LEFT,minimal:!0,isOpen:i},r.a.createElement(d.b,{onClick:function(){return l(!i)},className:"bp3-minimal",icon:"map-create",text:"Build World"}),r.a.createElement(d.l,null,r.a.createElement(d.m,{icon:"new-object",text:r.a.createElement(c.b,{onClick:function(){return l(!1)},style:{color:"inherit"},"data-testid":"link-world-builder",className:"btn-link",to:"/world_builder"},"Create New"),shouldDismissPopover:!0,tagName:"div"}),r.a.createElement(p,{setPopover:l}))))),t)},h=a(8),f=a(34),E=a(43),y=a.n(E),g=a(9),v=a(132),x=a.n(v),j={host:"http://localhost",port:"35496"};function O(e){return function(e){var t=r.a.useRef();return r.a.useEffect((function(){t.current=e})),t.current}(e)!==e}function C(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=(a.body,a.params,arguments.length>3?arguments[3]:void 0),i=r.a.useState({loading:!0,result:void 0}),l=Object(s.a)(i,2),c=l[0],o=l[1],d=O(t);r.a.useEffect((function(){if(c.loading&&n)o({loading:!1,result:n});else{if(!d){var a=!0;return c.loading&&fetch(e.host+":"+e.port+t).then((function(e){return e.json()})).then((function(e){a&&o({loading:!1,result:e})})).catch((function(e){return console.log("Error fetching data")})),function(){return a=!1}}o({loading:!0,result:void 0})}}),[e.host,e.port,t,d,n,c]);var m=function(){o({loading:!0,result:void 0})};return{loading:c.loading,result:c.result,reload:m}}function w(e,t){var a=[];for(var n in t){var r=encodeURIComponent(n),i=encodeURIComponent("object"===typeof t[n]?JSON.stringify(t[n]):t[n]);a.push(r+"="+i)}return fetch("".concat(j.host,":").concat(j.port,"/").concat(e),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a.join("&")})}function S(e){var t=e.items,a=e.descriptionField,n=e.additionalFields,i=void 0===n?[]:n,l=e.selectedEntity,c=r.a.useState({expanded:-1,animating:0,nextState:-1}),o=Object(s.a)(c,2),d=o[0],m=o[1];return void 0===t||0===t.length?r.a.createElement("span",null,"No items found."):r.a.createElement("table",{"data-testid":"table-explore",style:{width:"100%"},className:"bp3-html-table bp3-html-table-condensed bp3-interactive"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Description"),i.map((function(e){return r.a.createElement("th",{key:e},e.name)})),r.a.createElement("th",null,"ID"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:e.id},r.a.createElement("tr",{onClick:function(){return function(e){-1===d.expanded?m({expanded:e,animating:2,nextState:-1}):d.expanded===e?m({expanded:e,animating:3,nextState:-1}):m(Object(h.a)(Object(h.a)({},d),{},{animating:3,nextState:e}))}(t)},"data-testid":"tr-explore",style:{background:t%2===0?"rgba(191, 204, 214, 0.15)":void 0}},r.a.createElement("td",null,r.a.createElement("strong",null,e.name)),r.a.createElement("td",null,e[a]),i.map((function(t){return r.a.createElement("td",{key:t.name},e[t.key])})),r.a.createElement("td",null,e.id)),r.a.createElement("tr",{style:{background:t%2===0?"rgba(191, 204, 214, 0.15)":void 0}},r.a.createElement("td",{colSpan:5,style:{display:d.expanded===t?void 0:"none",padding:0,cursor:"unset"}},r.a.createElement(y.a,{duration:500,height:d.expanded!==t||2!==d.animating&&0!==d.animating?0:"auto",easing:"ease",onAnimationEnd:function(){return m({nextState:-1,expanded:2===d.animating?t:d.nextState,animating:3===d.animating&&-1!==d.nextState?2:0})},animateOpacity:!0},d.expanded===t&&r.a.createElement(k,{item:e,selectedEntity:l})))))}))))}function k(e){var t=e.item,a=e.selectedEntity;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-testid":"dropdown",style:{padding:"20px 40px 0 40px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},Object.keys(t).map((function(e,a){return r.a.createElement("p",{key:a},r.a.createElement("strong",null,Object(g.startCase)(e)),": ",t[e])})))),r.a.createElement("div",{style:{display:"flex",padding:"0 20px 20px 20px",justifyContent:"flex-end"}},r.a.createElement(c.b,{style:{margin:"0 5px"},className:"bp3-button bp3-small",to:{pathname:"/create",state:{type:a,entity:t}}},"Create From"),r.a.createElement(c.b,{style:{margin:"0 5px"},className:"bp3-button bp3-small",to:{pathname:"/edit/".concat(t.id),state:{type:a,entity:t}}},"Edit")))}var _=function(){var e=r.a.useState("object"),t=Object(s.a)(e,2),a=t[0],n=t[1],i=r.a.useState(0),l=Object(s.a)(i,2),c=l[0],o=l[1],m=r.a.useState(""),u=Object(s.a)(m,2),p=u[0],b=u[1],h=C(j,"/entities/"+a+"?search="+p+"&page="+c),E=h.loading,y=h.result;return r.a.createElement("div",null,r.a.createElement("h2",{"data-testid":"header",className:"bp3-heading"},"Explore"),r.a.createElement("div",{className:"bp3-text-large"},"Search across the LIGHT database for existing objects, characters, or rooms."),r.a.createElement("div",{className:"bp3-input-group bp3-large",style:{margin:"20px 0px 10px"}},r.a.createElement("span",{className:"bp3-icon bp3-icon-search"}),r.a.createElement("input",{className:"bp3-input",type:"search",placeholder:"Search...",dir:"auto",value:p,onChange:function(e){b(e.target.value),o(0)}})),r.a.createElement("div",{style:{display:"flex",marginBottom:30}},r.a.createElement("span",{style:{margin:"0px 20px 0px 40px"}},"Searching category:"),r.a.createElement(d.s,{inline:!0,large:!0,onChange:function(e){n(e.target.value),o(0)},selectedValue:a},r.a.createElement(d.r,{"data-testid":"radio-object",label:"Objects",value:"object"}),r.a.createElement(d.r,{"data-testid":"radio-character",label:"Characters",value:"character"}),r.a.createElement(d.r,{"data-testid":"radio-room",label:"Rooms",value:"room"}))),E?r.a.createElement(d.t,{intent:f.a.PRIMARY}):r.a.createElement(r.a.Fragment,null,r.a.createElement(S,{items:y.data,descriptionField:"room"===a?"description":"physical_description",additionalFields:"room"===a?[{name:"Backstory",key:"backstory"}]:[],selectedEntity:a}),r.a.createElement("div",{style:{margin:"20px"}},r.a.createElement(x.a,{previousLabel:"previous",nextLabel:"next",breakLabel:"...",forcePage:c,pageCount:y.total_pages,marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:function(e){return o(e.selected)},containerClassName:"pagination",subContainerClassName:"pages pagination",activeClassName:"active"}))))},N=a(21),I=a.n(N),R=a(29),T=a(30),F=a(261),A=a(44),D=a.n(A);a(110);function P(e){var t=e.filteredItems,a=e.renderItem,n=t.slice(0,100);return r.a.createElement(d.l,null,t.length>0?r.a.createElement(r.a.Fragment,null,n.map((function(e,t){return a(e,t)})),t.length>100&&r.a.createElement(d.m,{style:{textAlign:"center"},disabled:!0,text:"..."})):r.a.createElement(d.m,{disabled:!0,text:"No results."}))}function L(e,t){var a=t.handleClick,n=t.modifiers,i=t.index;return n.matchesPredicate?r.a.createElement(d.m,{active:n.active,key:i,onClick:a,text:e.name,shouldDismissPopover:!1}):null}var B=function(e){var t=e.id,a=e.name,n=e.errors,i=e.touched,l=e.setFieldTouched,c=e.formValue,o=e.handleChange,d=e.type,m=e.onItemSelect,u=e.entities,p=r.a.useState([]),b=Object(s.a)(p,2),h=b[0],E=b[1],y=r.a.useState(""),g=Object(s.a)(y,2),v=g[0],x=g[1],O=r.a.useState(c),w=Object(s.a)(O,2),S=w[0],k=w[1],_=C(j,"/entities/".concat(d,"?search=").concat(v)),N=_.loading,I=_.result;return r.a.useEffect((function(){if(!N){if(u){var e=Object.values(u[d]),t=e.concat(I.slice(0,100+e.length+1)).filter((function(e,t,a){return a.findIndex((function(t){return D()(t,e)}))===t}));return E(t)}return E(I)}}),[I,N,u,d]),r.a.useEffect((function(){if(u)return k(c);if(isNaN(c))return k(null);for(var e in h)if(h[e].id===c)return k(h[e])}),[c,h,u]),r.a.createElement("div",{onBlur:function(e){return l(a)}},r.a.createElement(F.a,{id:t,name:a,items:h,itemRenderer:L,itemListRenderer:P,inputValueRenderer:function(e){return u&&u[d][e]?u[d][e].name:e.name},inputProps:{intent:n&&i?f.a.DANGER:null,"data-testid":"base-suggest"},onItemSelect:function(e){if(m){var t=m(e,d);k(t),o(a,t,e)}else k(e),o(a,e.id,e);x("")},popoverProps:{usePortal:!1},itemPredicate:function(e,t,a,n){var r=t.name.toLowerCase(),i=e.toLowerCase();if(n)return r===i;var l="";for(var c in t)l+=t[c]+". ";return l.toLowerCase().indexOf(i)>=0},selectedItem:S,query:v,onQueryChange:function(e){return x(e)},resetOnQuery:!0}))};var G={name:"",name_prefix:"",physical_description:"",base_id:0,is_container:0,is_drink:0,is_food:0,is_gettable:0,is_plural:0,is_surface:0,is_weapon:0,is_wearable:0},V=function(e){var t=e.initialInputs,a=e.handleSubmit,n=e.type;return r.a.createElement(T.a,{initialValues:t,validate:function(e){var t={};return e.name||(t.name="Required"),e.name_prefix||(t.name_prefix="Required"),e.physical_description||(t.physical_description="Required"),e.base_id||(t.base_id="Required"),t},onSubmit:a},(function(e){var t=e.values,a=e.setFieldValue,i=e.touched,l=e.setFieldTouched,c=e.errors,o=e.dirty,s=e.isValid,u=e.handleChange,p=e.handleBlur,b=e.handleSubmit,h=e.handleReset,E=function(e){var n=e.target.name;a(n,t[n]?0:1)};return r.a.createElement("form",{"data-testid":"form"},r.a.createElement(d.i,{label:"Name",labelInfo:"(required)",labelFor:"name-input"},r.a.createElement(d.k,{id:"name-input",name:"name",intent:c.name&&i.name?f.a.DANGER:null,onBlur:p,onChange:u,value:t.name}),c.name&&i.name&&r.a.createElement("div",{className:"form-error"},c.name)),r.a.createElement(d.i,{label:"Name Prefix",labelInfo:"(required)",labelFor:"name-prefix-input"},r.a.createElement(d.k,{id:"name-prefix-input",name:"name_prefix",intent:c.name_prefix&&i.name_prefix?f.a.DANGER:null,onBlur:p,onChange:u,value:t.name_prefix}),c.name_prefix&&i.name_prefix&&r.a.createElement("div",{className:"form-error"},c.name_prefix)),r.a.createElement(d.i,{label:"Physical Description",labelInfo:"(required)",labelFor:"physical-description-input"},r.a.createElement(d.w,{id:"physical-description-input",name:"physical_description",growVertically:!0,fill:!0,intent:c.physical_description&&i.physical_description?f.a.DANGER:null,onBlur:p,onChange:u,value:t.physical_description}),c.physical_description&&i.physical_description&&r.a.createElement("div",{className:"form-error"},c.physical_description)),r.a.createElement(d.i,{label:"Base Object",labelInfo:"(required)",labelFor:"base-id-input"},r.a.createElement(B,{id:"base-id-input",name:"base_id",type:"base_".concat(n),errors:c.base_id,touched:i.base_id,setFieldTouched:l,formValue:t.base_id,handleChange:a}),c.base_id&&i.base_id&&r.a.createElement("div",{className:"form-error"},c.base_id)),r.a.createElement(d.i,{label:"Properties",labelInfo:"(required)",large:!0},r.a.createElement("div",{style:{marginLeft:"15px",width:"150px"}},r.a.createElement(d.u,{label:"Container",name:"is_container",onChange:E,checked:!!t.is_container,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Drink",name:"is_drink",onChange:E,checked:!!t.is_drink,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Food",name:"is_food",onChange:E,checked:!!t.is_food,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Gettable",name:"is_gettable",onChange:E,checked:!!t.is_gettable,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Plural",name:"is_plural",onChange:E,checked:!!t.is_plural,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Surface",name:"is_surface",onChange:E,checked:!!t.is_surface,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Weapon",name:"is_weapon",onChange:E,checked:!!t.is_weapon,alignIndicator:m.a.RIGHT}),r.a.createElement(d.u,{label:"Wearable",name:"is_wearable",onChange:E,checked:!!t.is_wearable,alignIndicator:m.a.RIGHT}))),r.a.createElement(d.b,{type:"reset",onClick:h,disabled:!o,style:{marginRight:"15px"}},"Reset"),r.a.createElement(d.b,{intent:f.a.PRIMARY,type:"submit",onClick:b,disabled:!o||!s,style:{marginLeft:"15px"}},"Save Changes"))}))};var q={name:"",name_prefix:"",persona:"",physical_description:"",char_type:"",base_id:0,is_plural:0},M=function(e){var t=e.initialInputs,a=e.handleSubmit,n=e.type;return r.a.createElement(T.a,{initialValues:t,validate:function(e){var t={};return e.name||(t.name="Required"),e.name_prefix||(t.name_prefix="Required"),e.persona||(t.persona="Required"),e.physical_description||(t.physical_description="Required"),e.char_type||(t.char_type="Required"),e.base_id||(t.base_id="Required"),t},onSubmit:a},(function(e){var t=e.values,a=e.setFieldValue,i=e.touched,l=e.setFieldTouched,c=e.errors,o=e.dirty,s=e.isValid,u=e.handleChange,p=e.handleBlur,b=e.handleSubmit,h=e.handleReset;return r.a.createElement("form",{"data-testid":"form"},r.a.createElement(d.i,{label:"Name",labelInfo:"(required)",labelFor:"name-input"},r.a.createElement(d.k,{id:"name-input",name:"name",intent:c.name&&i.name?f.a.DANGER:null,onBlur:p,onChange:u,value:t.name}),c.name&&i.name&&r.a.createElement("div",{className:"form-error"},c.name)),r.a.createElement(d.i,{label:"Name Prefix",labelInfo:"(required)",labelFor:"name-prefix-input"},r.a.createElement(d.k,{id:"name-prefix-input",name:"name_prefix",intent:c.name_prefix&&i.name_prefix?f.a.DANGER:null,onBlur:p,onChange:u,value:t.name_prefix}),c.name_prefix&&i.name_prefix&&r.a.createElement("div",{className:"form-error"},c.name_prefix)),r.a.createElement(d.i,{label:"Persona",labelInfo:"(required)",labelFor:"persona-input"},r.a.createElement(d.w,{id:"persona-input",name:"persona",growVertically:!0,fill:!0,intent:c.persona&&i.persona?f.a.DANGER:null,onBlur:p,onChange:u,value:t.persona}),c.persona&&i.persona&&r.a.createElement("div",{className:"form-error"},c.persona)),r.a.createElement(d.i,{label:"Physical Description",labelInfo:"(required)",labelFor:"physical-description-input"},r.a.createElement(d.w,{id:"physical-description-input",name:"physical_description",growVertically:!0,fill:!0,intent:c.physical_description&&i.physical_description?f.a.DANGER:null,onBlur:p,onChange:u,value:t.physical_description}),c.physical_description&&i.physical_description&&r.a.createElement("div",{className:"form-error"},c.physical_description)),r.a.createElement(d.i,{label:"Character Type",labelInfo:"(required)",labelFor:"char-type-input"},r.a.createElement(d.k,{id:"char-type-input",name:"char_type",intent:c.char_type&&i.char_type?f.a.DANGER:null,onBlur:p,onChange:u,value:t.char_type}),c.char_type&&i.char_type&&r.a.createElement("div",{className:"form-error"},c.char_type)),r.a.createElement(d.i,{label:"Base Character",labelInfo:"(required)",labelFor:"base-id-input"},r.a.createElement(B,{id:"base-id-input",name:"base_id",type:"base_".concat(n),errors:c.base_id,touched:i.base_id,setFieldTouched:l,formValue:t.base_id,handleChange:a}),c.base_id&&i.base_id&&r.a.createElement("div",{className:"form-error"},c.base_id)),r.a.createElement(d.i,{label:"Properties",labelInfo:"(required)",large:!0},r.a.createElement("div",{style:{marginLeft:"15px",width:"150px"}},r.a.createElement(d.u,{label:"Plural",name:"is_plural",onChange:function(e){var n=e.target.name;a(n,t[n]?0:1)},checked:!!t.is_plural,alignIndicator:m.a.RIGHT}))),r.a.createElement(d.b,{type:"reset",onClick:h,disabled:!o,style:{marginRight:"15px"}},"Reset"),r.a.createElement(d.b,{intent:f.a.PRIMARY,type:"submit",onClick:b,disabled:!o||!s,style:{marginLeft:"15px"}},"Save Changes"))}))};var H={name:"",description:"",backstory:"",base_id:0},U=function(e){var t=e.initialInputs,a=e.handleSubmit,n=e.type;return r.a.createElement(T.a,{initialValues:t,validate:function(e){var t={};return e.name||(t.name="Required"),e.description||(t.description="Required"),e.backstory||(t.backstory="Required"),e.base_id||(t.base_id="Required"),t},onSubmit:a},(function(e){var t=e.values,a=e.setFieldValue,i=e.touched,l=e.setFieldTouched,c=e.errors,o=e.dirty,s=e.isValid,m=e.handleChange,u=e.handleBlur,p=e.handleSubmit,b=e.handleReset;return r.a.createElement("form",{"data-testid":"form"},r.a.createElement(d.i,{label:"Name",labelInfo:"(required)",labelFor:"name-input"},r.a.createElement(d.k,{id:"name-input",name:"name",intent:c.name&&i.name?f.a.DANGER:null,onBlur:u,onChange:m,value:t.name}),c.name&&i.name&&r.a.createElement("div",{className:"form-error"},c.name)),r.a.createElement(d.i,{label:"Description",labelInfo:"(required)",labelFor:"description-input"},r.a.createElement(d.w,{id:"description-input",name:"description",growVertically:!0,fill:!0,intent:c.description&&i.description?f.a.DANGER:null,onBlur:u,onChange:m,value:t.description}),c.description&&i.description&&r.a.createElement("div",{className:"form-error"},c.description)),r.a.createElement(d.i,{label:"Backstory",labelInfo:"(required)",labelFor:"backstory-input"},r.a.createElement(d.w,{id:"backstory-input",name:"backstory",growVertically:!0,fill:!0,intent:c.backstory&&i.backstory?f.a.DANGER:null,onBlur:u,onChange:m,value:t.backstory}),c.backstory&&i.backstory&&r.a.createElement("div",{className:"form-error"},c.backstory)),r.a.createElement(d.i,{label:"Base Room",labelInfo:"(required)",labelFor:"base-id-input"},r.a.createElement(B,{id:"base-id-input",name:"base_id",type:"base_".concat(n),errors:c.base_id,touched:i.base_id,setFieldTouched:l,formValue:t.base_id,handleChange:a}),c.base_id&&i.base_id&&r.a.createElement("div",{className:"form-error"},c.base_id)),r.a.createElement(d.b,{type:"reset",onClick:b,disabled:!o,style:{marginRight:"15px"}},"Reset"),r.a.createElement(d.b,{intent:f.a.PRIMARY,type:"submit",onClick:p,disabled:!o||!s,style:{marginLeft:"15px"}},"Save Changes"))}))},W=d.x.create({position:u.a.TOP});function Y(e){var t=e.type,a=e.initialInputs,n=Object(o.f)(),i=function(){var e=Object(R.a)(I.a.mark((function e(a){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("entities/".concat(t),a).then((function(){n.push("/")}));case 2:W.show({intent:f.a.SUCCESS,message:"Successfully created entity"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();switch(t){case"object":return r.a.createElement(V,{type:t,initialInputs:a||G,handleSubmit:i});case"character":return r.a.createElement(M,{type:t,initialInputs:a||q,handleSubmit:i});case"room":return r.a.createElement(U,{type:t,initialInputs:a||H,handleSubmit:i});default:return"This entity cannot be created at the moment"}}var K=function(e){var t=e.location,a=r.a.useState(t.state?t.state.type:"object"),n=Object(s.a)(a,2),i=n[0],l=n[1];return r.a.createElement("div",null,r.a.createElement("h2",{"data-testid":"header",className:"bp3-heading",style:{marginBottom:15}},"Create new entity"),r.a.createElement("div",{className:"bp3-text-large"},r.a.createElement("div",{style:{display:"flex",marginBottom:30}},r.a.createElement("span",{style:{marginRight:"20px"}},"Entity type:"),r.a.createElement(d.s,{inline:!0,large:!0,onChange:function(e){t.state=void 0,l(e.target.value)},selectedValue:i},r.a.createElement(d.r,{"data-testid":"radio-object",label:"Object",value:"object"}),r.a.createElement(d.r,{"data-testid":"radio-character",label:"Character",value:"character"}),r.a.createElement(d.r,{"data-testid":"radio-room",label:"Room",value:"room"}))),r.a.createElement(Y,{type:i,initialInputs:t.state?t.state.entity:void 0})))},z=a(40),J=a(1),Q=a(136),X=a.n(Q);function Z(e){var t=e.edits,a=e.status,n=e.reload,i=r.a.useState({expanded:-1,animating:0,nextState:-1}),l=Object(s.a)(i,2),c=l[0],o=l[1],m=r.a.useState({rows:[],all:0}),u=Object(s.a)(m,2),p=u[0],b=u[1],E=r.a.useState(void 0),v=Object(s.a)(E,2),x=v[0],j=v[1],O=r.a.useState(!1),C=Object(s.a)(O,2),S=C[0],k=C[1],_=r.a.useState([]),N=Object(s.a)(_,2),T=N[0],F=N[1];function A(e){"under review"===a&&(-1===c.expanded?o({expanded:e,animating:1,nextState:-1}):c.expanded===e?o({expanded:e,animating:3,nextState:-1}):o(Object(h.a)(Object(h.a)({},c),{},{animating:3,nextState:e})))}function D(){return(D=Object(R.a)(I.a.mark((function e(){var a;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=T.map((function(e){return w("edits/".concat(t[e].edit_id,"/").concat(x))})),e.next=3,Promise.all(a).then((function(){n()}));case 3:W.show({intent:f.a.SUCCESS,message:"Review submitted"});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&t.length>0&&0===p.rows.length&&b(Object(h.a)(Object(h.a)({},p),{},{rows:Object(g.fill)(Array(t.length),!1)}));var P=function(e){for(var t=[],a=0;a<p.rows.length;a++)p.rows[a]&&t.push(a);F(t),j(e),k(!0)};return void 0===t||0===t.length?r.a.createElement("span",null,"No edits found."):r.a.createElement(r.a.Fragment,null,r.a.createElement(d.f,{icon:"info-sign",onClose:function(){return k(!1)},title:"Confirm edits to be ".concat("reject"===x?"rejected":"accepted"),isOpen:S,usePortal:!1},r.a.createElement("div",{className:J.a.DIALOG_BODY},r.a.createElement("table",{className:"bp3-html-table bp3-html-table-condensed bp3-interactive"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Edit ID"),r.a.createElement("th",null,"Entity ID"),r.a.createElement("th",null,"Edited Field"))),r.a.createElement("tbody",null,T.map((function(e,a){return r.a.createElement("tr",{key:a},r.a.createElement("td",null,t[e].edit_id),r.a.createElement("td",null,t[e].id),r.a.createElement("td",null,t[e].field))}))))),r.a.createElement("div",{className:J.a.DIALOG_FOOTER},r.a.createElement("div",{className:J.a.DIALOG_FOOTER_ACTIONS},r.a.createElement(d.b,{onClick:function(){return k(!1)}},"Close"),r.a.createElement(d.b,{intent:f.a.PRIMARY,onClick:function(){return D.apply(this,arguments)}},"Confirm Edits")))),r.a.createElement("table",{"data-testid":"table-review",style:{width:"100%"},className:"bp3-html-table bp3-html-table-condensed bp3-interactive"},r.a.createElement("thead",null,r.a.createElement("tr",null,"under review"===a&&r.a.createElement("th",{style:{textAlign:"center"}},r.a.createElement(d.c,{checked:p.all,indeterminate:-1===p.all,onClick:function(){var e=p.all?0:1,a=Object(g.fill)(Array(t.length),!!e);b({rows:a,all:e})}})),r.a.createElement("th",null,"Edit ID"),r.a.createElement("th",null,"Entity ID"),r.a.createElement("th",null,"Edited Field"),r.a.createElement("th",null,"Edit"))),r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:e.edit_id},r.a.createElement("tr",{"data-testid":"tr-review",style:{background:t%2===0?"rgba(191, 204, 214, 0.15)":void 0}},"under review"===a&&r.a.createElement("td",{style:{textAlign:"center"}},r.a.createElement(d.c,{checked:p.rows[t],onClick:function(){return function(e){var t=Object(z.a)(p.rows);t[e]=!p.rows[e];var a=p.all;a=t.every((function(e){return!0===e}))?1:t.every((function(e){return!1===e}))?0:-1,b({rows:t,all:a})}(t)}})),r.a.createElement("td",{onClick:function(){return A(t)}},e.edit_id),r.a.createElement("td",{onClick:function(){return A(t)}},r.a.createElement("strong",null,e.id)),r.a.createElement("td",{onClick:function(){return A(t)}},e.field),r.a.createElement("td",{onClick:function(){return A(t)}},function(e,t){var a;if(isNaN(e)||isNaN(t)){var n=new X.a;a=n.diff_main(e,t),n.diff_cleanupSemantic(a)}else a=[[-1,+(e=0+e)],[1,+(t=0+t)]];return r.a.createElement(r.a.Fragment,null,a.map((function(e,t){switch(e[0]){case-1:return r.a.createElement("strike",{key:t,style:{color:"#FF7373"}}," ",e[1]," ");case 0:return r.a.createElement("strong",{key:t},e[1]);case 1:return r.a.createElement("strong",{key:t,style:{color:"#0F9960"}},e[1]);default:return r.a.createElement(r.a.Fragment,null)}})))}(e.unedited_value,e.edited_value))),r.a.createElement("tr",{style:{background:t%2===0?"rgba(191, 204, 214, 0.15)":void 0}},r.a.createElement("td",{colSpan:5,style:{display:c.expanded===t?void 0:"none",padding:0,cursor:"unset"}},r.a.createElement(y.a,{duration:500,height:c.expanded!==t||2!==c.animating&&0!==c.animating?0:"auto",easing:"ease",onAnimationEnd:function(){return o({nextState:-1,expanded:2===c.animating?t:c.nextState,animating:3===c.animating&&-1!==c.nextState?1:0})},animateOpacity:!0},c.expanded===t&&r.a.createElement($,{edit:e,state:c,setState:o,reload:n})))))})))),"under review"===a&&r.a.createElement("div",{style:{display:"flex",margin:"10px",justifyContent:"flex-end"}},r.a.createElement(d.b,{intent:f.a.DANGER,type:"submit",onClick:function(){return P("reject")},style:{marginLeft:"15px"},disabled:!p.all},"Reject"),r.a.createElement(d.b,{intent:f.a.SUCCESS,type:"submit",onClick:function(){return P("accept/accepted")},style:{marginLeft:"15px"},disabled:!p.all},"Accept")))}function $(e){var t=e.edit,a=e.state,n=e.setState,i=e.reload,l=C(j,"/entities/".concat(t.id)),c=l.loading,o=l.result;return r.a.useEffect((function(){o&&1===a.animating&&n(Object(h.a)(Object(h.a)({},a),{},{animating:2}))}),[c,n,a,o]),r.a.createElement(r.a.Fragment,null,c?r.a.createElement(r.a.Fragment,null):r.a.createElement(ee,{edit:t,entity:o.entity,reload:i}))}function ee(e){var t=e.edit,a=e.entity,n=e.reload;return delete a.id,r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-testid":"dropdown",style:{display:"flex",flexDirection:"row",padding:"20px 20px 0 20px",alignItems:"center"}},r.a.createElement("div",{style:{flexGrow:1}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"50%",maxWidth:"30vw",margin:"auto"}},Object.keys(a).map((function(e,n){return r.a.createElement("p",{key:n,style:{color:e===t.field?"#DB3737":void 0}},r.a.createElement("strong",null,Object(g.startCase)(e)),": ",a[e])})))),r.a.createElement("div",{style:{height:"100%",fontSize:"20px",color:"#394B59"}},"\u2794"),r.a.createElement("div",{style:{flexGrow:1}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"50%",maxWidth:"30vw",margin:"auto"}},Object.keys(a).map((function(e,n){return r.a.createElement("p",{key:n,style:{color:e===t.field?"#0F9960":void 0}},r.a.createElement("strong",null,Object(g.startCase)(e)),":"," ",e===t.field?t.edited_value:a[e])}))))),r.a.createElement("div",{style:{display:"flex",padding:"0 20px 20px 20px",justifyContent:"flex-end"}},r.a.createElement(d.b,{intent:f.a.DANGER,type:"submit",onClick:function(){return w("edits/".concat(t.edit_id,"/reject")).then((function(){return n()}))},style:{marginLeft:"15px"}},"Reject Edit"),r.a.createElement(d.b,{intent:f.a.SUCCESS,type:"submit",onClick:function(){return w("edits/".concat(t.edit_id,"/accept/accepted")).then((function(){return n()}))},style:{marginLeft:"15px"}},"Accept Edit")))}var te=function(){var e=r.a.useState("under review"),t=Object(s.a)(e,2),a=t[0],n=t[1],i=C(j,"/edits?expand=true&status=".concat(a)),l=i.loading,c=i.result,o=i.reload;return r.a.createElement("div",null,r.a.createElement("h2",{"data-testid":"header",className:"bp3-heading"},"Review"),r.a.createElement("div",{className:"bp3-text-large"},"Review pending, accepted, and rejected edits to the LIGHT database."),r.a.createElement("br",null),r.a.createElement("div",{style:{display:"flex",marginBottom:"30px"}},r.a.createElement("span",{style:{margin:"0px 20px 0px 40px"}},"Searching category:"),r.a.createElement(d.s,{inline:!0,large:!0,onChange:function(e){return n(e.target.value)},selectedValue:a},r.a.createElement(d.r,{"data-testid":"radio-under-review",label:"Under Review",value:"under review"}),r.a.createElement(d.r,{"data-testid":"radio-accepted",label:"Accepted",value:"accepted"}),r.a.createElement(d.r,{"data-testid":"radio-rejected",label:"Rejected",value:"rejected"}))),l?r.a.createElement(d.t,{intent:f.a.PRIMARY}):r.a.createElement(Z,{edits:c,status:a,reload:o}))},ae=a(26),ne=a(123),re=a(57),ie=[ne.a.GRAY3,ne.a.VIOLET5,ne.a.RED5,ne.a.SEPIA5,ne.a.GOLD5,ne.a.FOREST5,ne.a.BLUE5],le=["grass","field","plains","forest","land","gardens","meadow","woods","jungle","swamp","green"],ce=["water","lake","river","ocean","sea","pond","lagoon","shore","blue"],oe=["castle","fortress","church","cathedral","tower","building","cave","gray","grey"],se=["king","queen","palace","purple"],de=["brick","fire","red"],me=["path","road","bridge","brown"],ue=["farm","cottage","sand","beach","yellow","gold"];function pe(e,t){var a=e.toLowerCase();return le.some((function(e){return a.indexOf(e)>-1}))?ne.a.FOREST5:ce.some((function(e){return a.indexOf(e)>-1}))?ne.a.BLUE5:de.some((function(e){return a.indexOf(e)>-1}))?ne.a.RED5:me.some((function(e){return a.indexOf(e)>-1}))?ne.a.SEPIA5:ue.some((function(e){return a.indexOf(e)>-1}))?ne.a.GOLD5:oe.some((function(e){return a.indexOf(e)>-1}))?ne.a.GRAY3:se.some((function(e){return a.indexOf(e)>-1}))?ne.a.VIOLET5:t}function be(e){return 0===e.indexOf("#")&&(e=e.slice(1)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),.299*parseInt(e.slice(0,2),16)+.587*parseInt(e.slice(2,4),16)+.114*parseInt(e.slice(4,6),16)>150?"#182026":"#F5F8FA"}function he(e){var t=re.b.search(e);if(t[0])return t[0].native;for(var a=e.split(" "),n=0;n<a.length;n++){var r=a[n];if("s"===a[n].charAt(a[n].length-1)&&(r=a[n].substring(0,a[n].length-1)),(t=re.b.search(r))[0])return t[0].native}return"\u2753"}var fe=function(e,t){switch(t.type){case"SET_MAP":return t.map;case"SET_TILE":return e.map((function(e,a){return a===t.floor?Object(h.a)(Object(h.a)({},e),{},{tiles:Object(h.a)(Object(h.a)({},e.tiles),{},Object(ae.a)({},"".concat(t.x," ").concat(t.y),t.newTile))}):e}));case"EDIT_FLOOR_NAME":return e.map((function(e,a){return a===t.floor?Object(h.a)(Object(h.a)({},e),{},{name:t.name}):e}));default:return e}},Ee=function(e,t){switch(t.type){case"SET_ALL":return t.entities;case"ADD_ENTITY":var a;return Object.assign({},e,(a={},Object(ae.a)(a,t.entityType,Object(h.a)(Object(h.a)({},e[t.entityType]),{},Object(ae.a)({},e.nextID,t.data))),Object(ae.a)(a,"nextID",e.nextID+1),a));case"EDIT_ENTITY":return Object(g.merge)(e,Object(ae.a)({},t.entityType,Object(ae.a)({},t.id,t.data)));default:return e}};function ye(e){var t=r.a.useState(e?e.data.dimensions:{height:3,width:3,floors:1}),a=Object(s.a)(t,2),n=a[0],i=a[1],l=e?e.data.map:[{name:"1F",tiles:{},walls:{}}],c=r.a.useReducer(fe,l),o=Object(s.a)(c,2),d=o[0],m=o[1],u=r.a.useReducer(Ee,e?e.data.entities:{room:{},character:{},object:{},nextID:1}),p=Object(s.a)(u,2),b=p[0],E=p[1],y=r.a.useState(0),v=Object(s.a)(y,2),x=v[0],j=v[1];r.a.useEffect((function(){for(var e=[],t=0;t<n.floors;t++)e.push(d[t]?d[t]:{name:"".concat(t+1,"F"),tiles:{},walls:{}});m({type:"SET_MAP",map:e})}),[n]);var O=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;a[n]&&a[n].tiles["".concat(e," ").concat(t)]&&(delete a[n].tiles["".concat(e," ").concat(t)].stairDown,delete a[n].tiles["".concat(e," ").concat(t)].stairUp),a[n-1]&&a[n-1].tiles["".concat(e," ").concat(t)]&&delete a[n-1].tiles["".concat(e," ").concat(t)].stairUp,a[n+1]&&a[n+1].tiles["".concat(e," ").concat(t)]&&delete a[n+1].tiles["".concat(e," ").concat(t)].stairDown},C=function(e,t){Object(g.isEmpty)(e)||Object(g.isEmpty)(e.tiles)||Object.keys(e.tiles).forEach((function(a){Object(g.isEmpty)(e.tiles[a])||delete e.tiles[a][t]}))},S=function(){for(var e=[],t=0;t<d.length;t++){var a={name:d[t].name,walls:d[t].walls},r={};for(var i in d[t].tiles){var l=i.split(" "),c=Object(s.a)(l,2),o=c[0],m=c[1];o<n.width&&m<n.height&&(r[i]=d[t].tiles[i])}a.tiles=r,e.push(a)}return e},k=function(){var e=Object(R.a)(I.a.mark((function e(){var t,a,n,r,i,l;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={room:{},character:{},object:{}},(a=S()).forEach((function(e){Object.values(e.tiles).forEach((function(e){for(var a in t.room[e.room]=b.room[e.room],e.characters)t.character[e.characters[a]]=b.character[e.characters[a]];for(var n in e.objects)t.object[e.objects[n]]=b.object[e.objects[n]]}))})),n=[].concat(Object.values(t.room).map(function(){var e=Object(R.a)(I.a.mark((function e(t){var a,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("entities/room",t);case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,t.id=n[0];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object.values(t.character).map(function(){var e=Object(R.a)(I.a.mark((function e(t){var a,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("entities/character",t);case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,t.id=n[0];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object.values(t.object).map(function(){var e=Object(R.a)(I.a.mark((function e(t){var a,n;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("entities/object",t);case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,t.id=n[0];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),e.next=6,Promise.all(n);case 6:for(r=[],i=function(e){var n=a[e].tiles,i=function(i){var l={room:-1,chars:[],objs:[],neighbors:[]};l.room=t.room[n[i].room].id,n[i].characters.forEach((function(e){l.chars.push(t.character[e].id)})),n[i].objects.forEach((function(e){l.objs.push(t.object[e].id)})),n[i].stairUp&&l.neighbors.push(t.room[a[e+1].tiles[i].room].id),n[i].stairDown&&l.neighbors.push(t.room[a[e-1].tiles[i].room].id);var c=i.split(" ").map((function(e){return parseInt(e)})),o=Object(s.a)(c,2),d=o[0],m=o[1];["".concat(d-1," ").concat(m),"".concat(d+1," ").concat(m),"".concat(d," ").concat(m-1),"".concat(d," ").concat(m+1)].forEach((function(r){Object.keys(a[e].walls).some((function(e){return e.includes(r)&&e.includes(i)}))||Object(g.isEmpty)(n[r])||l.neighbors.push(t.room[n[r].room].id)})),r.push(w("edges",l))};for(var l in n)i(l)},l=0;l<a.length;l++)i(l);return e.next=11,Promise.all(r);case 11:W.show({intent:f.a.SUCCESS,message:"Successfully created all edges"});case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{floorManager:{setCurrFloor:j,addFloor:function(){i(Object(h.a)(Object(h.a)({},n),{},{floors:n.floors+1}))},deleteFloor:function(e){var t=d.filter((function(t,a){return a!==e}));C(t[e-1],"stairUp"),C(t[e],"stairDown"),m({type:"SET_MAP",map:t}),x>=n.floors-1&&j(0),i(Object(h.a)(Object(h.a)({},n),{},{floors:n.floors-1}))},reorderFloors:function(e,t){var a=d[e],r=d.filter((function(t,a){return a!==e}));C(a,"stairUp"),C(a,"stairDown"),C(r[e-1],"stairUp"),C(r[e],"stairDown");for(var i=[],l=0;l<n.floors;l++)i.push(l<t?r[l]:l===t?a:r[l-1]);C(i[t-1],"stairUp"),C(i[t+1],"stairDown"),m({type:"SET_MAP",map:i}),x===e&&j(t)},editFloorName:function(e,t){m({type:"EDIT_FLOOR_NAME",name:e,floor:t})}},currFloor:x,map:d,setTile:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:x;m({type:"SET_TILE",x:e,y:t,newTile:a,floor:n})},clearTile:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x,n=Object(g.cloneDeep)(d);O(e,t,n),delete n[a].tiles["".concat(e," ").concat(t)],m({type:"SET_MAP",map:n})},swapTiles:function(e,t,a,n){m({type:"SET_MAP",map:d.map((function(r,i){var l;return i===x?(O(e,t),O(a,n),Object(h.a)(Object(h.a)({},r),{},{tiles:Object(h.a)(Object(h.a)({},r.tiles),{},(l={},Object(ae.a)(l,"".concat(e," ").concat(t),r.tiles["".concat(a," ").concat(n)]),Object(ae.a)(l,"".concat(a," ").concat(n),r.tiles["".concat(e," ").concat(t)]),l))})):r}))})},getTileAt:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:x;try{return d[a].tiles["".concat(e," ").concat(t)]}catch(n){return{}}},toggleWall:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x;if(d[t].walls[e]){var a=Object(g.cloneDeep)(d);delete a[t].walls[e],m({type:"SET_MAP",map:a})}else m({type:"SET_MAP",map:d.map((function(a,n){return n===t?Object(h.a)(Object(h.a)({},a),{},{walls:Object(h.a)(Object(h.a)({},a.walls),{},Object(ae.a)({},e,!0))}):a}))})},dimensions:n,setDimensions:i,addRowTop:function(){m({type:"SET_MAP",map:d.map((function(e){var t=Object.keys(e.tiles),a={};t.forEach((function(t){var n=t.split(" "),r=Object(s.a)(n,2),i=r[0],l=r[1];a["".concat(i," ").concat(parseInt(l)+1)]=e.tiles[t]}));var n=Object.keys(e.walls),r={};return n.forEach((function(t){var a=t.split("|"),n=Object(s.a)(a,2),i=n[0],l=n[1],c=i.split(" "),o=Object(s.a)(c,2),d=o[0],m=o[1],u=l.split(" "),p=Object(s.a)(u,2),b=p[0],h=p[1];r["".concat(d," ").concat(parseInt(m)+1,"|").concat(b," ").concat(parseInt(h)+1)]=e.walls[t]})),Object(h.a)(Object(h.a)({},e),{},{tiles:a,walls:r})}))}),i(Object(h.a)(Object(h.a)({},n),{},{height:n.height+1}))},addRowBot:function(){i(Object(h.a)(Object(h.a)({},n),{},{height:n.height+1}))},addColFront:function(){m({type:"SET_MAP",map:d.map((function(e){var t=Object.keys(e.tiles),a={};t.forEach((function(t){var n=t.split(" "),r=Object(s.a)(n,2),i=r[0],l=r[1];a["".concat(parseInt(i)+1," ").concat(l)]=e.tiles[t]}));var n=Object.keys(e.walls),r={};return n.forEach((function(t){var a=t.split("|"),n=Object(s.a)(a,2),i=n[0],l=n[1],c=i.split(" "),o=Object(s.a)(c,2),d=o[0],m=o[1],u=l.split(" "),p=Object(s.a)(u,2),b=p[0],h=p[1];r["".concat(parseInt(d)+1," ").concat(m,"|").concat(parseInt(b)+1," ").concat(h)]=e.walls[t]})),Object(h.a)(Object(h.a)({},e),{},{tiles:a,walls:r})}))}),i(Object(h.a)(Object(h.a)({},n),{},{width:n.width+1}))},addColEnd:function(){i(Object(h.a)(Object(h.a)({},n),{},{width:n.width+1}))},entities:b,editEntity:function(e,t,a){E({type:"EDIT_ENTITY",id:e,data:t,entityType:a})},findOrAddEntity:function(e,t){for(var a in b[t])if(D()(b[t][a],e))return a;return function(e,t){var a=b.nextID;return E({type:"ADD_ENTITY",data:e,entityType:t}),a}(e,t)},postEdges:k,exportWorld:function(){var e=JSON.stringify({dimensions:n,map:d,entities:b},null,"\t"),t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","world-".concat(Date.now().toString(),".json")),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}}}var ge=a(139),ve=a.n(ge);var xe=function(e){var t=e.colors,a=e.value,n=e.handleChange,i=e.advanced;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},t.map((function(e,t){return r.a.createElement("div",{key:t,style:{display:"inline-block",maxWidth:"20px",width:"20px",maxHeight:"20px",height:"20px",borderRadius:"5px",background:e,borderColor:"#5C7080",borderStyle:a===e?"solid":"",borderWidth:"2px",boxShadow:a===e?"0px 0px 8px ".concat(a):"",margin:"2px",cursor:"pointer"},onClick:function(){return n("color",e)}})})),i&&r.a.createElement("input",{style:{maxHeight:"20px",maxWidth:"20px",height:"20px",width:"20px",borderRadius:"5px",padding:"0px 0px 0px 0px"},type:"color",value:a,onChange:function(e){return n("color",e.target.value)}}))},je=a(262);function Oe(e){var t=e.filteredItems,a=e.renderItem,n=t.slice(0,100);return r.a.createElement(d.l,null,t.length>0?r.a.createElement(r.a.Fragment,null,n.map((function(e,t){return a(e,t)})),t.length>100&&r.a.createElement(d.m,{style:{textAlign:"center"},disabled:!0,text:"..."})):r.a.createElement(d.m,{disabled:!0,text:"No results."}))}var Ce=function(e){var t=e.id,a=e.name,n=e.errors,i=e.touched,l=e.setFieldTouched,c=e.formValue,o=e.handleChange,m=e.type,p=e.tooltip,b=e.onItemSelect,h=e.entities,E=r.a.useState([]),y=Object(s.a)(E,2),g=y[0],v=y[1],x=r.a.useState(""),O=Object(s.a)(x,2),w=O[0],S=O[1],k=r.a.useState([]),_=Object(s.a)(k,2),N=_[0],I=_[1],R=C(j,"/entities/".concat(m,"?search=").concat(w)),T=R.loading,F=R.result;return r.a.useEffect((function(){if(!T){if(h){var e=Object.values(h[m]),t=e.concat(F.slice(0,100+e.length+1)).filter((function(e,t,a){return a.findIndex((function(t){return D()(t,e)}))===t}));return v(t)}return v(F)}}),[F,T,h,m]),r.a.useEffect((function(){I(c)}),[c,g]),r.a.createElement("div",{onBlur:function(e){return l(a)}},r.a.createElement(je.a,{id:t,name:a,items:g,itemRenderer:function(e,t){var a=t.handleClick,n=t.modifiers,i=t.index;return n.matchesPredicate?r.a.createElement(d.m,{active:n.active,key:i,onClick:a,text:p?r.a.createElement(d.y,{content:e[p],targetTagName:"div",popoverClassName:"popover-tooltip",position:u.a.TOP_RIGHT,usePortal:!0},e.name):e.name,shouldDismissPopover:!1}):null},itemListRenderer:Oe,tagInputProps:{intent:n&&i?f.a.DANGER:null,"data-testid":"base-multi-select",onRemove:function(e,t){var n=N.filter((function(e,a){return a!==t})),r=c.filter((function(e,a){return a!==t}));I(n),o(a,r)}},onItemSelect:function(e){if(b){var t=b(e,m);I([].concat(Object(z.a)(N),[t])),o(a,[].concat(Object(z.a)(c),[t]),e)}else I([].concat(Object(z.a)(N),[e])),o(a,[].concat(Object(z.a)(c),[e.id]));S("")},popoverProps:{usePortal:!1},itemPredicate:function(e,t,a,n){var r=t.name.toLowerCase(),i=e.toLowerCase();if(n)return r===i;var l="";for(var c in t)l+=t[c]+". ";return l.toLowerCase().indexOf(i)>=0},selectedItems:N,query:w,onQueryChange:function(e){return S(e)},resetOnQuery:!0,tagRenderer:function(e){return h&&h[m][e]?h[m][e].name:e.name}}))},we={room:void 0,characters:[],objects:[],color:ie[0]};var Se=function(e){var t=e.initialInputs,a=e.onSubmit,n=e.onClear,i=e.entities,l=e.findOrAddEntity,c=e.setShowAdvanced,o=e.selected,s=e.setSelected;return r.a.createElement(T.a,{initialValues:Object(g.isEmpty)(t)?we:t,validate:function(e){var t={};return isNaN(e.room)&&(t.room="Required"),t},onSubmit:a},(function(e){var t=e.values,a=e.setFieldValue,m=e.touched,u=e.setFieldTouched,p=e.errors,b=e.dirty,E=e.isValid,y=e.handleSubmit,v=e.handleReset;return r.a.createElement("form",null,r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignContent:"stretch",justifyContent:"space-between"}},r.a.createElement("h5",{style:{fontSize:"18px"},className:J.a.HEADING},r.a.createElement(d.j,{color:"#5c7080",iconSize:20,icon:"edit"})," Tile Editor"),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"},onClick:function(){s(Object(h.a)(Object(h.a)({},o),{},{data:Object(h.a)({},t)})),c(!0)}},r.a.createElement(d.b,{icon:"build"}))),r.a.createElement(d.g,null),r.a.createElement(d.i,{label:"Room",labelInfo:"(required)",labelFor:"room-input"},r.a.createElement(B,{id:"room-input",name:"room",type:"room",errors:p.room,touched:m.room,setFieldTouched:u,formValue:t.room,handleChange:function(e,n,r){a(e,n),a("color",pe(r.name,t.color))},entities:i,onItemSelect:l}),p.room&&m.room&&r.a.createElement("div",{className:"form-error"},p.room)),r.a.createElement(xe,{colors:ie,value:t.color,handleChange:a}),r.a.createElement(d.i,{label:"Characters in Room",labelFor:"characters-input"},r.a.createElement(Ce,{id:"characters-input",name:"characters",type:"character",errors:p.characters,touched:m.characters,setFieldTouched:u,formValue:t.characters,handleChange:a,tooltip:"persona",entities:i,onItemSelect:function(e,t){return e.emoji=he(e.name),l(e,t)}}),p.characters&&m.characters&&r.a.createElement("div",{className:"form-error"},p.characters)),r.a.createElement(d.i,{label:"Objects in Room",labelFor:"objects-input"},r.a.createElement(Ce,{id:"objects-input",name:"objects",type:"object",errors:p.objects,touched:m.objects,setFieldTouched:u,formValue:t.objects,handleChange:a,tooltip:"physical_description",entities:i,onItemSelect:function(e,t){return e.emoji=he(e.name),l(e,t)}}),p.objects&&m.objects&&r.a.createElement("div",{className:"form-error"},p.objects)),r.a.createElement(d.b,{type:"reset",onClick:n,disabled:!(!isNaN(t.room)||!Object(g.isEmpty)(t.characters)||!Object(g.isEmpty)(t.objects)),style:{marginRight:"15px"}},"Clear"),r.a.createElement(d.b,{type:"reset",onClick:v,disabled:!b,style:{marginRight:"15px"}},"Reset"),r.a.createElement(d.b,{intent:f.a.PRIMARY,type:"submit",onClick:y,disabled:!b||!E,style:{marginLeft:"15px"}},"Save Changes"))}))};var ke=function(e){var t=e.x,a=e.y,n=e.tile,i=e.selected,l=e.setSelected,c=e.showAdvanced,o=e.setShowAdvanced,s=e.tileStyle,m=e.state,u=function(e,r){e.stopPropagation();var i=!n[r],l=Object(g.cloneDeep)(n);l[r]=i,m.setTile(t,a,l);var c=m.currFloor+("stairDown"===r?-1:1),o=Object(g.cloneDeep)(m.getTileAt(t,a,c));o["stairDown"===r?"stairUp":"stairDown"]=i,m.setTile(t,a,o,c)},p=be(n&&!isNaN(n.room)&&n.color?n.color:"#ced9e0");return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.j,{color:p,className:"react-grid-item-handle + ".concat(Object(g.isEmpty)(n)?"disabled":""),icon:"drag-handle-horizontal"}),!Object(g.isEmpty)(m.getTileAt(t,a,m.currFloor-1))&&r.a.createElement(d.j,{color:p,onClick:Object(g.isEmpty)(n)?void 0:function(e){return u(e,"stairDown")},className:Object(g.isEmpty)(n)?"disabled":"",style:{opacity:!Object(g.isEmpty)(n)&&n.stairDown?1:.35,position:"absolute",bottom:"5px",left:"5px"},icon:"arrow-bottom-left"}),!Object(g.isEmpty)(m.getTileAt(t,a,m.currFloor+1))&&r.a.createElement(d.j,{color:p,onClick:Object(g.isEmpty)(n)?void 0:function(e){return u(e,"stairUp")},className:Object(g.isEmpty)(n)?"disabled":"",style:{opacity:!Object(g.isEmpty)(n)&&n.stairUp?1:.35,position:"absolute",top:"5px",right:"5px"},icon:"arrow-top-right"}),r.a.createElement(d.p,{isOpen:!!i&&i.x===t&&i.y===a&&!c,onClose:function(){c||l(null)},usePortal:!0},r.a.createElement("div",{className:"react-grid-item-content",style:Object(h.a)(Object(h.a)({},s),{},{backgroundColor:n&&n.color?n.color:""})},r.a.createElement("div",{className:"center",style:{color:p,width:"100%",maxHeight:s.maxHeight-20,overflow:"hidden"}},r.a.createElement("p",null,Object(g.isEmpty)(n)?"":m.entities.room[n.room].name),r.a.createElement("p",null,Object(g.isEmpty)(n)?"":n.characters.map((function(e){return r.a.createElement(d.y,{content:m.entities.character[e].name},m.entities.character[e].emoji)}))),r.a.createElement("p",null,Object(g.isEmpty)(n)?"":n.objects.map((function(e){return r.a.createElement(d.y,{content:m.entities.object[e].name},m.entities.object[e].emoji)}))))),r.a.createElement("div",{style:{padding:"20px"}},r.a.createElement(Se,{initialInputs:n,onSubmit:function(e){m.setTile(t,a,Object(h.a)(Object(h.a)({},n),e)),l(null)},onClear:function(){m.clearTile(t,a),l(null)},entities:m.entities,findOrAddEntity:m.findOrAddEntity,setSelected:l,selected:i,setShowAdvanced:o}))))};a(251);function _e(e){var t=e.initialOpen,a=void 0===t||t,n=e.children,i=e.title,l=r.a.useState(a),c=Object(s.a)(l,2),o=c[0],m=c[1];return r.a.createElement("div",{style:{margin:"0 0 10px 0"}},r.a.createElement("div",{onClick:function(){return m(!o)},className:"hideable-header ".concat(o?"":"hidden")},r.a.createElement(d.j,{className:"hideable-arrow ".concat(o?"":"hidden"),icon:"chevron-down"})," ",i),r.a.createElement(y.a,{duration:500,height:o?"auto":0,easing:"ease",animateOpacity:!0},r.a.createElement("div",{className:"hideable-content"},n)))}function Ne(e){var t=e.columnNames,a=e.columnKeys,n=e.items,i=e.entities,l=e.handleEdit,c=e.handleDuplicate,o=e.handleDelete,m=e.type,u=e.editEntity;function p(e){var t=e.item,a=r.a.useState(!1),n=Object(s.a)(a,2),l=n[0],c=n[1];return r.a.createElement(d.p,{interactionKind:d.q.CLICK,onInteraction:function(e){return c(e)},isOpen:l,wrapperTagName:"td"},r.a.createElement("div",{style:{height:"100%",width:"100%"}},i[m][t].emoji||"\u2753"),r.a.createElement(re.a,{onSelect:function(e){var a=Object(g.cloneDeep)(i[m][t]);a.emoji=e.native,u(t,a,m),c(!1)}}))}return r.a.createElement(r.a.Fragment,null,!Object(g.isEmpty)(n)&&r.a.createElement("table",{"data-testid":"table-explore",style:{width:"100%"},className:"bp3-html-table bp3-html-table-striped bp3-html-table-condensed bp3-interactive"},r.a.createElement("thead",null,r.a.createElement("tr",null,t.map((function(e,t){return r.a.createElement("th",{key:t},e)})),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,n.map((function(e,t){return r.a.createElement(r.a.Fragment,{key:t},r.a.createElement("tr",null,a.map((function(t){return"emoji"===t?r.a.createElement(p,{item:e,key:t}):r.a.createElement("td",{key:t},i[m][e][t])})),r.a.createElement("td",null,r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(d.b,{onClick:function(){return l(e,i[m][e])},icon:"edit",minimal:!0}),r.a.createElement(d.b,{onClick:function(){return c(i[m][e])},icon:"duplicate",minimal:!0}),r.a.createElement(d.b,{onClick:function(){return o(t)},icon:"trash",minimal:!0})))))})))))}var Ie={BASE:0,CHOOSE:1,SELECT_FROM_EXISTING:2,CREATE_NEW:3,EDIT:4,DUPLICATE:5};function Re(e){var t=e.initialState,a=void 0===t?Ie.BASE:t,n=e.handleChange,i=e.name,l=e.type,c=e.formValue,o=e.SelectFromExisting,m=e.selectFromExistingProps,u=e.Form,p=e.formProps,b=e.handleCreateSubmit,h=e.handleEditSubmit,f=e.Selected,E=e.selectedProps,y=r.a.useState(a),g=Object(s.a)(y,2),v=g[0],x=g[1],j=r.a.useState(void 0),O=Object(s.a)(j,2),C=O[0],w=O[1],S=r.a.useState(void 0),k=Object(s.a)(S,2),_=k[0],N=k[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(f,Object.assign({},E,{handleEdit:function(e,t){w({id:e,data:t}),x(Ie.EDIT)},handleDuplicate:function(e){N(e),x(Ie.DUPLICATE)},handleDelete:function(e){Array.isArray(c)?(c.splice(e,1),n(i,c)):n(i,void 0)}})),v===Ie.CHOOSE?r.a.createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"row",alignItems:"center",padding:"5px"}},r.a.createElement(d.b,{onClick:function(){return x(Ie.SELECT_FROM_EXISTING)},style:{margin:"5px"}},"Select from existing"),r.a.createElement("span",{style:{margin:"5px"}}," OR "),r.a.createElement(d.b,{onClick:function(){return x(Ie.CREATE_NEW)},style:{margin:"5px"}},"Create New")):v===Ie.SELECT_FROM_EXISTING?r.a.createElement("div",null,r.a.createElement(d.b,{onClick:function(){return x(a)},icon:"chevron-left",minimal:!0}),r.a.createElement(o,Object.assign({},m,{name:i,type:l,formValue:c}))):v===Ie.CREATE_NEW?r.a.createElement("div",null,r.a.createElement(d.b,{onClick:function(){return x(a)},icon:"chevron-left",minimal:!0}),r.a.createElement(u,Object.assign({},p,{type:l,handleSubmit:function(e){x(a),b(e)}}))):v===Ie.EDIT?r.a.createElement("div",null,r.a.createElement(d.b,{onClick:function(){return x(a)},icon:"chevron-left",minimal:!0}),r.a.createElement(u,Object.assign({},p,{type:l,initialInputs:C.data,handleSubmit:function(e){x(a),h(C.id,e,l),w(void 0)}}))):v===Ie.DUPLICATE?r.a.createElement("div",null,r.a.createElement(d.b,{onClick:function(){return x(a)},icon:"chevron-left",minimal:!0}),r.a.createElement(u,Object.assign({},p,{type:l,initialInputs:_,handleSubmit:function(e){x(a),b(e),N(void 0)}}))):r.a.createElement(d.b,{onClick:function(){return x(Ie.CHOOSE)},icon:"add"},"Add"))}var Te=function(e){var t=e.x,a=e.y,n=e.currFloor,i=e.getTileAt,l=e.initialInputs,c=e.inheritedInputs,o=e.handleSubmit,s=e.handleClear,m=e.tileStyle,u=e.entities,p=e.findOrAddEntity,b=e.editEntity,E=function(e){var l=e.tile,c=be(l&&!isNaN(l.room)&&l.color?l.color:"#ced9e0");return r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement("div",{style:{position:"relative"}},r.a.createElement(d.j,{color:c,className:"react-grid-item-handle + ".concat(isNaN(l.room)?"disabled":""),icon:"drag-handle-horizontal"}),!Object(g.isEmpty)(l)&&!Object(g.isEmpty)(i(t,a,n-1))&&r.a.createElement(d.j,{color:c,className:Object(g.isEmpty)(l)?"disabled":"",style:{opacity:l.stairDown?1:.2,position:"absolute",bottom:"5px",left:"5px"},icon:"arrow-bottom-left"}),!Object(g.isEmpty)(l)&&!Object(g.isEmpty)(i(t,a,n+1))&&r.a.createElement(d.j,{color:c,className:Object(g.isEmpty)(l)?"disabled":"",style:{opacity:l.stairUp?1:.2,position:"absolute",top:"5px",right:"5px"},icon:"arrow-top-right"}),r.a.createElement("div",{className:"react-grid-item-content",style:Object(h.a)(Object(h.a)({},m),{},{backgroundColor:l&&!isNaN(l.room)&&l.color?l.color:"#ced9e0"})},r.a.createElement("div",{className:"center",style:{color:c,width:"100%",maxHeight:m.maxHeight-20,overflow:"hidden"}},!Object(g.isEmpty)(l)&&u.room[l.room]?u.room[l.room].name:"",r.a.createElement("p",null,Object(g.isEmpty)(l)?"":l.characters.map((function(e){return r.a.createElement(d.y,{content:u.character[e].name},u.character[e].emoji)}))),r.a.createElement("p",null,Object(g.isEmpty)(l)?"":l.objects.map((function(e){return r.a.createElement(d.y,{content:u.object[e].name},u.object[e].emoji)})))))))};return r.a.createElement(T.a,{initialValues:c||(Object(g.isEmpty)(l)?void 0:l)||we,validate:function(e){var t={};return e.room||(t.room="Required"),t},isInitialValid:!!c&&!!c.room,onSubmit:o},(function(e){var t=e.values,a=e.setFieldValue,n=e.touched,i=e.setFieldTouched,l=e.errors,c=e.dirty,o=e.isValid,m=e.handleSubmit,h=e.handleReset,y=function(e,n,r){a(e,n),a("color",pe(r.name,t.color))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(_e,{title:"Room"},r.a.createElement(Re,{initialState:Ie.CHOOSE,SelectFromExisting:B,selectFromExistingProps:{id:"room-input",errors:l.room,touched:n.room,setFieldTouched:i,onItemSelect:p,entities:u,handleChange:y},handleChange:a,formValue:t.room,name:"room",type:"room",Form:U,formProps:{initialInputs:H},handleCreateSubmit:function(e){return y("room",p(e,"room"),e)},handleEditSubmit:b,Selected:Ne,selectedProps:{columnNames:["Name","Description","Backstory"],columnKeys:["name","description","backstory"],items:isNaN(t.room)?void 0:[t.room],entities:u,type:"room"}}),l.room&&n.room&&r.a.createElement("div",{className:"form-error"},l.room),r.a.createElement("div",{style:{marginTop:"5px"}},r.a.createElement(xe,{colors:ie,value:t.color,handleChange:a,advanced:!0}))),r.a.createElement(_e,{initialOpen:!Object(g.isEmpty)(t.characters),title:"Characters"},r.a.createElement(Re,{SelectFromExisting:Ce,selectFromExistingProps:{id:"characters-input",errors:l.characters,touched:n.characters,setFieldTouched:i,tooltip:"physical_description",onItemSelect:function(e,t){return e.emoji=he(e.name),p(e,t)},entities:u,handleChange:a},handleChange:a,formValue:t.characters,name:"characters",type:"character",Form:M,formProps:{initialInputs:q},handleCreateSubmit:function(e){e.emoji=he(e.name),a("characters",t.characters.concat(p(e,"character")))},handleEditSubmit:b,Selected:Ne,selectedProps:{columnNames:["Name","Persona","Emoji"],columnKeys:["name","persona","emoji"],items:t.characters,entities:u,type:"character",editEntity:b}}),l.characters&&n.characters&&r.a.createElement("div",{className:"form-error"},l.characters)),r.a.createElement(_e,{initialOpen:!Object(g.isEmpty)(t.characters),title:"Objects"},r.a.createElement(Re,{SelectFromExisting:Ce,selectFromExistingProps:{id:"objects-input",errors:l.objects,touched:n.objects,setFieldTouched:i,tooltip:"physical_description",onItemSelect:function(e,t){return e.emoji=he(e.name),p(e,t)},entities:u,handleChange:a},handleChange:a,formValue:t.objects,name:"objects",type:"object",Form:V,formProps:{initialInputs:G},handleCreateSubmit:function(e){e.emoji=he(e.name),a("objects",t.objects.concat(p(e,"object")))},handleEditSubmit:b,Selected:Ne,selectedProps:{columnNames:["Name","Description","emoji"],columnKeys:["name","physical_description","emoji"],items:t.objects,entities:u,type:"object",editEntity:b}}),l.objects&&n.objects&&r.a.createElement("div",{className:"form-error"},l.objects)),r.a.createElement(_e,{title:"Preview"},r.a.createElement(E,{tile:t})),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",padding:"10px"}},r.a.createElement(d.b,{type:"reset",onClick:s,disabled:!(!isNaN(t.room)||!Object(g.isEmpty)(t.characters)||!Object(g.isEmpty)(t.objects)),style:{marginRight:"15px"}},"Clear"),r.a.createElement(d.b,{type:"reset",onClick:h,disabled:!c,style:{marginRight:"15px"}},"Reset"),r.a.createElement(d.b,{intent:f.a.PRIMARY,type:"submit",onClick:m,disabled:!o,style:{marginLeft:"15px"}},"Save Changes")))}))};function Fe(e){var t=e.selected,a=e.setSelected,n=e.resetShowAdvanced,i=e.showAdvanced,l=e.state;return r.a.createElement(d.h,{icon:"build",title:"Build Tile",isOpen:i&&t,onClose:function(){a(null),n()}},r.a.createElement("div",{className:J.a.DRAWER_BODY},r.a.createElement("div",{className:J.a.DIALOG_BODY},t&&r.a.createElement(Te,{x:t.x,y:t.y,currFloor:l.currFloor,getTileAt:l.getTileAt,initialInputs:l.getTileAt(t.x,t.y),inheritedInputs:t.data,handleSubmit:function(e){l.setTile(t.x,t.y,Object(h.a)(Object(h.a)({},l.getTileAt(t.x,t.y)),e)),a(null),n()},handleClear:function(){l.clearTile(t.x,t.y),a(null),n()},tileStyle:{width:150,height:150,maxWidth:150,maxHeight:150},entities:l.entities,findOrAddEntity:l.findOrAddEntity,editEntity:l.editEntity}))))}var Ae=function(e){var t=e.state,a=e.initialShowAdvanced,n=r.a.useState(null),i=Object(s.a)(n,2),l=i[0],c=i[1],o=r.a.useState(null),m=Object(s.a)(o,2),u=m[0],p=m[1],b=r.a.useState(!1),h=Object(s.a)(b,2),f=h[0],E=h[1],y=r.a.useState(!1),v=Object(s.a)(y,2),x=v[0],j=v[1];r.a.useEffect((function(){E(a)}),[a]);var O=function(e,t,a){Object(g.isEqual)(t,a)||(j(!0),p(null));for(var n=0;n<l.length;n++)l[n].i!==a.i&&(l[n].x===a.x&&l[n].y===a.y&&l[n].i!==a.i?(e[n].x=t.x,e[n].y=t.y):(e[n].x=l[n].x,e[n].y=l[n].y));return!0};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{width:150*t.dimensions.width+24*(t.dimensions.width+1)+60,margin:"0 auto 75px auto",textAlign:"center"}},r.a.createElement(d.b,{className:"bp3-button",disabled:t.dimensions.height>=10,style:{width:150*t.dimensions.width+24*(t.dimensions.width+1)-20,margin:"auto"},onClick:t.addRowTop,icon:"add"}),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(d.b,{className:"bp3-button",disabled:t.dimensions.width>=10,style:{height:150*t.dimensions.height+24*(t.dimensions.height+1)-20,margin:"10px 0"},onClick:t.addColFront,icon:"add"}),r.a.createElement("div",{className:"map-container",style:{width:150*t.dimensions.width+24*(t.dimensions.width+1),height:150*t.dimensions.height+24*(t.dimensions.height+1)}},r.a.createElement("div",{className:"walls"},function(){for(var e=[],a=0;a<t.dimensions.height;a++)for(var n=0;n<t.dimensions.width;n++)n>0&&function(){var i="".concat(n-1," ").concat(a,"|").concat(n," ").concat(a);e.push(r.a.createElement("div",{key:i,onClick:function(){return t.toggleWall(i)},className:"wall ".concat(t.map[t.currFloor].walls[i]?"active":""),style:{top:24+174*a,left:174*n+7,height:150}}))}(),a>0&&function(){var i="".concat(n," ").concat(a-1,"|").concat(n," ").concat(a);e.push(r.a.createElement("div",{key:i,onClick:function(){return t.toggleWall(i)},className:"wall ".concat(t.map[t.currFloor].walls[i]?"active":""),style:{left:24+174*n,top:174*a+7,width:150}}))}();return e}()),r.a.createElement(ve.a,{cols:t.dimensions.width,rowHeight:150,width:150*t.dimensions.width+24*(t.dimensions.width+1),onDragStart:function(e){c(Object(g.cloneDeep)(e))},onDrag:O,onDragStop:function(e,t,a){O(e,t,a),c([t.x,t.y,a.x,a.y])},margin:[24,24],onLayoutChange:function(){if(l){var e=Object(s.a)(l,4),a=e[0],n=e[1],r=e[2],i=e[3];a===r&&n===i||setTimeout((function(){return t.swapTiles(a,n,r,i)}),300),c(null)}},isResizable:!1,maxRows:t.dimensions.height,style:{width:150*t.dimensions.width+24*(t.dimensions.width+1)}},function(){for(var e=[],a=function(a){for(var n=function(n){var i=t.getTileAt(n,a,t.currFloor),l="".concat(t.currFloor," ").concat(n," ").concat(a," ").concat(i&&i&&i.room?i.room.id:"");e.push(r.a.createElement("div",{key:l,"data-grid":{x:n,y:a,w:1,h:1,draggableHandle:".react-grid-item-handle",draggableCancel:".react-grid-item",isDraggable:!Object(g.isEmpty)(i)},onClick:function(){x||u&&(!u||u.x===n&&u.y===a)?j(!1):p({x:n,y:a})}},r.a.createElement(ke,{x:n,y:a,tile:i,selected:u,setSelected:p,showAdvanced:f,setShowAdvanced:E,setTile:t.setTile,clearTile:t.clearTile,getTileAt:t.getTileAt,currFloor:t.currFloor,tileStyle:{width:150,height:150,maxWidth:150,maxHeight:150},state:t})))},i=0;i<t.dimensions.width;i++)n(i)},n=0;n<t.dimensions.height;n++)a(n);return e}())),r.a.createElement(d.b,{className:"bp3-button",disabled:t.dimensions.width>=10,style:{height:150*t.dimensions.height+24*(t.dimensions.height+1)-20,margin:"10px 0"},onClick:t.addColEnd,icon:"add"})),r.a.createElement(d.b,{className:"bp3-button",disabled:t.dimensions.height>=10,style:{width:150*t.dimensions.width+24*(t.dimensions.width+1)-20,margin:"auto"},onClick:t.addRowBot,icon:"add"})),r.a.createElement(Fe,{showAdvanced:f,selected:u,setSelected:p,resetShowAdvanced:function(){E(a)},state:t}))},De=a(140),Pe=a.n(De),Le=a(87),Be=a.n(Le);var Ge=function(e){var t=e.manager,a=e.map,n=e.currFloor,i=r.a.useState(!1),l=Object(s.a)(i,2),c=l[0],o=l[1],m=r.a.useState(null),u=Object(s.a)(m,2),p=u[0],b=u[1],h=r.a.useState({}),E=Object(s.a)(h,2),y=E[0],v=E[1],x=r.a.createRef(),j=a.map((function(e,t){return{name:e.name,index:t}})),O=Object(d.d)(Be()({displayName:"FloorButton",keypressHandler:function(e){"Enter"===e.key&&x.current.blur()},renderContextMenu:function(){var e=this;return o(!0),r.a.createElement(d.l,null,r.a.createElement(d.m,{icon:"edit",onClick:function(){return b(e.props.item.index)},text:"Edit Floor Name"}),r.a.createElement(d.m,{icon:"delete",disabled:j.length<=1,onClick:function(){v({confirmButtonText:"Confirm Delete",icon:"trash",intent:f.a.DANGER,onConfirm:function(){t.deleteFloor(e.props.item.index),v({})},content:"Are you sure you want to delete the entire ".concat(e.props.item.name," floor? All data on this floor and connections to this floor will be reset.")})},text:"Delete Floor"}))},onContextMenuClose:function(){o(!1)},handleBlur:function(e){t.editFloorName(e.target.value,this.props.item.index),b(null)},componentDidMount:function(){p===this.props.item.index&&(x.current.focus(),x.current.select())},render:function(){var e=this;return r.a.createElement("div",{style:{textAlign:"center",width:"100%",height:"100%",lineHeight:"30px",padding:"0px 5px"}},null!==p&&p===this.props.item.index?r.a.createElement(d.k,{inputRef:x,onBlur:this.handleBlur,defaultValue:this.props.item.name,onKeyPress:function(t){return e.keypressHandler(t)}}):r.a.createElement("div",null,this.props.item.name))}}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{confirmButtonText:y.confirmButtonText,cancelButtonText:"Cancel",icon:y.icon,intent:y.intent,isOpen:!Object(g.isEmpty)(y),onCancel:function(){y.onCancel&&y.onCancel(),v({})},onConfirm:y.onConfirm},r.a.createElement("p",null,y.content)),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(d.b,{disabled:a.length>=10,icon:"add",onClick:t.addFloor,style:{height:"30px"}}),r.a.createElement(Pe.a,{holdTime:"200",callback:function(e,a,n,r){n!==r&&v({confirmButtonText:"Confirm Reorder",icon:"layers",intent:f.a.WARNING,onConfirm:function(){t.reorderFloors(n,r),v({})},content:"Are you sure you want to reorder the entire ".concat(j[r].name," floor? All connections to and from this floor, in both positions, will be reset.")})},template:O,itemKey:"index",list:j,selected:j[n],itemClicked:function(e,a,n){c||p||t.setCurrFloor(n)},lock:"vertical",itemClass:"bp3-button floor-button"})))};function Ve(e){var t=ye(e.upload),a=r.a.useState(!1),n=Object(s.a)(a,2),i=n[0],l=n[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.i,{inline:!0,label:"World Dimensions",labelInfo:"WxH (Max ".concat(10,"x").concat(10,")")},r.a.createElement(d.e,null,r.a.createElement(d.o,{value:t.dimensions.width,style:{width:"3rem"},max:10,min:1,onValueChange:function(e){t.setDimensions(Object(h.a)(Object(h.a)({},t.dimensions),{},{width:e}))}}),r.a.createElement(d.o,{value:t.dimensions.height,style:{width:"3rem"},max:10,min:1,onValueChange:function(e){t.setDimensions(Object(h.a)(Object(h.a)({},t.dimensions),{},{height:e}))}}))),r.a.createElement(d.i,{inline:!0,label:r.a.createElement(r.a.Fragment,null,"Floor"," ",r.a.createElement(d.y,{content:"Right click floor for more options. Click and hold floor to reorder.",position:u.a.BOTTOM,className:"inline"},r.a.createElement(d.j,{icon:"help"}))),labelInfo:"Max ".concat(10),style:{marginBottom:"0px"}},r.a.createElement(Ge,{max:10,manager:t.floorManager,map:t.map,currFloor:t.currFloor})),r.a.createElement(d.i,{inline:!0,label:"Advanced"},r.a.createElement(d.u,{onChange:function(){return l(!i)},checked:!!i})),r.a.createElement(Ae,{state:t,initialShowAdvanced:i}),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end",position:"fixed",bottom:0,left:0,right:0,height:"50px"},className:"bp3-navbar"},r.a.createElement(d.b,{onClick:t.exportWorld,intent:"primary",style:{margin:"10px"}},"Export"),r.a.createElement(d.b,{onClick:t.postEdges,intent:"primary",style:{margin:"10px"}},"Commit Edges")))}var qe=function(e){var t=e.location;return r.a.createElement("div",null,r.a.createElement("h2",{"data-testid":"header",className:"bp3-heading"},"World Builder"),r.a.createElement("div",null,r.a.createElement(Ve,{upload:t.state})))};function Me(e){var t=e.type,a=e.initialInputs,n=e.handleSubmit;switch(t){case"object":return r.a.createElement(V,{type:t,initialInputs:a,handleSubmit:n});case"character":return r.a.createElement(M,{type:t,initialInputs:a,handleSubmit:n});case"room":return r.a.createElement(U,{type:t,initialInputs:a,handleSubmit:n});default:return"This entity cannot be edited at the moment"}}function He(){return(He=Object(R.a)(I.a.mark((function e(t,a,n){var r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.map((function(e){return Ue(t,e.property,e.editedValue)})),e.next=3,Promise.all(r).then((function(){n.push("/")}));case 3:W.show({intent:f.a.SUCCESS,message:"Successfully created edits"});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(e,t,a){return w("edits",{id:e,field:t,edited_value:a,player:1})}var We=function(e){var t=e.match,a=e.location,n=r.a.useState(void 0),i=Object(s.a)(n,2),l=i[0],c=i[1],m=C(j,"/entities/".concat(t.params.id),{},a.state),u=m.loading,p=m.result,b=r.a.useState({}),h=Object(s.a)(b,2),E=h[0],y=h[1],v=r.a.useState(!1),x=Object(s.a)(v,2),O=x[0],w=x[1],S=r.a.useState([]),k=Object(s.a)(S,2),_=k[0],N=k[1],I=Object(o.f)();return!u&&Object(g.isEmpty)(E)&&(Object(g.isEmpty)(p)||Object(g.isEmpty)(p.entity)?(y({id:t.params.id}),c("invalid")):(y(p.entity),c(p.type))),r.a.createElement("div",null,r.a.createElement(d.f,{icon:"info-sign",onClose:function(){return w(!1)},title:"Confirm edits for Entity ".concat(t.params.id),isOpen:O,usePortal:!1},r.a.createElement("div",{className:J.a.DIALOG_BODY},_.map((function(e,t){return r.a.createElement("p",{key:t},r.a.createElement("strong",null,e.property),": ",e.editedValue.toString())}))),r.a.createElement("div",{className:J.a.DIALOG_FOOTER},r.a.createElement("div",{className:J.a.DIALOG_FOOTER_ACTIONS},r.a.createElement(d.b,{onClick:function(){return w(!1)}},"Close"),r.a.createElement(d.b,{intent:f.a.PRIMARY,onClick:function(){return function(e,t,a){return He.apply(this,arguments)}(t.params.id,_,I)}},"Confirm Edits")))),r.a.createElement("h2",{"data-testid":"header",className:"bp3-heading"},"Editing Entity ",t.params.id),r.a.createElement("div",{className:"bp3-text-large"},u?r.a.createElement(d.t,{intent:f.a.PRIMARY}):r.a.createElement(Me,{type:l,initialInputs:E,handleSubmit:function(e){var t=[];for(var a in e)e[a]!==E[a]&&t.push({property:a,editedValue:e[a]});N(t),w(!0)}})))};function Ye(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement("div",{style:{margin:"40px 30px"}},r.a.createElement(o.b,{path:"/explore",component:_}),r.a.createElement(o.b,{path:"/create",component:K}),r.a.createElement(o.b,{path:"/review",component:te}),r.a.createElement(o.b,{path:"/world_builder",render:function(e){return r.a.createElement(qe,Object.assign({},e,{key:Math.random()}))}}),r.a.createElement(o.b,{path:"/edit/:id",component:We}),r.a.createElement(o.b,{exact:!0,path:"/",render:function(){return r.a.createElement(o.a,{to:"/explore"})}})))}var Ke=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,null,r.a.createElement(Ye,null)))};a(255),a(256),a(257);l.a.render(r.a.createElement(Ke,null),document.getElementById("root"))}},[[169,1,2]]]);
//# sourceMappingURL=main.2fc5dd15.chunk.js.map