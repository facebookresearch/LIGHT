{"version":3,"sources":["components/WorldFileUpload.js","components/NavBar.js","config.js","utils.js","components/ExplorePage.js","components/forms/BaseSuggest.js","components/forms/ObjectForm.js","components/forms/CharacterForm.js","components/forms/RoomForm.js","components/AppToaster.js","components/CreatePage.js","components/ReviewPage.js","components/worldbuilding/utils.js","components/forms/ColorPicker.js","components/forms/BaseMultiSelect.js","components/forms/TileForm.js","components/worldbuilding/Tile.js","components/forms/AdvancedTileForm.js","components/worldbuilding/Grid.js","components/worldbuilding/FloorSelector.js","components/WorldBuilderPage.js","components/EditPage.js","App.js","index.js"],"names":["WorldFileUpload","setPopover","inputRef","React","useRef","useState","undefined","file","setFile","onChange","e","fileReader","FileReader","onload","event","JSON","parse","target","result","files","readAsText","type","ref","style","display","to","pathname","state","data","icon","onClick","current","click","text","shouldDismissPopover","NavBar","children","worldBuildPopover","setWorldBuildPopover","Fragment","Group","align","Alignment","LEFT","Heading","Divider","data-testid","className","position","Position","BOTTOM_LEFT","minimal","isOpen","color","tagName","DEV","host","port","useDidChange","val","value","useEffect","usePrevious","useAPI","CONFIG","url","preloaded","body","params","loading","setState","newUrl","isSubscribed","fetch","then","res","json","catch","err","console","log","reload","post","payload","formBody","property","encodedKey","encodeURIComponent","encodedValue","stringify","push","method","headers","join","ItemsList","items","descriptionField","additionalFields","selectedEntity","expanded","animating","nextState","length","width","map","field","key","name","item","index","id","handleTrClick","background","colSpan","padding","cursor","duration","height","easing","onAnimationEnd","animateOpacity","ExpandedTab","flexDirection","Object","keys","startCase","justifyContent","margin","entity","ExplorePage","setSelectedEntity","page","setPage","searchText","setSearchText","placeholder","dir","marginBottom","inline","large","selectedValue","label","intent","Intent","PRIMARY","previousLabel","nextLabel","breakLabel","forcePage","pageCount","total_pages","marginPagesDisplayed","pageRangeDisplayed","onPageChange","selected","containerClassName","subContainerClassName","activeClassName","renderItemList","filteredItems","renderItem","topResults","slice","textAlign","disabled","renderOption","obj","handleClick","modifiers","matchesPredicate","active","BaseSuggest","errors","touched","setFieldTouched","formValue","handleChange","onItemSelect","entities","setItems","query","setQuery","currItem","setCurrItem","localEntities","values","results","concat","filter","self","findIndex","t","equal","isNaN","onBlur","itemRenderer","itemListRenderer","inputValueRenderer","inputProps","DANGER","popoverProps","usePortal","itemPredicate","_index","exactMatch","normalizedTitle","toLowerCase","normalizedQuery","string","indexOf","selectedItem","onQueryChange","q","resetOnQuery","emptyObjectForm","name_prefix","physical_description","base_id","is_container","is_drink","is_food","is_gettable","is_plural","is_surface","is_weapon","is_wearable","ObjectForm","initialInputs","handleSubmit","initialValues","validate","onSubmit","props","setFieldValue","dirty","isValid","handleBlur","handleReset","handleSwitch","labelInfo","labelFor","growVertically","fill","marginLeft","checked","alignIndicator","RIGHT","marginRight","emptyCharacterForm","persona","char_type","CharacterForm","emptyRoomForm","description","backstory","RoomForm","AppToaster","Toaster","create","TOP","CreateForm","history","useHistory","submitEntity","a","show","SUCCESS","message","CreatePage","location","formType","setFormType","EditsList","edits","status","rows","all","setSelected","submitAction","setSubmitAction","showDialog","setShowDialog","pendingSubmission","setPendingSubmission","handleTdClick","reqs","edit_id","Promise","Array","showSubmission","action","i","onClose","title","Classes","DIALOG_BODY","edit","DIALOG_FOOTER","DIALOG_FOOTER_ACTIONS","indeterminate","newRows","newSelection","every","r","handleCheckbox","orig","diff","differ","DiffMatchPatch","diff_main","diff_cleanupSemantic","d","unedited_value","edited_value","Card","alignItems","flexGrow","maxWidth","fontSize","ReviewPage","selectedStatus","setSelectedStatus","TILE_COLORS","Colors","GRAY3","VIOLET5","RED5","SEPIA5","GOLD5","FOREST5","BLUE5","grass","water","buildings","royal","brick","path","farm","findBiome","lowName","some","biome","invertColor","hex","parseInt","findEmoji","emojiIndex","search","native","words","split","charAt","substring","mapReducer","floor","floorIndex","tiles","x","y","newTile","createdEntitiesReducer","assign","entityType","nextID","merge","useWorldBuilder","upload","dimensions","floors","setDimensions","initialMap","walls","useReducer","mapDispatch","room","character","object","entitiesDispatch","currFloor","setCurrFloor","newMap","f","removeStairsTile","baseMap","stairDown","stairUp","removeStairsFloor","stair","isEmpty","forEach","filteredMap","filtered","newFloor","newTiles","tile","postEdges","store","characters","objects","createReqs","edgeReqs","coord","chars","objs","neighbors","neighbor","wall","includes","floorManager","addFloor","deleteFloor","_floor","reorderFloors","i1","i2","reorderedFloor","editFloorName","newName","setTile","clearTile","cloneDeep","swapTiles","x1","y1","x2","y2","getTileAt","toggleWall","addRowTop","tileKeys","wallKeys","newWalls","t1","t2","addRowBot","addColFront","addColEnd","editEntity","findOrAddEntity","addEntity","exportWorld","element","document","createElement","setAttribute","Date","now","toString","appendChild","removeChild","ColorPicker","colors","advanced","maxHeight","borderRadius","borderColor","borderStyle","borderWidth","boxShadow","BaseMultiSelect","tooltip","currItems","setCurrItems","content","targetTagName","popoverClassName","TOP_RIGHT","tagInputProps","onRemove","_value","newItems","_item","change","selectedItems","tagRenderer","emptyTileForm","TileForm","onClear","setShowAdvanced","alignContent","HEADING","iconSize","fullValue","emoji","Tile","showAdvanced","tileStyle","toggleStairs","stopPropagation","toggleTo","otherFloor","newConnectedTile","contentColor","opacity","bottom","left","top","right","backgroundColor","overflow","char","Hideable","initialOpen","open","setOpen","SelectedTableView","columnNames","columnKeys","handleEdit","handleDuplicate","handleDelete","EmojiTD","showPicker","setShowPicker","interactionKind","PopoverInteractionKind","CLICK","onInteraction","wrapperTagName","onSelect","col","selectOrCreateState","BASE","CHOOSE","SELECT_FROM_EXISTING","CREATE_NEW","EDIT","DUPLICATE","SelectFromExistingOrCreateNew","initialState","SelectFromExisting","selectFromExistingProps","Form","formProps","handleCreateSubmit","handleEditSubmit","Selected","selectedProps","editing","setEditing","duplicating","setDuplicating","isArray","splice","AdvancedTileForm","inheritedInputs","handleClear","TilePreview","isInitialValid","setRoomValue","marginTop","AdvancedEditor","resetShowAdvanced","DRAWER_BODY","Grid","initialShowAdvanced","layout","setLayout","dragging","setDragging","onDragEvent","newState","initial","next","isEqual","j","generateWalls","cols","rowHeight","onDragStart","onDrag","onDragStop","onLayoutChange","setTimeout","isResizable","maxRows","data-grid","w","h","draggableHandle","draggableCancel","isDraggable","generateTiles","FloorSelector","manager","contextShowing","setContextShowing","confirmAlert","setConfirmAlert","createRef","FloorButton","ContextMenuTarget","createReactClass","keypressHandler","blur","renderContextMenu","confirmButtonText","onConfirm","onContextMenuClose","this","componentDidMount","focus","select","render","lineHeight","defaultValue","onKeyPress","cancelButtonText","onCancel","holdTime","callback","_e","initialIndex","newIndex","WARNING","template","itemKey","list","itemClicked","lock","itemClass","WorldBuilder","setAdvanced","max","min","onValueChange","BOTTOM","WorldBuilderPage","EditForm","submitEdit","editedValue","player","EditPage","match","setInitialInputs","pendingEdits","setPendingEdits","submitEdits","Routes","component","exact","Math","random","App","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.58b96423.chunk.js","sourcesContent":["import React from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { MenuItem } from \"@blueprintjs/core\";\n\nfunction WorldFileUpload({ setPopover }) {\n  const inputRef = React.useRef();\n  const [file, setFile] = React.useState(undefined);\n  return (\n    <>\n      <input\n        onChange={e => {\n          setFile(undefined);\n          const fileReader = new FileReader();\n          fileReader.onload = function(event) {\n            setFile(JSON.parse(event.target.result));\n          };\n          const file = e.target.files[0];\n          fileReader.readAsText(file);\n          setPopover(false);\n        }}\n        type=\"file\"\n        ref={inputRef}\n        style={{ display: \"none\" }}\n      />\n      {file && (\n        <Redirect to={{ pathname: \"/world_builder\", state: { data: file } }} />\n      )}\n      <MenuItem\n        icon=\"upload\"\n        onClick={() => inputRef.current.click()}\n        text=\"Upload File\"\n        shouldDismissPopover={false}\n      />\n    </>\n  );\n}\n\nexport default WorldFileUpload;\n","import React from \"react\";\nimport {\n  Navbar,\n  Alignment,\n  Button,\n  Position,\n  Popover,\n  Menu,\n  MenuItem\n} from \"@blueprintjs/core\";\nimport { Link } from \"react-router-dom\";\n\nimport WorldFileUpload from \"./WorldFileUpload\";\n\nfunction NavBar({ children }) {\n  const [worldBuildPopover, setWorldBuildPopover] = React.useState(false);\n  return (\n    <React.Fragment>\n      <Navbar>\n        <Navbar.Group align={Alignment.LEFT}>\n          <Navbar.Heading>LIGHT Data Model</Navbar.Heading>\n          <Navbar.Divider />\n          <Link data-testid=\"link-explore\" className=\"btn-link\" to=\"/explore\">\n            <Button className=\"bp3-minimal\" icon=\"path-search\" text=\"Explore\" />\n          </Link>\n          <Link data-testid=\"link-create\" className=\"btn-link\" to=\"/create\">\n            <Button className=\"bp3-minimal\" icon=\"cube\" text=\"Create\" />\n          </Link>\n          <Link data-testid=\"link-review\" className=\"btn-link\" to=\"/review\">\n            <Button className=\"bp3-minimal\" icon=\"form\" text=\"Review Edits\" />\n          </Link>\n          <Popover\n            position={Position.BOTTOM_LEFT}\n            minimal\n            isOpen={worldBuildPopover}\n          >\n            <Button\n              onClick={() => setWorldBuildPopover(!worldBuildPopover)}\n              className=\"bp3-minimal\"\n              icon=\"map-create\"\n              text=\"Build World\"\n            />\n            <Menu>\n              <MenuItem\n                icon=\"new-object\"\n                text={\n                  <Link\n                    onClick={() => setWorldBuildPopover(false)}\n                    style={{ color: \"inherit\" }}\n                    data-testid=\"link-world-builder\"\n                    className=\"btn-link\"\n                    to=\"/world_builder\"\n                  >\n                    Create New\n                  </Link>\n                }\n                shouldDismissPopover={true}\n                tagName=\"div\"\n              />\n              <WorldFileUpload setPopover={setWorldBuildPopover} />\n            </Menu>\n          </Popover>\n        </Navbar.Group>\n      </Navbar>\n      {children}\n    </React.Fragment>\n  );\n}\n\nexport default NavBar;\n","const DEV = {\n  host: \"http://localhost\",\n  port: \"35495\"\n};\n\nexport default DEV;\n","import React from \"react\";\n\nimport CONFIG from \"./config\";\n\nexport function usePrevious(value) {\n  const ref = React.useRef();\n  React.useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\nexport function useDidChange(val) {\n  const prevVal = usePrevious(val);\n  return prevVal !== val;\n}\n\nexport function useAPI(CONFIG, url, { body, params } = {}, preloaded) {\n  const [state, setState] = React.useState({\n    loading: true,\n    result: undefined\n  });\n\n  const newUrl = useDidChange(url);\n\n  React.useEffect(() => {\n    if (state.loading && preloaded) {\n      setState({ loading: false, result: preloaded });\n      return;\n    }\n    if (newUrl) {\n      setState({ loading: true, result: undefined });\n      return;\n    }\n    let isSubscribed = true;\n\n    if (state.loading) {\n      fetch(CONFIG.host + \":\" + CONFIG.port + url)\n        .then(res => res.json())\n        .then(data => {\n          if (isSubscribed) {\n            setState({ loading: false, result: data });\n          }\n        })\n        .catch(err => console.log(\"Error fetching data\"));\n    }\n\n    return () => (isSubscribed = false);\n  }, [CONFIG.host, CONFIG.port, url, newUrl, preloaded, state]);\n\n  const reload = () => {\n    setState({ loading: true, result: undefined });\n  };\n\n  return {\n    loading: state.loading,\n    result: state.result,\n    reload\n  };\n}\n\nexport function post(url, payload) {\n  const formBody = [];\n  for (let property in payload) {\n    const encodedKey = encodeURIComponent(property);\n    const encodedValue = encodeURIComponent(\n      typeof payload[property] === \"object\"\n        ? JSON.stringify(payload[property])\n        : payload[property]\n    );\n    formBody.push(encodedKey + \"=\" + encodedValue);\n  }\n  return fetch(`${CONFIG.host}:${CONFIG.port}/${url}`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\"\n    },\n    body: formBody.join(\"&\")\n  });\n}\n","import React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Intent, Spinner, RadioGroup, Radio } from \"@blueprintjs/core\";\nimport AnimateHeight from \"react-animate-height\";\nimport { startCase } from \"lodash\";\nimport ReactPaginate from \"react-paginate\";\n\nimport CONFIG from \"../config\";\nimport { useAPI } from \"../utils\";\n\nfunction ExplorePage() {\n  const [selectedEntity, setSelectedEntity] = React.useState(\"object\");\n  const [page, setPage] = React.useState(0);\n\n  const [searchText, setSearchText] = React.useState(\"\");\n  const { loading, result } = useAPI(\n    CONFIG,\n    \"/entities/\" + selectedEntity + \"?search=\" + searchText + \"&page=\" + page\n  );\n\n  return (\n    <div>\n      <h2 data-testid=\"header\" className=\"bp3-heading\">\n        Explore\n      </h2>\n      <div className=\"bp3-text-large\">\n        Search across the LIGHT database for existing objects, characters, or\n        rooms.\n      </div>\n      <div\n        className=\"bp3-input-group bp3-large\"\n        style={{ margin: \"20px 0px 10px\" }}\n      >\n        <span className=\"bp3-icon bp3-icon-search\" />\n        <input\n          className=\"bp3-input\"\n          type=\"search\"\n          placeholder=\"Search...\"\n          dir=\"auto\"\n          value={searchText}\n          onChange={e => {\n            setSearchText(e.target.value);\n            setPage(0);\n          }}\n        />\n      </div>\n      <div style={{ display: \"flex\", marginBottom: 30 }}>\n        <span style={{ margin: \"0px 20px 0px 40px\" }}>Searching category:</span>\n        <RadioGroup\n          inline\n          large\n          onChange={e => {\n            setSelectedEntity(e.target.value);\n            setPage(0);\n          }}\n          selectedValue={selectedEntity}\n        >\n          <Radio data-testid=\"radio-object\" label=\"Objects\" value=\"object\" />\n          <Radio\n            data-testid=\"radio-character\"\n            label=\"Characters\"\n            value=\"character\"\n          />\n          <Radio data-testid=\"radio-room\" label=\"Rooms\" value=\"room\" />\n        </RadioGroup>\n      </div>\n\n      {loading ? (\n        <Spinner intent={Intent.PRIMARY} />\n      ) : (\n        <>\n          <ItemsList\n            items={result.data}\n            descriptionField={\n              selectedEntity === \"room\" ? \"description\" : \"physical_description\"\n            }\n            additionalFields={\n              selectedEntity === \"room\"\n                ? [{ name: \"Backstory\", key: \"backstory\" }]\n                : []\n            }\n            selectedEntity={selectedEntity}\n          />\n          <div style={{ margin: \"20px\" }}>\n            <ReactPaginate\n              previousLabel={\"previous\"}\n              nextLabel={\"next\"}\n              breakLabel={\"...\"}\n              forcePage={page}\n              pageCount={result.total_pages}\n              marginPagesDisplayed={2}\n              pageRangeDisplayed={5}\n              onPageChange={data => setPage(data.selected)}\n              containerClassName={\"pagination\"}\n              subContainerClassName={\"pages pagination\"}\n              activeClassName={\"active\"}\n            />\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n\nfunction ItemsList({\n  items,\n  descriptionField,\n  additionalFields = [],\n  selectedEntity\n}) {\n  const [state, setState] = React.useState({\n    expanded: -1,\n    animating: 0,\n    nextState: -1\n  });\n\n  function handleTrClick(index) {\n    if (state.expanded === -1) {\n      setState({ expanded: index, animating: 2, nextState: -1 });\n    } else if (state.expanded === index) {\n      setState({ expanded: index, animating: 3, nextState: -1 });\n    } else {\n      setState({ ...state, animating: 3, nextState: index });\n    }\n  }\n\n  if (items === undefined || items.length === 0) {\n    return <span>No items found.</span>;\n  } else {\n    return (\n      <table\n        data-testid=\"table-explore\"\n        style={{ width: \"100%\" }}\n        className=\"bp3-html-table bp3-html-table-condensed bp3-interactive\"\n      >\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Description</th>\n            {additionalFields.map(field => (\n              <th key={field}>{field.name}</th>\n            ))}\n\n            <th>ID</th>\n          </tr>\n        </thead>\n        <tbody>\n          {items.map((item, index) => (\n            <React.Fragment key={item.id}>\n              <tr\n                onClick={() => handleTrClick(index)}\n                data-testid=\"tr-explore\"\n                style={{\n                  background:\n                    index % 2 === 0 ? \"rgba(191, 204, 214, 0.15)\" : undefined\n                }}\n              >\n                <td>\n                  <strong>{item.name}</strong>\n                </td>\n                <td>{item[descriptionField]}</td>\n                {additionalFields.map(field => (\n                  <td key={field.name}>{item[field.key]}</td>\n                ))}\n                <td>{item.id}</td>\n              </tr>\n              <tr\n                style={{\n                  background:\n                    index % 2 === 0 ? \"rgba(191, 204, 214, 0.15)\" : undefined\n                }}\n              >\n                <td\n                  colSpan={5}\n                  style={{\n                    display: state.expanded === index ? undefined : \"none\",\n                    padding: 0,\n                    cursor: \"unset\"\n                  }}\n                >\n                  <AnimateHeight\n                    duration={500}\n                    height={\n                      state.expanded === index &&\n                      (state.animating === 2 || state.animating === 0)\n                        ? \"auto\"\n                        : 0\n                    }\n                    easing={\"ease\"}\n                    onAnimationEnd={() =>\n                      setState({\n                        nextState: -1,\n                        expanded:\n                          state.animating === 2 ? index : state.nextState,\n                        animating:\n                          state.animating === 3 && state.nextState !== -1\n                            ? 2\n                            : 0\n                      })\n                    }\n                    animateOpacity={true}\n                  >\n                    {state.expanded === index && (\n                      <ExpandedTab\n                        item={item}\n                        selectedEntity={selectedEntity}\n                      />\n                    )}\n                  </AnimateHeight>\n                </td>\n              </tr>\n            </React.Fragment>\n          ))}\n        </tbody>\n      </table>\n    );\n  }\n}\n\nfunction ExpandedTab({ item, selectedEntity }) {\n  return (\n    <>\n      <div\n        data-testid=\"dropdown\"\n        style={{\n          padding: \"20px 40px 0 40px\"\n        }}\n      >\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\"\n          }}\n        >\n          {Object.keys(item).map((key, index) => (\n            <p key={index}>\n              <strong>{startCase(key)}</strong>: {item[key]}\n            </p>\n          ))}\n        </div>\n      </div>\n      <div\n        style={{\n          display: \"flex\",\n          padding: \"0 20px 20px 20px\",\n          justifyContent: \"flex-end\"\n        }}\n      >\n        <Link\n          style={{ margin: \"0 5px\" }}\n          className=\"bp3-button bp3-small\"\n          to={{\n            pathname: `/create`,\n            state: {\n              type: selectedEntity,\n              entity: item\n            }\n          }}\n        >\n          Create From\n        </Link>\n        <Link\n          style={{ margin: \"0 5px\" }}\n          className=\"bp3-button bp3-small\"\n          to={{\n            pathname: `/edit/${item.id}`,\n            state: {\n              type: selectedEntity,\n              entity: item\n            }\n          }}\n        >\n          Edit\n        </Link>\n      </div>\n    </>\n  );\n}\n\nexport default ExplorePage;\n","import React from \"react\";\nimport { Intent, Menu, MenuItem } from \"@blueprintjs/core\";\nimport { Suggest } from \"@blueprintjs/select\";\nimport equal from \"fast-deep-equal\";\nimport \"@blueprintjs/select/lib/css/blueprint-select.css\";\n\nimport CONFIG from \"../../config\";\nimport { useAPI } from \"../../utils\";\n\nconst SUGGEST_SIZE = 100;\n\nfunction BaseSuggest({\n  id,\n  name,\n  errors,\n  touched,\n  setFieldTouched,\n  formValue,\n  handleChange,\n  type,\n  onItemSelect,\n  entities\n}) {\n  const [items, setItems] = React.useState([]);\n  const [query, setQuery] = React.useState(\"\");\n  const [currItem, setCurrItem] = React.useState(formValue);\n  const { loading, result } = useAPI(\n    CONFIG,\n    `/entities/${type}?search=${query}`\n  );\n\n  React.useEffect(() => {\n    if (!loading) {\n      if (entities) {\n        const localEntities = Object.values(entities[type]);\n        const results = localEntities\n          .concat(result.slice(0, SUGGEST_SIZE + localEntities.length + 1))\n          .filter(\n            (item, index, self) => self.findIndex(t => equal(t, item)) === index\n          );\n\n        return setItems(results);\n      }\n      return setItems(result);\n    }\n  }, [result, loading, entities, type]);\n\n  React.useEffect(() => {\n    if (entities) {\n      return setCurrItem(formValue);\n    }\n    // When Reset is clicked on the form\n    if (isNaN(formValue)) {\n      return setCurrItem(null);\n    }\n    for (let item in items) {\n      if (items[item].id === formValue) {\n        return setCurrItem(items[item]);\n      }\n    }\n  }, [formValue, items, entities]);\n\n  const filterItems = (query, obj, _index, exactMatch) => {\n    const normalizedTitle = obj.name.toLowerCase();\n    const normalizedQuery = query.toLowerCase();\n    if (exactMatch) {\n      return normalizedTitle === normalizedQuery;\n    } else {\n      let string = \"\";\n      for (let key in obj) {\n        string += obj[key] + \". \";\n      }\n      const result = string.toLowerCase().indexOf(normalizedQuery) >= 0;\n      return result;\n    }\n  };\n\n  return (\n    <div onBlur={e => setFieldTouched(name)}>\n      <Suggest\n        id={id}\n        name={name}\n        items={items}\n        itemRenderer={renderOption}\n        itemListRenderer={renderItemList}\n        inputValueRenderer={item =>\n          entities && entities[type][item]\n            ? entities[type][item].name\n            : item.name\n        }\n        inputProps={{\n          intent: errors && touched ? Intent.DANGER : null,\n          \"data-testid\": \"base-suggest\"\n        }}\n        onItemSelect={e => {\n          if (onItemSelect) {\n            const result = onItemSelect(e, type);\n            setCurrItem(result);\n            handleChange(name, result, e);\n          } else {\n            setCurrItem(e);\n            handleChange(name, e.id, e);\n          }\n          setQuery(\"\");\n        }}\n        popoverProps={{ usePortal: false }}\n        itemPredicate={filterItems}\n        selectedItem={currItem}\n        query={query}\n        onQueryChange={q => setQuery(q)}\n        resetOnQuery={true}\n      />\n    </div>\n  );\n}\n\nfunction renderItemList({ filteredItems, renderItem }) {\n  const topResults = filteredItems.slice(0, SUGGEST_SIZE);\n  return (\n    <Menu>\n      {filteredItems.length > 0 ? (\n        <>\n          {topResults.map((item, index) => {\n            return renderItem(item, index);\n          })}\n          {filteredItems.length > SUGGEST_SIZE && (\n            <MenuItem\n              style={{ textAlign: \"center\" }}\n              disabled={true}\n              text=\"...\"\n            />\n          )}\n        </>\n      ) : (\n        <MenuItem disabled={true} text=\"No results.\" />\n      )}\n    </Menu>\n  );\n}\n\nfunction renderOption(obj, { handleClick, modifiers, index }) {\n  if (!modifiers.matchesPredicate) {\n    return null;\n  }\n\n  return (\n    <MenuItem\n      active={modifiers.active}\n      key={index}\n      onClick={handleClick}\n      text={obj.name}\n      shouldDismissPopover={false}\n    />\n  );\n}\n\nexport default BaseSuggest;\n","import React from \"react\";\nimport {\n  Button,\n  FormGroup,\n  Intent,\n  InputGroup,\n  Switch,\n  TextArea,\n  Alignment\n} from \"@blueprintjs/core\";\nimport { Formik } from \"formik\";\n\nimport BaseSuggest from \"./BaseSuggest\";\n\nfunction ObjectForm({ initialInputs, handleSubmit, type }) {\n  return (\n    <Formik\n      initialValues={initialInputs}\n      validate={values => {\n        let errors = {};\n        if (!values.name) {\n          errors.name = \"Required\";\n        }\n        if (!values.name_prefix) {\n          errors.name_prefix = \"Required\";\n        }\n        if (!values.physical_description) {\n          errors.physical_description = \"Required\";\n        }\n        if (!values.base_id) {\n          errors.base_id = \"Required\";\n        }\n        return errors;\n      }}\n      onSubmit={handleSubmit}\n    >\n      {props => {\n        const {\n          values,\n          setFieldValue,\n          touched,\n          setFieldTouched,\n          errors,\n          dirty,\n          isValid,\n          handleChange,\n          handleBlur,\n          handleSubmit,\n          handleReset\n        } = props;\n\n        const handleSwitch = e => {\n          const { name } = e.target;\n          setFieldValue(name, values[name] ? 0 : 1);\n        };\n\n        return (\n          <form data-testid=\"form\">\n            <FormGroup\n              label=\"Name\"\n              labelInfo=\"(required)\"\n              labelFor=\"name-input\"\n            >\n              <InputGroup\n                id=\"name-input\"\n                name=\"name\"\n                intent={errors.name && touched.name ? Intent.DANGER : null}\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.name}\n              />\n              {errors.name && touched.name && (\n                <div className=\"form-error\">{errors.name}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Name Prefix\"\n              labelInfo=\"(required)\"\n              labelFor=\"name-prefix-input\"\n            >\n              <InputGroup\n                id=\"name-prefix-input\"\n                name=\"name_prefix\"\n                intent={\n                  errors.name_prefix && touched.name_prefix\n                    ? Intent.DANGER\n                    : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.name_prefix}\n              />\n              {errors.name_prefix && touched.name_prefix && (\n                <div className=\"form-error\">{errors.name_prefix}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Physical Description\"\n              labelInfo=\"(required)\"\n              labelFor=\"physical-description-input\"\n            >\n              <TextArea\n                id=\"physical-description-input\"\n                name=\"physical_description\"\n                growVertically={true}\n                fill={true}\n                intent={\n                  errors.physical_description && touched.physical_description\n                    ? Intent.DANGER\n                    : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.physical_description}\n              />\n              {errors.physical_description && touched.physical_description && (\n                <div className=\"form-error\">{errors.physical_description}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Base Object\"\n              labelInfo=\"(required)\"\n              labelFor=\"base-id-input\"\n            >\n              <BaseSuggest\n                id=\"base-id-input\"\n                name=\"base_id\"\n                type={`base_${type}`}\n                errors={errors.base_id}\n                touched={touched.base_id}\n                setFieldTouched={setFieldTouched}\n                formValue={values.base_id}\n                handleChange={setFieldValue}\n              />\n              {errors.base_id && touched.base_id && (\n                <div className=\"form-error\">{errors.base_id}</div>\n              )}\n            </FormGroup>\n            <FormGroup label=\"Properties\" labelInfo=\"(required)\" large={true}>\n              <div style={{ marginLeft: \"15px\", width: \"150px\" }}>\n                <Switch\n                  label=\"Container\"\n                  name=\"is_container\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_container}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Drink\"\n                  name=\"is_drink\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_drink}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Food\"\n                  name=\"is_food\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_food}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Gettable\"\n                  name=\"is_gettable\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_gettable}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Plural\"\n                  name=\"is_plural\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_plural}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Surface\"\n                  name=\"is_surface\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_surface}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Weapon\"\n                  name=\"is_weapon\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_weapon}\n                  alignIndicator={Alignment.RIGHT}\n                />\n                <Switch\n                  label=\"Wearable\"\n                  name=\"is_wearable\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_wearable}\n                  alignIndicator={Alignment.RIGHT}\n                />\n              </div>\n            </FormGroup>\n\n            <Button\n              type=\"reset\"\n              onClick={handleReset}\n              disabled={!dirty}\n              style={{ marginRight: \"15px\" }}\n            >\n              Reset\n            </Button>\n            <Button\n              intent={Intent.PRIMARY}\n              type=\"submit\"\n              onClick={handleSubmit}\n              disabled={!dirty || !isValid}\n              style={{ marginLeft: \"15px\" }}\n            >\n              Save Changes\n            </Button>\n          </form>\n        );\n      }}\n    </Formik>\n  );\n}\n\nexport const emptyObjectForm = {\n  name: \"\",\n  name_prefix: \"\",\n  physical_description: \"\",\n  base_id: 0,\n  is_container: 0,\n  is_drink: 0,\n  is_food: 0,\n  is_gettable: 0,\n  is_plural: 0,\n  is_surface: 0,\n  is_weapon: 0,\n  is_wearable: 0\n};\n\nexport default ObjectForm;\n","import React from \"react\";\nimport {\n  Button,\n  FormGroup,\n  Intent,\n  InputGroup,\n  Switch,\n  TextArea,\n  Alignment\n} from \"@blueprintjs/core\";\nimport { Formik } from \"formik\";\n\nimport BaseSuggest from \"./BaseSuggest\";\n\nfunction CharacterForm({ initialInputs, handleSubmit, type }) {\n  return (\n    <Formik\n      initialValues={initialInputs}\n      validate={values => {\n        let errors = {};\n        if (!values.name) {\n          errors.name = \"Required\";\n        }\n        if (!values.name_prefix) {\n          errors.name_prefix = \"Required\";\n        }\n        if (!values.persona) {\n          errors.persona = \"Required\";\n        }\n        if (!values.physical_description) {\n          errors.physical_description = \"Required\";\n        }\n        if (!values.char_type) {\n          errors.char_type = \"Required\";\n        }\n        if (!values.base_id) {\n          errors.base_id = \"Required\";\n        }\n        return errors;\n      }}\n      onSubmit={handleSubmit}\n    >\n      {props => {\n        const {\n          values,\n          setFieldValue,\n          touched,\n          setFieldTouched,\n          errors,\n          dirty,\n          isValid,\n          handleChange,\n          handleBlur,\n          handleSubmit,\n          handleReset\n        } = props;\n\n        const handleSwitch = e => {\n          const { name } = e.target;\n          setFieldValue(name, values[name] ? 0 : 1);\n        };\n\n        return (\n          <form data-testid=\"form\">\n            <FormGroup\n              label=\"Name\"\n              labelInfo=\"(required)\"\n              labelFor=\"name-input\"\n            >\n              <InputGroup\n                id=\"name-input\"\n                name=\"name\"\n                intent={errors.name && touched.name ? Intent.DANGER : null}\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.name}\n              />\n              {errors.name && touched.name && (\n                <div className=\"form-error\">{errors.name}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Name Prefix\"\n              labelInfo=\"(required)\"\n              labelFor=\"name-prefix-input\"\n            >\n              <InputGroup\n                id=\"name-prefix-input\"\n                name=\"name_prefix\"\n                intent={\n                  errors.name_prefix && touched.name_prefix\n                    ? Intent.DANGER\n                    : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.name_prefix}\n              />\n              {errors.name_prefix && touched.name_prefix && (\n                <div className=\"form-error\">{errors.name_prefix}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Persona\"\n              labelInfo=\"(required)\"\n              labelFor=\"persona-input\"\n            >\n              <TextArea\n                id=\"persona-input\"\n                name=\"persona\"\n                growVertically={true}\n                fill={true}\n                intent={\n                  errors.persona && touched.persona ? Intent.DANGER : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.persona}\n              />\n              {errors.persona && touched.persona && (\n                <div className=\"form-error\">{errors.persona}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Physical Description\"\n              labelInfo=\"(required)\"\n              labelFor=\"physical-description-input\"\n            >\n              <TextArea\n                id=\"physical-description-input\"\n                name=\"physical_description\"\n                growVertically={true}\n                fill={true}\n                intent={\n                  errors.physical_description && touched.physical_description\n                    ? Intent.DANGER\n                    : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.physical_description}\n              />\n              {errors.physical_description && touched.physical_description && (\n                <div className=\"form-error\">{errors.physical_description}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Character Type\"\n              labelInfo=\"(required)\"\n              labelFor=\"char-type-input\"\n            >\n              <InputGroup\n                id=\"char-type-input\"\n                name=\"char_type\"\n                intent={\n                  errors.char_type && touched.char_type ? Intent.DANGER : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.char_type}\n              />\n              {errors.char_type && touched.char_type && (\n                <div className=\"form-error\">{errors.char_type}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Base Character\"\n              labelInfo=\"(required)\"\n              labelFor=\"base-id-input\"\n            >\n              <BaseSuggest\n                id=\"base-id-input\"\n                name=\"base_id\"\n                type={`base_${type}`}\n                errors={errors.base_id}\n                touched={touched.base_id}\n                setFieldTouched={setFieldTouched}\n                formValue={values.base_id}\n                handleChange={setFieldValue}\n              />\n              {errors.base_id && touched.base_id && (\n                <div className=\"form-error\">{errors.base_id}</div>\n              )}\n            </FormGroup>\n            <FormGroup label=\"Properties\" labelInfo=\"(required)\" large={true}>\n              <div style={{ marginLeft: \"15px\", width: \"150px\" }}>\n                <Switch\n                  label=\"Plural\"\n                  name=\"is_plural\"\n                  onChange={handleSwitch}\n                  checked={!!values.is_plural}\n                  alignIndicator={Alignment.RIGHT}\n                />\n              </div>\n            </FormGroup>\n\n            <Button\n              type=\"reset\"\n              onClick={handleReset}\n              disabled={!dirty}\n              style={{ marginRight: \"15px\" }}\n            >\n              Reset\n            </Button>\n            <Button\n              intent={Intent.PRIMARY}\n              type=\"submit\"\n              onClick={handleSubmit}\n              disabled={!dirty || !isValid}\n              style={{ marginLeft: \"15px\" }}\n            >\n              Save Changes\n            </Button>\n          </form>\n        );\n      }}\n    </Formik>\n  );\n}\n\nexport const emptyCharacterForm = {\n  name: \"\",\n  name_prefix: \"\",\n  persona: \"\",\n  physical_description: \"\",\n  char_type: \"\",\n  base_id: 0,\n  is_plural: 0\n};\n\nexport default CharacterForm;\n","import React from \"react\";\nimport {\n  Button,\n  FormGroup,\n  Intent,\n  InputGroup,\n  TextArea\n} from \"@blueprintjs/core\";\nimport { Formik } from \"formik\";\n\nimport BaseSuggest from \"./BaseSuggest\";\n\nfunction RoomForm({ initialInputs, handleSubmit, type }) {\n  return (\n    <Formik\n      initialValues={initialInputs}\n      validate={values => {\n        let errors = {};\n        if (!values.name) {\n          errors.name = \"Required\";\n        }\n        if (!values.description) {\n          errors.description = \"Required\";\n        }\n        if (!values.backstory) {\n          errors.backstory = \"Required\";\n        }\n        if (!values.base_id) {\n          errors.base_id = \"Required\";\n        }\n        return errors;\n      }}\n      onSubmit={handleSubmit}\n    >\n      {props => {\n        const {\n          values,\n          setFieldValue,\n          touched,\n          setFieldTouched,\n          errors,\n          dirty,\n          isValid,\n          handleChange,\n          handleBlur,\n          handleSubmit,\n          handleReset\n        } = props;\n\n        return (\n          <form data-testid=\"form\">\n            <FormGroup\n              label=\"Name\"\n              labelInfo=\"(required)\"\n              labelFor=\"name-input\"\n            >\n              <InputGroup\n                id=\"name-input\"\n                name=\"name\"\n                intent={errors.name && touched.name ? Intent.DANGER : null}\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.name}\n              />\n              {errors.name && touched.name && (\n                <div className=\"form-error\">{errors.name}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Description\"\n              labelInfo=\"(required)\"\n              labelFor=\"description-input\"\n            >\n              <TextArea\n                id=\"description-input\"\n                name=\"description\"\n                growVertically={true}\n                fill={true}\n                intent={\n                  errors.description && touched.description\n                    ? Intent.DANGER\n                    : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.description}\n              />\n              {errors.description && touched.description && (\n                <div className=\"form-error\">{errors.description}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Backstory\"\n              labelInfo=\"(required)\"\n              labelFor=\"backstory-input\"\n            >\n              <TextArea\n                id=\"backstory-input\"\n                name=\"backstory\"\n                growVertically={true}\n                fill={true}\n                intent={\n                  errors.backstory && touched.backstory ? Intent.DANGER : null\n                }\n                onBlur={handleBlur}\n                onChange={handleChange}\n                value={values.backstory}\n              />\n              {errors.backstory && touched.backstory && (\n                <div className=\"form-error\">{errors.backstory}</div>\n              )}\n            </FormGroup>\n            <FormGroup\n              label=\"Base Room\"\n              labelInfo=\"(required)\"\n              labelFor=\"base-id-input\"\n            >\n              <BaseSuggest\n                id=\"base-id-input\"\n                name=\"base_id\"\n                type={`base_${type}`}\n                errors={errors.base_id}\n                touched={touched.base_id}\n                setFieldTouched={setFieldTouched}\n                formValue={values.base_id}\n                handleChange={setFieldValue}\n              />\n              {errors.base_id && touched.base_id && (\n                <div className=\"form-error\">{errors.base_id}</div>\n              )}\n            </FormGroup>\n            <Button\n              type=\"reset\"\n              onClick={handleReset}\n              disabled={!dirty}\n              style={{ marginRight: \"15px\" }}\n            >\n              Reset\n            </Button>\n            <Button\n              intent={Intent.PRIMARY}\n              type=\"submit\"\n              onClick={handleSubmit}\n              disabled={!dirty || !isValid}\n              style={{ marginLeft: \"15px\" }}\n            >\n              Save Changes\n            </Button>\n          </form>\n        );\n      }}\n    </Formik>\n  );\n}\n\nexport const emptyRoomForm = {\n  name: \"\",\n  description: \"\",\n  backstory: \"\",\n  base_id: 0\n};\n\nexport default RoomForm;\n","import { Position, Toaster } from \"@blueprintjs/core\";\n\nconst AppToaster = Toaster.create({\n  position: Position.TOP\n});\n\nexport default AppToaster;\n","import React from \"react\";\nimport { Radio, RadioGroup, Intent } from \"@blueprintjs/core\";\nimport { useHistory } from \"react-router-dom\";\n\nimport { post } from \"../utils\";\nimport ObjectForm, { emptyObjectForm } from \"./forms/ObjectForm\";\nimport CharacterForm, { emptyCharacterForm } from \"./forms/CharacterForm\";\nimport RoomForm, { emptyRoomForm } from \"./forms/RoomForm\";\nimport AppToaster from \"./AppToaster\";\n\nfunction CreatePage({ location }) {\n  const [formType, setFormType] = React.useState(\n    location.state ? location.state.type : \"object\"\n  );\n\n  return (\n    <div>\n      <h2\n        data-testid=\"header\"\n        className=\"bp3-heading\"\n        style={{ marginBottom: 15 }}\n      >\n        Create new entity\n      </h2>\n      <div className=\"bp3-text-large\">\n        <div style={{ display: \"flex\", marginBottom: 30 }}>\n          <span style={{ marginRight: \"20px\" }}>Entity type:</span>\n          <RadioGroup\n            inline\n            large\n            onChange={e => {\n              location.state = undefined;\n              setFormType(e.target.value);\n            }}\n            selectedValue={formType}\n          >\n            <Radio data-testid=\"radio-object\" label=\"Object\" value=\"object\" />\n            <Radio\n              data-testid=\"radio-character\"\n              label=\"Character\"\n              value=\"character\"\n            />\n            <Radio data-testid=\"radio-room\" label=\"Room\" value=\"room\" />\n          </RadioGroup>\n        </div>\n        <CreateForm\n          type={formType}\n          initialInputs={location.state ? location.state.entity : undefined}\n        />\n      </div>\n    </div>\n  );\n}\n\nfunction CreateForm({ type, initialInputs }) {\n  const history = useHistory();\n  const submitEntity = async payload => {\n    await post(`entities/${type}`, payload).then(() => {\n      history.push(\"/\");\n    });\n    AppToaster.show({\n      intent: Intent.SUCCESS,\n      message: \"Successfully created entity\"\n    });\n  };\n\n  switch (type) {\n    case \"object\":\n      return (\n        <ObjectForm\n          type={type}\n          initialInputs={initialInputs ? initialInputs : emptyObjectForm}\n          handleSubmit={submitEntity}\n        />\n      );\n    case \"character\":\n      return (\n        <CharacterForm\n          type={type}\n          initialInputs={initialInputs ? initialInputs : emptyCharacterForm}\n          handleSubmit={submitEntity}\n        />\n      );\n    case \"room\":\n      return (\n        <RoomForm\n          type={type}\n          initialInputs={initialInputs ? initialInputs : emptyRoomForm}\n          handleSubmit={submitEntity}\n        />\n      );\n    default:\n      return \"This entity cannot be created at the moment\";\n  }\n}\n\nexport default CreatePage;\n","import React from \"react\";\nimport {\n  Button,\n  Checkbox,\n  Classes,\n  Dialog,\n  Intent,\n  Radio,\n  RadioGroup,\n  Spinner\n} from \"@blueprintjs/core\";\nimport DiffMatchPatch from \"diff-match-patch\";\nimport AnimateHeight from \"react-animate-height\";\nimport { startCase, fill } from \"lodash\";\n\nimport CONFIG from \"../config\";\nimport { useAPI, post } from \"../utils\";\nimport AppToaster from \"./AppToaster\";\n\nfunction ReviewPage() {\n  const [selectedStatus, setSelectedStatus] = React.useState(\"under review\");\n\n  const { loading, result, reload } = useAPI(\n    CONFIG,\n    `/edits?expand=true&status=${selectedStatus}`\n  );\n\n  return (\n    <div>\n      <h2 data-testid=\"header\" className=\"bp3-heading\">\n        Review\n      </h2>\n      <div className=\"bp3-text-large\">\n        Review pending, accepted, and rejected edits to the LIGHT database.\n      </div>\n      <br />\n      <div style={{ display: \"flex\", marginBottom: \"30px\" }}>\n        <span style={{ margin: \"0px 20px 0px 40px\" }}>Searching category:</span>\n        <RadioGroup\n          inline\n          large\n          onChange={e => setSelectedStatus(e.target.value)}\n          selectedValue={selectedStatus}\n        >\n          <Radio\n            data-testid=\"radio-under-review\"\n            label=\"Under Review\"\n            value=\"under review\"\n          />\n          <Radio\n            data-testid=\"radio-accepted\"\n            label=\"Accepted\"\n            value=\"accepted\"\n          />\n          <Radio\n            data-testid=\"radio-rejected\"\n            label=\"Rejected\"\n            value=\"rejected\"\n          />\n        </RadioGroup>\n      </div>\n      {loading ? (\n        <Spinner intent={Intent.PRIMARY} />\n      ) : (\n        <EditsList edits={result} status={selectedStatus} reload={reload} />\n      )}\n    </div>\n  );\n}\n\nfunction EditsList({ edits, status, reload }) {\n  const [state, setState] = React.useState({\n    expanded: -1,\n    animating: 0,\n    nextState: -1\n  });\n  const [selected, setSelected] = React.useState({ rows: [], all: 0 });\n  const [submitAction, setSubmitAction] = React.useState(undefined);\n  const [showDialog, setShowDialog] = React.useState(false);\n  const [pendingSubmission, setPendingSubmission] = React.useState([]);\n\n  if (edits && edits.length > 0 && selected.rows.length === 0) {\n    setSelected({ ...selected, rows: fill(Array(edits.length), false) });\n  }\n\n  function handleTdClick(index) {\n    if (status === \"under review\") {\n      if (state.expanded === -1) {\n        setState({ expanded: index, animating: 1, nextState: -1 });\n      } else if (state.expanded === index) {\n        setState({ expanded: index, animating: 3, nextState: -1 });\n      } else {\n        setState({ ...state, animating: 3, nextState: index });\n      }\n    }\n  }\n\n  function handleCheckbox(index) {\n    const newSelection = [...selected.rows];\n    newSelection[index] = selected.rows[index] ? false : true;\n    let all = selected.all;\n    if (newSelection.every(r => r === true)) {\n      all = 1;\n    } else if (newSelection.every(r => r === false)) {\n      all = 0;\n    } else {\n      all = -1;\n    }\n    setSelected({ rows: newSelection, all });\n  }\n\n  function handleSelectAll() {\n    const all = selected.all ? 0 : 1;\n    const newRows = fill(Array(edits.length), !!all);\n    setSelected({ rows: newRows, all });\n  }\n\n  async function handleSubmitSelected() {\n    const reqs = pendingSubmission.map(index =>\n      post(`edits/${edits[index].edit_id}/${submitAction}`)\n    );\n    await Promise.all(reqs).then(() => {\n      reload();\n    });\n    AppToaster.show({ intent: Intent.SUCCESS, message: \"Review submitted\" });\n  }\n\n  const showSubmission = action => {\n    const checked = [];\n    for (let i = 0; i < selected.rows.length; i++) {\n      if (selected.rows[i]) {\n        checked.push(i);\n      }\n    }\n    setPendingSubmission(checked);\n    setSubmitAction(action);\n    setShowDialog(true);\n  };\n\n  if (edits === undefined || edits.length === 0) {\n    return <span>No edits found.</span>;\n  } else {\n    return (\n      <>\n        <Dialog\n          icon=\"info-sign\"\n          onClose={() => setShowDialog(false)}\n          title={`Confirm edits to be ${\n            submitAction === \"reject\" ? \"rejected\" : \"accepted\"\n          }`}\n          isOpen={showDialog}\n          usePortal={false}\n        >\n          <div className={Classes.DIALOG_BODY}>\n            <table className=\"bp3-html-table bp3-html-table-condensed bp3-interactive\">\n              <thead>\n                <tr>\n                  <th>Edit ID</th>\n                  <th>Entity ID</th>\n                  <th>Edited Field</th>\n                </tr>\n              </thead>\n              <tbody>\n                {pendingSubmission.map((edit, index) => {\n                  return (\n                    <tr key={index}>\n                      <td>{edits[edit].edit_id}</td>\n                      <td>{edits[edit].id}</td>\n                      <td>{edits[edit].field}</td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n          <div className={Classes.DIALOG_FOOTER}>\n            <div className={Classes.DIALOG_FOOTER_ACTIONS}>\n              <Button onClick={() => setShowDialog(false)}>Close</Button>\n              <Button intent={Intent.PRIMARY} onClick={handleSubmitSelected}>\n                Confirm Edits\n              </Button>\n            </div>\n          </div>\n        </Dialog>\n        <table\n          data-testid=\"table-review\"\n          style={{ width: \"100%\" }}\n          className=\"bp3-html-table bp3-html-table-condensed bp3-interactive\"\n        >\n          <thead>\n            <tr>\n              {status === \"under review\" && (\n                <th style={{ textAlign: \"center\" }}>\n                  <Checkbox\n                    checked={selected.all}\n                    indeterminate={selected.all === -1}\n                    onClick={handleSelectAll}\n                  />\n                </th>\n              )}\n              <th>Edit ID</th>\n              <th>Entity ID</th>\n              <th>Edited Field</th>\n              <th>Edit</th>\n            </tr>\n          </thead>\n          <tbody>\n            {edits.map((edit, index) => (\n              <React.Fragment key={edit.edit_id}>\n                <tr\n                  data-testid=\"tr-review\"\n                  style={{\n                    background:\n                      index % 2 === 0 ? \"rgba(191, 204, 214, 0.15)\" : undefined\n                  }}\n                >\n                  {status === \"under review\" && (\n                    <td style={{ textAlign: \"center\" }}>\n                      <Checkbox\n                        checked={selected.rows[index]}\n                        onClick={() => handleCheckbox(index)}\n                      />\n                    </td>\n                  )}\n                  <td onClick={() => handleTdClick(index)}>{edit.edit_id}</td>\n                  <td onClick={() => handleTdClick(index)}>\n                    <strong>{edit.id}</strong>\n                  </td>\n                  <td onClick={() => handleTdClick(index)}>{edit.field}</td>\n                  <td onClick={() => handleTdClick(index)}>\n                    {diff(edit.unedited_value, edit.edited_value)}\n                  </td>\n                </tr>\n                <tr\n                  style={{\n                    background:\n                      index % 2 === 0 ? \"rgba(191, 204, 214, 0.15)\" : undefined\n                  }}\n                >\n                  <td\n                    colSpan={5}\n                    style={{\n                      display: state.expanded === index ? undefined : \"none\",\n                      padding: 0,\n                      cursor: \"unset\"\n                    }}\n                  >\n                    <AnimateHeight\n                      duration={500}\n                      height={\n                        state.expanded === index &&\n                        (state.animating === 2 || state.animating === 0)\n                          ? \"auto\"\n                          : 0\n                      }\n                      easing={\"ease\"}\n                      onAnimationEnd={() =>\n                        setState({\n                          nextState: -1,\n                          expanded:\n                            state.animating === 2 ? index : state.nextState,\n                          animating:\n                            state.animating === 3 && state.nextState !== -1\n                              ? 1\n                              : 0\n                        })\n                      }\n                      animateOpacity={true}\n                    >\n                      {state.expanded === index && (\n                        <ExpandedTab\n                          edit={edit}\n                          state={state}\n                          setState={setState}\n                          reload={reload}\n                        />\n                      )}\n                    </AnimateHeight>\n                  </td>\n                </tr>\n              </React.Fragment>\n            ))}\n          </tbody>\n        </table>\n        {status === \"under review\" && (\n          <div\n            style={{\n              display: \"flex\",\n              margin: \"10px\",\n              justifyContent: \"flex-end\"\n            }}\n          >\n            <Button\n              intent={Intent.DANGER}\n              type=\"submit\"\n              onClick={() => showSubmission(\"reject\")}\n              style={{ marginLeft: \"15px\" }}\n              disabled={!selected.all}\n            >\n              Reject\n            </Button>\n            <Button\n              intent={Intent.SUCCESS}\n              type=\"submit\"\n              onClick={() => showSubmission(\"accept/accepted\")}\n              style={{ marginLeft: \"15px\" }}\n              disabled={!selected.all}\n            >\n              Accept\n            </Button>\n          </div>\n        )}\n      </>\n    );\n  }\n}\n\nfunction ExpandedTab({ edit, state, setState, reload }) {\n  const { loading, result } = useAPI(CONFIG, `/entities/${edit.id}`);\n  React.useEffect(() => {\n    if (result && state.animating === 1) {\n      setState({ ...state, animating: 2 });\n    }\n  }, [loading, setState, state, result]);\n  return (\n    <>\n      {loading ? (\n        <></>\n      ) : (\n        <Card edit={edit} entity={result.entity} reload={reload} />\n      )}\n    </>\n  );\n}\n\nfunction Card({ edit, entity, reload }) {\n  delete entity.id;\n  return (\n    <>\n      <div\n        data-testid=\"dropdown\"\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          padding: \"20px 20px 0 20px\",\n          alignItems: \"center\"\n        }}\n      >\n        <div style={{ flexGrow: 1 }}>\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              width: \"50%\",\n              maxWidth: \"30vw\",\n              margin: \"auto\"\n            }}\n          >\n            {Object.keys(entity).map((key, index) => (\n              <p\n                key={index}\n                style={{ color: key === edit.field ? \"#DB3737\" : undefined }}\n              >\n                <strong>{startCase(key)}</strong>: {entity[key]}\n              </p>\n            ))}\n          </div>\n        </div>\n        <div style={{ height: \"100%\", fontSize: \"20px\", color: \"#394B59\" }}>\n          \n        </div>\n        <div style={{ flexGrow: 1 }}>\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              width: \"50%\",\n              maxWidth: \"30vw\",\n              margin: \"auto\"\n            }}\n          >\n            {Object.keys(entity).map((key, index) => (\n              <p\n                key={index}\n                style={{ color: key === edit.field ? \"#0F9960\" : undefined }}\n              >\n                <strong>{startCase(key)}</strong>:{\" \"}\n                {key === edit.field ? edit.edited_value : entity[key]}\n              </p>\n            ))}\n          </div>\n        </div>\n      </div>\n      <div\n        style={{\n          display: \"flex\",\n          padding: \"0 20px 20px 20px\",\n          justifyContent: \"flex-end\"\n        }}\n      >\n        <Button\n          intent={Intent.DANGER}\n          type=\"submit\"\n          onClick={() =>\n            post(`edits/${edit.edit_id}/reject`).then(() => reload())\n          }\n          style={{ marginLeft: \"15px\" }}\n        >\n          Reject Edit\n        </Button>\n        <Button\n          intent={Intent.SUCCESS}\n          type=\"submit\"\n          onClick={() =>\n            post(`edits/${edit.edit_id}/accept/accepted`).then(() => reload())\n          }\n          style={{ marginLeft: \"15px\" }}\n        >\n          Accept Edit\n        </Button>\n      </div>\n    </>\n  );\n}\n\nfunction diff(orig, edit) {\n  let diff;\n  if (isNaN(orig) || isNaN(edit)) {\n    const differ = new DiffMatchPatch();\n    diff = differ.diff_main(orig, edit);\n    differ.diff_cleanupSemantic(diff);\n  } else {\n    orig = 0 + orig;\n    edit = 0 + edit;\n    diff = [\n      [-1, +orig],\n      [1, +edit]\n    ];\n  }\n  return (\n    <>\n      {diff.map((d, index) => {\n        switch (d[0]) {\n          case -1:\n            return (\n              <strike key={index} style={{ color: \"#FF7373\" }}>\n                {\" \"}\n                {d[1]}{\" \"}\n              </strike>\n            );\n          case 0:\n            return <strong key={index}>{d[1]}</strong>;\n          case 1:\n            return (\n              <strong key={index} style={{ color: \"#0F9960\" }}>\n                {d[1]}\n              </strong>\n            );\n          default:\n            return <></>;\n        }\n      })}\n    </>\n  );\n}\n\nexport default ReviewPage;\n","import React from \"react\";\nimport { Colors, Intent } from \"@blueprintjs/core\";\nimport { cloneDeep, isEmpty, merge } from \"lodash\";\nimport equal from \"fast-deep-equal\";\nimport { emojiIndex } from \"emoji-mart\";\n\nimport { post } from \"../../utils\";\nimport AppToaster from \"../AppToaster\";\n\nexport const MAX_WIDTH = 10;\nexport const MAX_HEIGHT = 10;\nexport const MAX_FLOORS = 10;\n\nconst STARTING_WIDTH = 3;\nconst STARTING_HEIGHT = 3;\nconst STARTING_FLOORS = 1;\n\nexport const DEFAULT_EMOJI = \"\";\n\nexport const TILE_COLORS = [\n  Colors.GRAY3,\n  Colors.VIOLET5,\n  Colors.RED5,\n  Colors.SEPIA5,\n  Colors.GOLD5,\n  Colors.FOREST5,\n  Colors.BLUE5\n];\n\nconst grass = [\n  \"grass\",\n  \"field\",\n  \"plains\",\n  \"forest\",\n  \"land\",\n  \"gardens\",\n  \"meadow\",\n  \"woods\",\n  \"jungle\",\n  \"swamp\",\n  \"green\"\n];\nconst water = [\n  \"water\",\n  \"lake\",\n  \"river\",\n  \"ocean\",\n  \"sea\",\n  \"pond\",\n  \"lagoon\",\n  \"shore\",\n  \"blue\"\n];\nconst buildings = [\n  \"castle\",\n  \"fortress\",\n  \"church\",\n  \"cathedral\",\n  \"tower\",\n  \"building\",\n  \"cave\",\n  \"gray\",\n  \"grey\"\n];\nconst royal = [\"king\", \"queen\", \"palace\", \"purple\"];\nconst brick = [\"brick\", \"fire\", \"red\"];\nconst path = [\"path\", \"road\", \"bridge\", \"brown\"];\nconst farm = [\"farm\", \"cottage\", \"sand\", \"beach\", \"yellow\", \"gold\"];\n\n/**\n * Utility function for suggesting a biome (tile color) for a given room name\n */\nexport function findBiome(name, current) {\n  const lowName = name.toLowerCase();\n  if (grass.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.FOREST5;\n  }\n  if (water.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.BLUE5;\n  }\n  if (brick.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.RED5;\n  }\n  if (path.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.SEPIA5;\n  }\n  if (farm.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.GOLD5;\n  }\n  if (buildings.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.GRAY3;\n  }\n  if (royal.some(biome => lowName.indexOf(biome) > -1)) {\n    return Colors.VIOLET5;\n  }\n  return current;\n}\n\n/**\n * Utility function for determining whether content should be \"white\" or \"black\" on a color background\n */\nexport function invertColor(hex) {\n  if (hex.indexOf(\"#\") === 0) {\n    hex = hex.slice(1);\n  }\n  // convert 3-digit hex to 6-digits.\n  if (hex.length === 3) {\n    hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n  }\n  // invert color components\n  var r = parseInt(hex.slice(0, 2), 16),\n    g = parseInt(hex.slice(2, 4), 16),\n    b = parseInt(hex.slice(4, 6), 16);\n  // pick black/white based on intensity\n  return r * 0.299 + g * 0.587 + b * 0.114 > 150 ? \"#182026\" : \"#F5F8FA\";\n}\n\nexport function findEmoji(name) {\n  let results = emojiIndex.search(name);\n  if (results[0]) {\n    return results[0].native;\n  }\n  const words = name.split(\" \");\n  for (let i = 0; i < words.length; i++) {\n    let string = words[i];\n    if (words[i].charAt(words[i].length - 1) === \"s\") {\n      string = words[i].substring(0, words[i].length - 1);\n    }\n    results = emojiIndex.search(string);\n    if (results[0]) {\n      return results[0].native;\n    }\n  }\n  return DEFAULT_EMOJI;\n}\n\nconst mapReducer = (state, action) => {\n  switch (action.type) {\n    case \"SET_MAP\":\n      return action.map;\n    case \"SET_TILE\":\n      return state.map((floor, floorIndex) => {\n        if (floorIndex === action.floor) {\n          return {\n            ...floor,\n            tiles: {\n              ...floor.tiles,\n              [`${action.x} ${action.y}`]: action.newTile\n            }\n          };\n        } else {\n          return floor;\n        }\n      });\n    case \"EDIT_FLOOR_NAME\":\n      return state.map((floor, floorIndex) => {\n        if (floorIndex === action.floor) {\n          return {\n            ...floor,\n            name: action.name\n          };\n        } else {\n          return floor;\n        }\n      });\n\n    default:\n      return state;\n  }\n};\n\nconst createdEntitiesReducer = (state, action) => {\n  switch (action.type) {\n    case \"SET_ALL\":\n      return action.entities;\n    case \"ADD_ENTITY\": {\n      return Object.assign({}, state, {\n        [action.entityType]: {\n          ...state[action.entityType],\n          [state.nextID]: action.data\n        },\n        nextID: state.nextID + 1\n      });\n    }\n    case \"EDIT_ENTITY\": {\n      return merge(state, {\n        [action.entityType]: { [action.id]: action.data }\n      });\n    }\n    default:\n      return state;\n  }\n};\n\n/**\n * Custom hook managing map state.\n * Includes utility functions for setting state of the map.\n */\nexport function useWorldBuilder(upload) {\n  const [dimensions, setDimensions] = React.useState(\n    upload\n      ? upload.data.dimensions\n      : {\n          height: STARTING_HEIGHT,\n          width: STARTING_WIDTH,\n          floors: STARTING_FLOORS\n        }\n  );\n\n  // Floors and tiles kept seperate to avoid unnecessary updates on either side\n  // The index key is used because the Reorder component does not pass index to children\n  // Represents the map state\n  // Structured as: Array(Map(name: FloorName, tiles: Map(x y': TileData), walls: Map('x1 y1|x2 y2': Wall)))\n  const initialMap = upload\n    ? upload.data.map\n    : [{ name: \"1F\", tiles: {}, walls: {} }];\n  const [map, mapDispatch] = React.useReducer(mapReducer, initialMap);\n\n  // Local entity store\n  const [entities, entitiesDispatch] = React.useReducer(\n    createdEntitiesReducer,\n    upload\n      ? upload.data.entities\n      : { room: {}, character: {}, object: {}, nextID: 1 }\n  );\n\n  // Floor currently being viewed in the editor\n  const [currFloor, setCurrFloor] = React.useState(0);\n\n  // make sure all floors are in the map\n  React.useEffect(() => {\n    const newMap = [];\n    for (let f = 0; f < dimensions.floors; f++) {\n      newMap.push(\n        map[f] ? map[f] : { name: `${f + 1}F`, tiles: {}, walls: {} }\n      );\n    }\n    mapDispatch({ type: \"SET_MAP\", map: newMap });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [dimensions]);\n\n  // Add an entity to the local store and return its temporary id\n  const addEntity = (data, entityType) => {\n    const id = entities.nextID;\n    entitiesDispatch({ type: \"ADD_ENTITY\", data, entityType });\n    return id;\n  };\n\n  // Edit an entity in the local store\n  const editEntity = (id, data, entityType) => {\n    entitiesDispatch({ type: \"EDIT_ENTITY\", id, data, entityType });\n  };\n\n  // Return the id of the entity in the store, or add it to the store and return the new id\n  const findOrAddEntity = (data, entityType) => {\n    for (let entity in entities[entityType]) {\n      if (equal(entities[entityType][entity], data)) {\n        return entity;\n      }\n    }\n    return addEntity(data, entityType);\n  };\n\n  // Change data in a specific tile on the map\n  const setTile = (x, y, newTile, floor = currFloor) => {\n    mapDispatch({ type: \"SET_TILE\", x, y, newTile, floor });\n  };\n\n  // Clear data on a tile\n  const clearTile = (x, y, floor = currFloor) => {\n    const newMap = cloneDeep(map);\n    removeStairsTile(x, y, newMap);\n    delete newMap[floor].tiles[`${x} ${y}`];\n    mapDispatch({ type: \"SET_MAP\", map: newMap });\n  };\n\n  // Swap the position of two tiles on the current floor\n  const swapTiles = (x1, y1, x2, y2) => {\n    mapDispatch({\n      type: \"SET_MAP\",\n      map: map.map((floor, f) => {\n        if (f === currFloor) {\n          removeStairsTile(x1, y1);\n          removeStairsTile(x2, y2);\n          return {\n            ...floor,\n            tiles: {\n              ...floor.tiles,\n              [`${x1} ${y1}`]: floor.tiles[`${x2} ${y2}`],\n              [`${x2} ${y2}`]: floor.tiles[`${x1} ${y1}`]\n            }\n          };\n        } else {\n          return floor;\n        }\n      })\n    });\n  };\n\n  // Add a row to the top of the map on all floors\n  const addRowTop = () => {\n    mapDispatch({\n      type: \"SET_MAP\",\n      map: map.map(floor => {\n        const tileKeys = Object.keys(floor.tiles);\n        const newTiles = {};\n        tileKeys.forEach(key => {\n          const [x, y] = key.split(\" \");\n          newTiles[`${x} ${parseInt(y) + 1}`] = floor.tiles[key];\n        });\n        const wallKeys = Object.keys(floor.walls);\n        const newWalls = {};\n        wallKeys.forEach(key => {\n          const [t1, t2] = key.split(\"|\");\n          const [x1, y1] = t1.split(\" \");\n          const [x2, y2] = t2.split(\" \");\n          newWalls[`${x1} ${parseInt(y1) + 1}|${x2} ${parseInt(y2) + 1}`] =\n            floor.walls[key];\n        });\n        return { ...floor, tiles: newTiles, walls: newWalls };\n      })\n    });\n    setDimensions({ ...dimensions, height: dimensions.height + 1 });\n  };\n\n  // Add a row to the bottom of the map on all floors\n  const addRowBot = () => {\n    setDimensions({ ...dimensions, height: dimensions.height + 1 });\n  };\n\n  // Add a column to the left side of the map on all floors\n  const addColFront = () => {\n    mapDispatch({\n      type: \"SET_MAP\",\n      map: map.map(floor => {\n        const tileKeys = Object.keys(floor.tiles);\n        const newTiles = {};\n        tileKeys.forEach(key => {\n          const [x, y] = key.split(\" \");\n          newTiles[`${parseInt(x) + 1} ${y}`] = floor.tiles[key];\n        });\n        const wallKeys = Object.keys(floor.walls);\n        const newWalls = {};\n        wallKeys.forEach(key => {\n          const [t1, t2] = key.split(\"|\");\n          const [x1, y1] = t1.split(\" \");\n          const [x2, y2] = t2.split(\" \");\n          newWalls[`${parseInt(x1) + 1} ${y1}|${parseInt(x2) + 1} ${y2}`] =\n            floor.walls[key];\n        });\n        return { ...floor, tiles: newTiles, walls: newWalls };\n      })\n    });\n    setDimensions({ ...dimensions, width: dimensions.width + 1 });\n  };\n\n  // Add a column to the right side of the map on all floors\n  const addColEnd = () => {\n    setDimensions({ ...dimensions, width: dimensions.width + 1 });\n  };\n\n  // Add a new floor\n  const addFloor = () => {\n    setDimensions({ ...dimensions, floors: dimensions.floors + 1 });\n  };\n\n  // Edit the name of a floor\n  const editFloorName = (newName, floor) => {\n    mapDispatch({ type: \"EDIT_FLOOR_NAME\", name: newName, floor });\n  };\n\n  // Remove stairs from a tile\n  const removeStairsTile = (x, y, baseMap = map, f = currFloor) => {\n    if (baseMap[f] && baseMap[f].tiles[`${x} ${y}`]) {\n      delete baseMap[f].tiles[`${x} ${y}`].stairDown;\n      delete baseMap[f].tiles[`${x} ${y}`].stairUp;\n    }\n    if (baseMap[f - 1] && baseMap[f - 1].tiles[`${x} ${y}`]) {\n      delete baseMap[f - 1].tiles[`${x} ${y}`].stairUp;\n    }\n    if (baseMap[f + 1] && baseMap[f + 1].tiles[`${x} ${y}`]) {\n      delete baseMap[f + 1].tiles[`${x} ${y}`].stairDown;\n    }\n  };\n\n  // Remove all stairs up or down from a floor\n  const removeStairsFloor = (floor, stair) => {\n    if (!isEmpty(floor) && !isEmpty(floor.tiles)) {\n      Object.keys(floor.tiles).forEach(key => {\n        if (!isEmpty(floor.tiles[key])) {\n          delete floor.tiles[key][stair];\n        }\n      });\n    }\n  };\n\n  // Delete a floor\n  const deleteFloor = index => {\n    const newMap = map.filter((_floor, i) => i !== index);\n    removeStairsFloor(newMap[index - 1], \"stairUp\");\n    removeStairsFloor(newMap[index], \"stairDown\");\n    mapDispatch({ type: \"SET_MAP\", map: newMap });\n\n    if (currFloor >= dimensions.floors - 1) {\n      setCurrFloor(0);\n    }\n    setDimensions({ ...dimensions, floors: dimensions.floors - 1 });\n  };\n\n  // move a floor to a different position\n  const reorderFloors = (i1, i2) => {\n    const reorderedFloor = map[i1];\n    const filteredMap = map.filter((_floor, i) => i !== i1);\n\n    removeStairsFloor(reorderedFloor, \"stairUp\");\n    removeStairsFloor(reorderedFloor, \"stairDown\");\n    removeStairsFloor(filteredMap[i1 - 1], \"stairUp\");\n    removeStairsFloor(filteredMap[i1], \"stairDown\");\n\n    const newMap = [];\n    for (let i = 0; i < dimensions.floors; i++) {\n      newMap.push(\n        i < i2 ? filteredMap[i] : i === i2 ? reorderedFloor : filteredMap[i - 1]\n      );\n    }\n\n    removeStairsFloor(newMap[i2 - 1], \"stairUp\");\n    removeStairsFloor(newMap[i2 + 1], \"stairDown\");\n\n    mapDispatch({ type: \"SET_MAP\", map: newMap });\n\n    if (currFloor === i1) {\n      setCurrFloor(i2);\n    }\n  };\n\n  // Get tile at specified indices, or an empty object otherwise\n  const getTileAt = (x, y, f = currFloor) => {\n    try {\n      return map[f].tiles[`${x} ${y}`];\n    } catch {\n      return {};\n    }\n  };\n\n  // Toggle a wall\n  const toggleWall = (key, f = currFloor) => {\n    if (map[f].walls[key]) {\n      const newMap = cloneDeep(map);\n      delete newMap[f].walls[key];\n      mapDispatch({ type: \"SET_MAP\", map: newMap });\n    } else {\n      mapDispatch({\n        type: \"SET_MAP\",\n        map: map.map((floor, floorIndex) => {\n          if (floorIndex === f) {\n            return { ...floor, walls: { ...floor.walls, [key]: true } };\n          } else {\n            return floor;\n          }\n        })\n      });\n    }\n  };\n\n  const filteredMap = () => {\n    const filtered = [];\n    for (let i = 0; i < map.length; i++) {\n      const newFloor = { name: map[i].name, walls: map[i].walls };\n      const newTiles = {};\n      for (let tile in map[i].tiles) {\n        const [x, y] = tile.split(\" \");\n        if (x < dimensions.width && y < dimensions.height) {\n          newTiles[tile] = map[i].tiles[tile];\n        }\n      }\n      newFloor.tiles = newTiles;\n      filtered.push(newFloor);\n    }\n    return filtered;\n  };\n\n  // Post all edges to the API\n  const postEdges = async () => {\n    const store = { room: {}, character: {}, object: {} };\n    const map = filteredMap();\n    // Create maps of all entities being used in the world\n    map.forEach(floor => {\n      Object.values(floor.tiles).forEach(tile => {\n        store.room[tile.room] = entities.room[tile.room];\n        for (let index in tile.characters) {\n          store.character[tile.characters[index]] =\n            entities.character[tile.characters[index]];\n        }\n        for (let index in tile.objects) {\n          store.object[tile.objects[index]] =\n            entities.object[tile.objects[index]];\n        }\n      });\n    });\n    // Post all used entities to the API and store their returned ID for edges\n    const createReqs = [].concat(\n      Object.values(store.room).map(async room => {\n        const res = await post(\"entities/room\", room);\n        const data = await res.json();\n        room.id = data[0];\n      }),\n      Object.values(store.character).map(async character => {\n        const res = await post(\"entities/character\", character);\n        const data = await res.json();\n        character.id = data[0];\n      }),\n      Object.values(store.object).map(async object => {\n        const res = await post(\"entities/object\", object);\n        const data = await res.json();\n        object.id = data[0];\n      })\n    );\n\n    await Promise.all(createReqs);\n\n    const edgeReqs = [];\n    // Create all edge requests and post all of them\n    for (let floor = 0; floor < map.length; floor++) {\n      const tiles = map[floor].tiles;\n      for (let coord in tiles) {\n        const payload = { room: -1, chars: [], objs: [], neighbors: [] };\n        payload.room = store.room[tiles[coord].room].id;\n        tiles[coord].characters.forEach(character => {\n          payload.chars.push(store.character[character].id);\n        });\n        tiles[coord].objects.forEach(object => {\n          payload.objs.push(store.object[object].id);\n        });\n        if (tiles[coord].stairUp) {\n          payload.neighbors.push(\n            store.room[map[floor + 1].tiles[coord].room].id\n          );\n        }\n        if (tiles[coord].stairDown) {\n          payload.neighbors.push(\n            store.room[map[floor - 1].tiles[coord].room].id\n          );\n        }\n        // Ensure neighbours aren't blocked by walls\n        const [x, y] = coord.split(\" \").map(i => parseInt(i));\n        const neighbors = [\n          `${x - 1} ${y}`,\n          `${x + 1} ${y}`,\n          `${x} ${y - 1}`,\n          `${x} ${y + 1}`\n        ];\n        neighbors.forEach(neighbor => {\n          if (\n            !Object.keys(map[floor].walls).some(\n              wall => wall.includes(neighbor) && wall.includes(coord)\n            )\n          ) {\n            if (!isEmpty(tiles[neighbor])) {\n              payload.neighbors.push(store.room[tiles[neighbor].room].id);\n            }\n          }\n        });\n        edgeReqs.push(post(\"edges\", payload));\n      }\n    }\n    await Promise.all(edgeReqs);\n    AppToaster.show({\n      intent: Intent.SUCCESS,\n      message: \"Successfully created all edges\"\n    });\n  };\n\n  const exportWorld = () => {\n    const data = JSON.stringify({ dimensions, map, entities }, null, \"\\t\");\n    var element = document.createElement(\"a\");\n    element.setAttribute(\n      \"href\",\n      \"data:text/plain;charset=utf-8,\" + encodeURIComponent(data)\n    );\n    element.setAttribute(\"download\", `world-${Date.now().toString()}.json`);\n\n    element.style.display = \"none\";\n    document.body.appendChild(element);\n\n    element.click();\n\n    document.body.removeChild(element);\n  };\n\n  return {\n    floorManager: {\n      setCurrFloor,\n      addFloor,\n      deleteFloor,\n      reorderFloors,\n      editFloorName\n    },\n    currFloor,\n    map,\n    setTile,\n    clearTile,\n    swapTiles,\n    getTileAt,\n    toggleWall,\n    dimensions,\n    setDimensions,\n    addRowTop,\n    addRowBot,\n    addColFront,\n    addColEnd,\n    entities,\n    editEntity,\n    findOrAddEntity,\n    postEdges,\n    exportWorld\n  };\n}\n","import React from \"react\";\n\nfunction ColorPicker({ colors, value, handleChange, advanced }) {\n  return (\n    <div\n      style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\" }}\n    >\n      {colors.map((color, index) => {\n        return (\n          <div\n            key={index}\n            style={{\n              display: \"inline-block\",\n              maxWidth: \"20px\",\n              width: \"20px\",\n              maxHeight: \"20px\",\n              height: \"20px\",\n              borderRadius: \"5px\",\n              background: color,\n              borderColor: \"#5C7080\",\n              borderStyle: value === color ? \"solid\" : \"\",\n              borderWidth: \"2px\",\n              boxShadow: value === color ? `0px 0px 8px ${value}` : \"\",\n              margin: \"2px\",\n              cursor: \"pointer\"\n            }}\n            onClick={() => handleChange(\"color\", color)}\n          />\n        );\n      })}\n      {advanced && (\n        <input\n          style={{\n            maxHeight: \"20px\",\n            maxWidth: \"20px\",\n            height: \"20px\",\n            width: \"20px\",\n            borderRadius: \"5px\",\n            padding: \"0px 0px 0px 0px\"\n          }}\n          type=\"color\"\n          value={value}\n          onChange={event => handleChange(\"color\", event.target.value)}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default ColorPicker;\n","import React from \"react\";\nimport { Intent, Menu, MenuItem, Tooltip, Position } from \"@blueprintjs/core\";\nimport { MultiSelect } from \"@blueprintjs/select\";\nimport equal from \"fast-deep-equal\";\nimport \"@blueprintjs/select/lib/css/blueprint-select.css\";\n\nimport CONFIG from \"../../config\";\nimport { useAPI } from \"../../utils\";\n\nconst SUGGEST_SIZE = 100;\n\nfunction BaseMultiSelect({\n  id,\n  name,\n  errors,\n  touched,\n  setFieldTouched,\n  formValue,\n  handleChange,\n  type,\n  tooltip,\n  onItemSelect,\n  entities\n}) {\n  const [items, setItems] = React.useState([]);\n  const [query, setQuery] = React.useState(\"\");\n  const [currItems, setCurrItems] = React.useState([]);\n  const { loading, result } = useAPI(\n    CONFIG,\n    `/entities/${type}?search=${query}`\n  );\n\n  React.useEffect(() => {\n    if (!loading) {\n      if (entities) {\n        const localEntities = Object.values(entities[type]);\n        const results = localEntities\n          .concat(result.slice(0, SUGGEST_SIZE + localEntities.length + 1))\n          .filter(\n            (item, index, self) => self.findIndex(t => equal(t, item)) === index\n          );\n\n        return setItems(results);\n      }\n      return setItems(result);\n    }\n  }, [result, loading, entities, type]);\n\n  React.useEffect(() => {\n    // When Reset is clicked on the form\n    setCurrItems(formValue);\n  }, [formValue, items]);\n\n  const filterItems = (query, obj, _index, exactMatch) => {\n    const normalizedTitle = obj.name.toLowerCase();\n    const normalizedQuery = query.toLowerCase();\n    if (exactMatch) {\n      return normalizedTitle === normalizedQuery;\n    } else {\n      let string = \"\";\n      for (let key in obj) {\n        string += obj[key] + \". \";\n      }\n      const result = string.toLowerCase().indexOf(normalizedQuery) >= 0;\n      return result;\n    }\n  };\n\n  const removeTag = (_value, index) => {\n    const newItems = currItems.filter((_item, i) => {\n      return i !== index;\n    });\n    const change = formValue.filter((_item, i) => {\n      return i !== index;\n    });\n    setCurrItems(newItems);\n    handleChange(name, change);\n  };\n\n  const renderOption = (obj, { handleClick, modifiers, index }) => {\n    if (!modifiers.matchesPredicate) {\n      return null;\n    }\n\n    return (\n      <MenuItem\n        active={modifiers.active}\n        key={index}\n        onClick={handleClick}\n        text={\n          tooltip ? (\n            <Tooltip\n              content={obj[tooltip]}\n              targetTagName=\"div\"\n              popoverClassName=\"popover-tooltip\"\n              position={Position.TOP_RIGHT}\n              usePortal={true}\n            >\n              {obj.name}\n            </Tooltip>\n          ) : (\n            obj.name\n          )\n        }\n        shouldDismissPopover={false}\n      />\n    );\n  };\n\n  return (\n    <div onBlur={e => setFieldTouched(name)}>\n      <MultiSelect\n        id={id}\n        name={name}\n        items={items}\n        itemRenderer={renderOption}\n        itemListRenderer={renderItemList}\n        tagInputProps={{\n          intent: errors && touched ? Intent.DANGER : null,\n          \"data-testid\": \"base-multi-select\",\n          onRemove: removeTag\n        }}\n        onItemSelect={e => {\n          if (onItemSelect) {\n            const result = onItemSelect(e, type);\n            setCurrItems([...currItems, result]);\n            handleChange(name, [...formValue, result], e);\n          } else {\n            setCurrItems([...currItems, e]);\n            handleChange(name, [...formValue, e.id]);\n          }\n          setQuery(\"\");\n        }}\n        popoverProps={{ usePortal: false }}\n        itemPredicate={filterItems}\n        selectedItems={currItems}\n        query={query}\n        onQueryChange={q => setQuery(q)}\n        resetOnQuery={true}\n        tagRenderer={item => {\n          return entities && entities[type][item]\n            ? entities[type][item].name\n            : item.name;\n        }}\n      />\n    </div>\n  );\n}\n\nfunction renderItemList({ filteredItems, renderItem }) {\n  const topResults = filteredItems.slice(0, SUGGEST_SIZE);\n  return (\n    <Menu>\n      {filteredItems.length > 0 ? (\n        <>\n          {topResults.map((item, index) => {\n            return renderItem(item, index);\n          })}\n          {filteredItems.length > SUGGEST_SIZE && (\n            <MenuItem\n              style={{ textAlign: \"center\" }}\n              disabled={true}\n              text=\"...\"\n            />\n          )}\n        </>\n      ) : (\n        <MenuItem disabled={true} text=\"No results.\" />\n      )}\n    </Menu>\n  );\n}\n\nexport default BaseMultiSelect;\n","import React from \"react\";\nimport { Formik } from \"formik\";\nimport {\n  FormGroup,\n  Button,\n  Intent,\n  Classes,\n  Divider,\n  Icon\n} from \"@blueprintjs/core\";\nimport { isEmpty } from \"lodash\";\n\nimport ColorPicker from \"./ColorPicker\";\nimport BaseSuggest from \"./BaseSuggest\";\nimport BaseMultiSelect from \"./BaseMultiSelect\";\nimport { TILE_COLORS, findBiome, findEmoji } from \"../worldbuilding/utils\";\n\nexport const emptyTileForm = {\n  room: undefined,\n  characters: [],\n  objects: [],\n  color: TILE_COLORS[0]\n};\n\nfunction TileForm({\n  initialInputs,\n  onSubmit,\n  onClear,\n  entities,\n  findOrAddEntity,\n  setShowAdvanced,\n  selected,\n  setSelected\n}) {\n  return (\n    <Formik\n      initialValues={isEmpty(initialInputs) ? emptyTileForm : initialInputs}\n      validate={values => {\n        let errors = {};\n        if (isNaN(values.room)) {\n          errors.room = \"Required\";\n        }\n        return errors;\n      }}\n      onSubmit={onSubmit}\n    >\n      {props => {\n        const {\n          values,\n          setFieldValue,\n          touched,\n          setFieldTouched,\n          errors,\n          dirty,\n          isValid,\n          handleSubmit,\n          handleReset\n        } = props;\n\n        const setRoomValue = (name, value, fullValue) => {\n          setFieldValue(name, value);\n          setFieldValue(\"color\", findBiome(fullValue.name, values.color));\n        };\n\n        const hasContent = () => {\n          return (\n            !isNaN(values.room) ||\n            !isEmpty(values.characters) ||\n            !isEmpty(values.objects)\n          );\n        };\n\n        return (\n          <form>\n            <div\n              style={{\n                display: \"flex\",\n                flexDirection: \"row\",\n                alignContent: \"stretch\",\n                justifyContent: \"space-between\"\n              }}\n            >\n              <h5 style={{ fontSize: \"18px\" }} className={Classes.HEADING}>\n                <Icon color=\"#5c7080\" iconSize={20} icon=\"edit\" /> Tile Editor\n              </h5>\n              <div\n                style={{\n                  display: \"flex\",\n                  justifyContent: \"flex-end\"\n                }}\n                onClick={() => {\n                  setSelected({ ...selected, data: { ...values } });\n                  setShowAdvanced(true);\n                }}\n              >\n                <Button icon=\"build\" />\n              </div>\n            </div>\n            <Divider />\n            <FormGroup\n              label=\"Room\"\n              labelInfo=\"(required)\"\n              labelFor=\"room-input\"\n            >\n              <BaseSuggest\n                id=\"room-input\"\n                name=\"room\"\n                type=\"room\"\n                errors={errors.room}\n                touched={touched.room}\n                setFieldTouched={setFieldTouched}\n                formValue={values.room}\n                handleChange={setRoomValue}\n                entities={entities}\n                onItemSelect={findOrAddEntity}\n              />\n              {errors.room && touched.room && (\n                <div className=\"form-error\">{errors.room}</div>\n              )}\n            </FormGroup>\n            <ColorPicker\n              colors={TILE_COLORS}\n              value={values.color}\n              handleChange={setFieldValue}\n            />\n            <FormGroup label=\"Characters in Room\" labelFor=\"characters-input\">\n              <BaseMultiSelect\n                id=\"characters-input\"\n                name=\"characters\"\n                type=\"character\"\n                errors={errors.characters}\n                touched={touched.characters}\n                setFieldTouched={setFieldTouched}\n                formValue={values.characters}\n                handleChange={setFieldValue}\n                tooltip=\"persona\"\n                entities={entities}\n                onItemSelect={(e, type) => {\n                  e.emoji = findEmoji(e.name);\n                  return findOrAddEntity(e, type);\n                }}\n              />\n              {errors.characters && touched.characters && (\n                <div className=\"form-error\">{errors.characters}</div>\n              )}\n            </FormGroup>\n            <FormGroup label=\"Objects in Room\" labelFor=\"objects-input\">\n              <BaseMultiSelect\n                id=\"objects-input\"\n                name=\"objects\"\n                type=\"object\"\n                errors={errors.objects}\n                touched={touched.objects}\n                setFieldTouched={setFieldTouched}\n                formValue={values.objects}\n                handleChange={setFieldValue}\n                tooltip=\"physical_description\"\n                entities={entities}\n                onItemSelect={(e, type) => {\n                  e.emoji = findEmoji(e.name);\n                  return findOrAddEntity(e, type);\n                }}\n              />\n              {errors.objects && touched.objects && (\n                <div className=\"form-error\">{errors.objects}</div>\n              )}\n            </FormGroup>\n\n            <Button\n              type=\"reset\"\n              onClick={onClear}\n              disabled={!hasContent()}\n              style={{ marginRight: \"15px\" }}\n            >\n              Clear\n            </Button>\n            <Button\n              type=\"reset\"\n              onClick={handleReset}\n              disabled={!dirty}\n              style={{ marginRight: \"15px\" }}\n            >\n              Reset\n            </Button>\n            <Button\n              intent={Intent.PRIMARY}\n              type=\"submit\"\n              onClick={handleSubmit}\n              disabled={!dirty || !isValid}\n              style={{ marginLeft: \"15px\" }}\n            >\n              Save Changes\n            </Button>\n          </form>\n        );\n      }}\n    </Formik>\n  );\n}\n\nexport default TileForm;\n","import React from \"react\";\nimport { Popover, Icon, Tooltip } from \"@blueprintjs/core\";\nimport { isEmpty, cloneDeep } from \"lodash\";\n\nimport TileForm from \"../forms/TileForm\";\nimport { invertColor } from \"./utils\";\n\n/**\n * Component for each Tile in the map grid\n */\nfunction Tile({\n  x,\n  y,\n  tile,\n  selected,\n  setSelected,\n  showAdvanced,\n  setShowAdvanced,\n  tileStyle,\n  state\n}) {\n  const handleSubmit = data => {\n    state.setTile(x, y, { ...tile, ...data });\n    setSelected(null);\n  };\n\n  const handleClear = () => {\n    state.clearTile(x, y);\n    setSelected(null);\n  };\n\n  // toggle stairs on the tile clicked, and this tile and on the other floor\n  const toggleStairs = (event, key) => {\n    event.stopPropagation(); // prevent the popup firing\n    const toggleTo = !tile[key];\n    const newTile = cloneDeep(tile);\n    newTile[key] = toggleTo;\n    state.setTile(x, y, newTile);\n    const otherFloor = state.currFloor + (key === \"stairDown\" ? -1 : 1);\n    const newConnectedTile = cloneDeep(state.getTileAt(x, y, otherFloor));\n    newConnectedTile[key === \"stairDown\" ? \"stairUp\" : \"stairDown\"] = toggleTo;\n    state.setTile(x, y, newConnectedTile, otherFloor);\n  };\n\n  const contentColor = invertColor(\n    tile && !isNaN(tile.room) && tile.color ? tile.color : \"#ced9e0\"\n  );\n\n  return (\n    <>\n      <Icon\n        color={contentColor}\n        className={`react-grid-item-handle + ${\n          isEmpty(tile) ? \"disabled\" : \"\"\n        }`}\n        icon=\"drag-handle-horizontal\"\n      />\n      {!isEmpty(state.getTileAt(x, y, state.currFloor - 1)) && (\n        <Icon\n          color={contentColor}\n          onClick={\n            !isEmpty(tile) ? e => toggleStairs(e, \"stairDown\") : undefined\n          }\n          className={isEmpty(tile) ? \"disabled\" : \"\"}\n          style={{\n            opacity: !isEmpty(tile) && tile.stairDown ? 1 : 0.35,\n            position: \"absolute\",\n            bottom: \"5px\",\n            left: \"5px\"\n          }}\n          icon=\"arrow-bottom-left\"\n        />\n      )}\n      {!isEmpty(state.getTileAt(x, y, state.currFloor + 1)) && (\n        <Icon\n          color={contentColor}\n          onClick={!isEmpty(tile) ? e => toggleStairs(e, \"stairUp\") : undefined}\n          className={isEmpty(tile) ? \"disabled\" : \"\"}\n          style={{\n            opacity: !isEmpty(tile) && tile.stairUp ? 1 : 0.35,\n            position: \"absolute\",\n            top: \"5px\",\n            right: \"5px\"\n          }}\n          icon=\"arrow-top-right\"\n        />\n      )}\n      <Popover\n        isOpen={\n          !!selected && selected.x === x && selected.y === y && !showAdvanced\n        }\n        onClose={() => {\n          if (!showAdvanced) {\n            setSelected(null);\n          }\n        }}\n        usePortal={true}\n      >\n        {/* Popover target */}\n        <div\n          className=\"react-grid-item-content\"\n          style={{\n            ...tileStyle,\n            backgroundColor: tile && tile.color ? tile.color : \"\"\n          }}\n        >\n          <div\n            className=\"center\"\n            style={{\n              color: contentColor,\n              width: \"100%\",\n              maxHeight: tileStyle.maxHeight - 20,\n              overflow: \"hidden\"\n            }}\n          >\n            <p>{!isEmpty(tile) ? state.entities.room[tile.room].name : \"\"}</p>\n            <p>\n              {!isEmpty(tile)\n                ? tile.characters.map(char => (\n                    <Tooltip content={state.entities.character[char].name}>\n                      {state.entities.character[char].emoji}\n                    </Tooltip>\n                  ))\n                : \"\"}\n            </p>\n            <p>\n              {!isEmpty(tile)\n                ? tile.objects.map(obj => (\n                    <Tooltip content={state.entities.object[obj].name}>\n                      {state.entities.object[obj].emoji}\n                    </Tooltip>\n                  ))\n                : \"\"}\n            </p>\n          </div>\n        </div>\n        {/* Popover content */}\n        <div style={{ padding: \"20px\" }}>\n          <TileForm\n            initialInputs={tile}\n            onSubmit={handleSubmit}\n            onClear={handleClear}\n            entities={state.entities}\n            findOrAddEntity={state.findOrAddEntity}\n            setSelected={setSelected}\n            selected={selected}\n            setShowAdvanced={setShowAdvanced}\n          />\n        </div>\n      </Popover>\n    </>\n  );\n}\n\nexport default Tile;\n","import React from \"react\";\nimport { Formik } from \"formik\";\nimport {\n  Button,\n  Intent,\n  Icon,\n  Popover,\n  PopoverInteractionKind,\n  Tooltip\n} from \"@blueprintjs/core\";\nimport { isEmpty, cloneDeep } from \"lodash\";\nimport AnimateHeight from \"react-animate-height\";\nimport { Picker } from \"emoji-mart\";\nimport \"emoji-mart/css/emoji-mart.css\";\n\nimport ColorPicker from \"./ColorPicker\";\nimport BaseSuggest from \"./BaseSuggest\";\nimport BaseMultiSelect from \"./BaseMultiSelect\";\nimport {\n  TILE_COLORS,\n  findBiome,\n  invertColor,\n  findEmoji,\n  DEFAULT_EMOJI\n} from \"../worldbuilding/utils\";\nimport ObjectForm, { emptyObjectForm } from \"./ObjectForm\";\nimport CharacterForm, { emptyCharacterForm } from \"./CharacterForm\";\nimport RoomForm, { emptyRoomForm } from \"./RoomForm\";\nimport { emptyTileForm } from \"./TileForm\";\n\n/**\n * Advanced tile editing options including creating, editing, and duplicating entities\n */\nfunction AdvancedTileForm({\n  x,\n  y,\n  currFloor,\n  getTileAt,\n  initialInputs,\n  inheritedInputs,\n  handleSubmit,\n  handleClear,\n  tileStyle,\n  entities,\n  findOrAddEntity,\n  editEntity\n}) {\n  const TilePreview = ({ tile }) => {\n    const contentColor = invertColor(\n      tile && !isNaN(tile.room) && tile.color ? tile.color : \"#ced9e0\"\n    );\n    return (\n      <div style={{ display: \"flex\", justifyContent: \"center\" }}>\n        <div\n          style={{\n            position: \"relative\"\n          }}\n        >\n          <Icon\n            color={contentColor}\n            className={`react-grid-item-handle + ${\n              isNaN(tile.room) ? \"disabled\" : \"\"\n            }`}\n            icon=\"drag-handle-horizontal\"\n          />\n          {!isEmpty(tile) && !isEmpty(getTileAt(x, y, currFloor - 1)) && (\n            <Icon\n              color={contentColor}\n              className={isEmpty(tile) ? \"disabled\" : \"\"}\n              style={{\n                opacity: tile.stairDown ? 1 : 0.2,\n                position: \"absolute\",\n                bottom: \"5px\",\n                left: \"5px\"\n              }}\n              icon=\"arrow-bottom-left\"\n            />\n          )}\n          {!isEmpty(tile) && !isEmpty(getTileAt(x, y, currFloor + 1)) && (\n            <Icon\n              color={contentColor}\n              className={isEmpty(tile) ? \"disabled\" : \"\"}\n              style={{\n                opacity: tile.stairUp ? 1 : 0.2,\n                position: \"absolute\",\n                top: \"5px\",\n                right: \"5px\"\n              }}\n              icon=\"arrow-top-right\"\n            />\n          )}\n          <div\n            className=\"react-grid-item-content\"\n            style={{\n              ...tileStyle,\n              backgroundColor:\n                tile && !isNaN(tile.room) && tile.color ? tile.color : \"#ced9e0\"\n            }}\n          >\n            <div\n              className=\"center\"\n              style={{\n                color: contentColor,\n                width: \"100%\",\n                maxHeight: tileStyle.maxHeight - 20,\n                overflow: \"hidden\"\n              }}\n            >\n              {!isEmpty(tile) && entities.room[tile.room]\n                ? entities.room[tile.room].name\n                : \"\"}\n              <p>\n                {!isEmpty(tile)\n                  ? tile.characters.map(char => (\n                      <Tooltip content={entities.character[char].name}>\n                        {entities.character[char].emoji}\n                      </Tooltip>\n                    ))\n                  : \"\"}\n              </p>\n              <p>\n                {!isEmpty(tile)\n                  ? tile.objects.map(obj => (\n                      <Tooltip content={entities.object[obj].name}>\n                        {entities.object[obj].emoji}\n                      </Tooltip>\n                    ))\n                  : \"\"}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <Formik\n      initialValues={\n        inheritedInputs ||\n        (!isEmpty(initialInputs) ? initialInputs : undefined) ||\n        emptyTileForm\n      }\n      validate={values => {\n        let errors = {};\n        if (!values.room) {\n          errors.room = \"Required\";\n        }\n        return errors;\n      }}\n      isInitialValid={!!inheritedInputs && !!inheritedInputs.room}\n      onSubmit={handleSubmit}\n    >\n      {props => {\n        const {\n          values,\n          setFieldValue,\n          touched,\n          setFieldTouched,\n          errors,\n          dirty,\n          isValid,\n          handleSubmit,\n          handleReset\n        } = props;\n        const setRoomValue = (name, value, fullValue) => {\n          setFieldValue(name, value);\n          setFieldValue(\"color\", findBiome(fullValue.name, values.color));\n        };\n\n        const hasContent = () => {\n          return (\n            !isNaN(values.room) ||\n            !isEmpty(values.characters) ||\n            !isEmpty(values.objects)\n          );\n        };\n\n        return (\n          <>\n            <Hideable title=\"Room\">\n              <SelectFromExistingOrCreateNew\n                initialState={selectOrCreateState.CHOOSE}\n                SelectFromExisting={BaseSuggest}\n                selectFromExistingProps={{\n                  id: \"room-input\",\n                  errors: errors.room,\n                  touched: touched.room,\n                  setFieldTouched: setFieldTouched,\n                  onItemSelect: findOrAddEntity,\n                  entities: entities,\n                  handleChange: setRoomValue\n                }}\n                handleChange={setFieldValue}\n                formValue={values.room}\n                name=\"room\"\n                type=\"room\"\n                Form={RoomForm}\n                formProps={{\n                  initialInputs: emptyRoomForm\n                }}\n                handleCreateSubmit={data =>\n                  setRoomValue(\"room\", findOrAddEntity(data, \"room\"), data)\n                }\n                handleEditSubmit={editEntity}\n                Selected={SelectedTableView}\n                selectedProps={{\n                  columnNames: [\"Name\", \"Description\", \"Backstory\"],\n                  columnKeys: [\"name\", \"description\", \"backstory\"],\n                  items: !isNaN(values.room) ? [values.room] : undefined,\n                  entities,\n                  type: \"room\"\n                }}\n              ></SelectFromExistingOrCreateNew>\n              {errors.room && touched.room && (\n                <div className=\"form-error\">{errors.room}</div>\n              )}\n              <div style={{ marginTop: \"5px\" }}>\n                <ColorPicker\n                  colors={TILE_COLORS}\n                  value={values.color}\n                  handleChange={setFieldValue}\n                  advanced\n                />\n              </div>\n            </Hideable>\n            <Hideable\n              initialOpen={!isEmpty(values.characters)}\n              title=\"Characters\"\n            >\n              <SelectFromExistingOrCreateNew\n                SelectFromExisting={BaseMultiSelect}\n                selectFromExistingProps={{\n                  id: \"characters-input\",\n                  errors: errors.characters,\n                  touched: touched.characters,\n                  setFieldTouched: setFieldTouched,\n                  tooltip: \"physical_description\",\n                  onItemSelect: (e, type) => {\n                    e.emoji = findEmoji(e.name);\n                    return findOrAddEntity(e, type);\n                  },\n                  entities: entities,\n                  handleChange: setFieldValue\n                }}\n                handleChange={setFieldValue}\n                formValue={values.characters}\n                name=\"characters\"\n                type=\"character\"\n                Form={CharacterForm}\n                formProps={{\n                  initialInputs: emptyCharacterForm\n                }}\n                handleCreateSubmit={data => {\n                  data.emoji = findEmoji(data.name);\n                  setFieldValue(\n                    \"characters\",\n                    values.characters.concat(findOrAddEntity(data, \"character\"))\n                  );\n                }}\n                handleEditSubmit={editEntity}\n                Selected={SelectedTableView}\n                selectedProps={{\n                  columnNames: [\"Name\", \"Persona\", \"Emoji\"],\n                  columnKeys: [\"name\", \"persona\", \"emoji\"],\n                  items: values.characters,\n                  entities,\n                  type: \"character\",\n                  editEntity: editEntity\n                }}\n              />\n              {errors.characters && touched.characters && (\n                <div className=\"form-error\">{errors.characters}</div>\n              )}\n            </Hideable>\n            <Hideable initialOpen={!isEmpty(values.characters)} title=\"Objects\">\n              <SelectFromExistingOrCreateNew\n                SelectFromExisting={BaseMultiSelect}\n                selectFromExistingProps={{\n                  id: \"objects-input\",\n                  errors: errors.objects,\n                  touched: touched.objects,\n                  setFieldTouched: setFieldTouched,\n                  tooltip: \"physical_description\",\n                  onItemSelect: (e, type) => {\n                    e.emoji = findEmoji(e.name);\n                    return findOrAddEntity(e, type);\n                  },\n                  entities: entities,\n                  handleChange: setFieldValue\n                }}\n                handleChange={setFieldValue}\n                formValue={values.objects}\n                name=\"objects\"\n                type=\"object\"\n                Form={ObjectForm}\n                formProps={{\n                  initialInputs: emptyObjectForm\n                }}\n                handleCreateSubmit={data => {\n                  data.emoji = findEmoji(data.name);\n                  setFieldValue(\n                    \"objects\",\n                    values.objects.concat(findOrAddEntity(data, \"object\"))\n                  );\n                }}\n                handleEditSubmit={editEntity}\n                Selected={SelectedTableView}\n                selectedProps={{\n                  columnNames: [\"Name\", \"Description\", \"emoji\"],\n                  columnKeys: [\"name\", \"physical_description\", \"emoji\"],\n                  items: values.objects,\n                  entities,\n                  type: \"object\",\n                  editEntity: editEntity\n                }}\n              />\n              {errors.objects && touched.objects && (\n                <div className=\"form-error\">{errors.objects}</div>\n              )}\n            </Hideable>\n            <Hideable title=\"Preview\">\n              <TilePreview tile={values} />\n            </Hideable>\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"flex-end\",\n                padding: \"10px\"\n              }}\n            >\n              <Button\n                type=\"reset\"\n                onClick={handleClear}\n                disabled={!hasContent()}\n                style={{ marginRight: \"15px\" }}\n              >\n                Clear\n              </Button>\n              <Button\n                type=\"reset\"\n                onClick={handleReset}\n                disabled={!dirty}\n                style={{ marginRight: \"15px\" }}\n              >\n                Reset\n              </Button>\n              <Button\n                intent={Intent.PRIMARY}\n                type=\"submit\"\n                onClick={handleSubmit}\n                disabled={!isValid}\n                style={{ marginLeft: \"15px\" }}\n              >\n                Save Changes\n              </Button>\n            </div>\n          </>\n        );\n      }}\n    </Formik>\n  );\n}\n\n// Container for children that allows children to be hidden\nfunction Hideable({ initialOpen = true, children, title }) {\n  const [open, setOpen] = React.useState(initialOpen);\n\n  return (\n    <div style={{ margin: \"0 0 10px 0\" }}>\n      <div\n        onClick={() => setOpen(!open)}\n        className={`hideable-header ${open ? \"\" : \"hidden\"}`}\n      >\n        <Icon\n          className={`hideable-arrow ${open ? \"\" : \"hidden\"}`}\n          icon=\"chevron-down\"\n        />{\" \"}\n        {title}\n      </div>\n      <AnimateHeight\n        duration={500}\n        height={open ? \"auto\" : 0}\n        easing={\"ease\"}\n        animateOpacity={true}\n      >\n        <div className={`hideable-content`}>{children}</div>\n      </AnimateHeight>\n    </div>\n  );\n}\n\n// A table view for all selected entities with actions\nfunction SelectedTableView({\n  columnNames,\n  columnKeys,\n  items,\n  entities,\n  handleEdit,\n  handleDuplicate,\n  handleDelete,\n  type,\n  editEntity\n}) {\n  function EmojiTD({ item }) {\n    const [showPicker, setShowPicker] = React.useState(false);\n    return (\n      <Popover\n        interactionKind={PopoverInteractionKind.CLICK}\n        onInteraction={state => setShowPicker(state)}\n        isOpen={showPicker}\n        wrapperTagName=\"td\"\n      >\n        <div\n          // onClick={() => setShowPicker(!showPicker)}\n          style={{ height: \"100%\", width: \"100%\" }}\n        >\n          {entities[type][item].emoji || DEFAULT_EMOJI}\n        </div>\n        <Picker\n          onSelect={event => {\n            const data = cloneDeep(entities[type][item]);\n            data.emoji = event.native;\n            editEntity(item, data, type);\n            setShowPicker(false);\n          }}\n        />\n      </Popover>\n    );\n  }\n  return (\n    <>\n      {!isEmpty(items) && (\n        <table\n          data-testid=\"table-explore\"\n          style={{ width: \"100%\" }}\n          className=\"bp3-html-table bp3-html-table-striped bp3-html-table-condensed bp3-interactive\"\n        >\n          <thead>\n            <tr>\n              {columnNames.map((col, index) => (\n                <th key={index}>{col}</th>\n              ))}\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {items.map((item, index) => {\n              return (\n                <React.Fragment key={index}>\n                  <tr>\n                    {columnKeys.map(key => {\n                      if (key === \"emoji\") {\n                        return <EmojiTD item={item} key={key} />;\n                      }\n                      return <td key={key}>{entities[type][item][key]}</td>;\n                    })}\n                    <td>\n                      <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n                        <Button\n                          onClick={() => handleEdit(item, entities[type][item])}\n                          icon=\"edit\"\n                          minimal\n                        />\n                        <Button\n                          onClick={() => handleDuplicate(entities[type][item])}\n                          icon=\"duplicate\"\n                          minimal\n                        />\n                        <Button\n                          onClick={() => handleDelete(index)}\n                          icon=\"trash\"\n                          minimal\n                        />\n                      </div>\n                    </td>\n                  </tr>\n                </React.Fragment>\n              );\n            })}\n          </tbody>\n        </table>\n      )}\n    </>\n  );\n}\n\nconst selectOrCreateState = {\n  BASE: 0,\n  CHOOSE: 1,\n  SELECT_FROM_EXISTING: 2,\n  CREATE_NEW: 3,\n  EDIT: 4,\n  DUPLICATE: 5\n};\n\n// Input type component that includes the selected table,\n// a component for selecting from existing,\n// and a form for creating new/editing/duplicating\nfunction SelectFromExistingOrCreateNew({\n  initialState = selectOrCreateState.BASE,\n  handleChange,\n  name,\n  type,\n  formValue,\n  SelectFromExisting,\n  selectFromExistingProps,\n  Form,\n  formProps,\n  handleCreateSubmit,\n  handleEditSubmit,\n  Selected,\n  selectedProps\n}) {\n  const [state, setState] = React.useState(initialState);\n  const [editing, setEditing] = React.useState(undefined);\n  const [duplicating, setDuplicating] = React.useState(undefined);\n\n  const handleEditClick = (id, data) => {\n    setEditing({ id, data });\n    setState(selectOrCreateState.EDIT);\n  };\n\n  const handleDuplicate = data => {\n    setDuplicating(data);\n    setState(selectOrCreateState.DUPLICATE);\n  };\n\n  const handleDelete = index => {\n    if (Array.isArray(formValue)) {\n      formValue.splice(index, 1);\n      handleChange(name, formValue);\n    } else {\n      handleChange(name, undefined);\n    }\n  };\n\n  return (\n    <>\n      <Selected\n        {...selectedProps}\n        handleEdit={handleEditClick}\n        handleDuplicate={handleDuplicate}\n        handleDelete={handleDelete}\n      />\n      {state === selectOrCreateState.CHOOSE ? (\n        // choose between creating new or selecting from existing\n        <div\n          style={{\n            display: \"flex\",\n            justifyContent: \"center\",\n            flexDirection: \"row\",\n            alignItems: \"center\",\n            padding: \"5px\"\n          }}\n        >\n          <Button\n            onClick={() => setState(selectOrCreateState.SELECT_FROM_EXISTING)}\n            style={{ margin: \"5px\" }}\n          >\n            Select from existing\n          </Button>\n          <span style={{ margin: \"5px\" }}> OR </span>\n          <Button\n            onClick={() => setState(selectOrCreateState.CREATE_NEW)}\n            style={{ margin: \"5px\" }}\n          >\n            Create New\n          </Button>\n        </div>\n      ) : state === selectOrCreateState.SELECT_FROM_EXISTING ? (\n        // selecting from existing\n        <div>\n          <Button\n            onClick={() => setState(initialState)}\n            icon=\"chevron-left\"\n            minimal\n          />\n          <SelectFromExisting\n            {...selectFromExistingProps}\n            name={name}\n            type={type}\n            formValue={formValue}\n          />\n        </div>\n      ) : state === selectOrCreateState.CREATE_NEW ? (\n        // creating new\n        <div>\n          <Button\n            onClick={() => setState(initialState)}\n            icon=\"chevron-left\"\n            minimal\n          />\n          <Form\n            {...formProps}\n            type={type}\n            handleSubmit={value => {\n              setState(initialState);\n              handleCreateSubmit(value);\n            }}\n          />\n        </div>\n      ) : state === selectOrCreateState.EDIT ? (\n        // editing\n        <div>\n          <Button\n            onClick={() => setState(initialState)}\n            icon=\"chevron-left\"\n            minimal\n          />\n          <Form\n            {...formProps}\n            type={type}\n            initialInputs={editing.data}\n            handleSubmit={value => {\n              setState(initialState);\n              handleEditSubmit(editing.id, value, type);\n              setEditing(undefined);\n            }}\n          />\n        </div>\n      ) : state === selectOrCreateState.DUPLICATE ? (\n        // duplicating\n        <div>\n          <Button\n            onClick={() => setState(initialState)}\n            icon=\"chevron-left\"\n            minimal\n          />\n          <Form\n            {...formProps}\n            type={type}\n            initialInputs={duplicating}\n            handleSubmit={value => {\n              setState(initialState);\n              handleCreateSubmit(value);\n              setDuplicating(undefined);\n            }}\n          />\n        </div>\n      ) : (\n        <Button onClick={() => setState(selectOrCreateState.CHOOSE)} icon=\"add\">\n          Add\n        </Button>\n      )}\n    </>\n  );\n}\n\nexport default AdvancedTileForm;\n","import React from \"react\";\nimport GridLayout from \"react-grid-layout\";\nimport { cloneDeep, isEmpty, isEqual } from \"lodash\";\nimport { Button, Drawer, Classes } from \"@blueprintjs/core\";\n\nimport Tile from \"./Tile\";\nimport { MAX_HEIGHT, MAX_WIDTH } from \"./utils\";\nimport AdvancedTileForm from \"../forms/AdvancedTileForm\";\n\nconst SIZE = 150;\nconst MARGIN = 24;\n\n/**\n * Component for the interactive grid.\n * Using react-grid-layout for the draggable interface with some custom drag behavior to maintain\n * grid dimensions and update map state.\n */\nfunction Grid({ state, initialShowAdvanced }) {\n  const [layout, setLayout] = React.useState(null);\n  const [selected, setSelected] = React.useState(null);\n  const [showAdvanced, setShowAdvanced] = React.useState(false);\n  const [dragging, setDragging] = React.useState(false);\n\n  React.useEffect(() => {\n    setShowAdvanced(initialShowAdvanced);\n  }, [initialShowAdvanced]);\n\n  const resetShowAdvanced = () => {\n    setShowAdvanced(initialShowAdvanced);\n  };\n\n  // store the initial layout of the grid\n  const onDragStart = layout => {\n    setLayout(cloneDeep(layout));\n  };\n\n  // prevent column growing by swapping position with colliding tile\n  const onDragEvent = (newState, initial, next) => {\n    if (!isEqual(initial, next)) {\n      setDragging(true);\n      setSelected(null);\n    }\n    for (let i = 0; i < layout.length; i++) {\n      if (layout[i].i === next.i) {\n        continue;\n      }\n      if (\n        layout[i].x === next.x &&\n        layout[i].y === next.y &&\n        layout[i].i !== next.i\n      ) {\n        newState[i].x = initial.x;\n        newState[i].y = initial.y;\n      } else {\n        newState[i].x = layout[i].x;\n        newState[i].y = layout[i].y;\n      }\n    }\n\n    return true;\n  };\n\n  // sets up for the layout to be updated in the superstate\n  const onDragStop = (newState, initial, next) => {\n    onDragEvent(newState, initial, next);\n    setLayout([initial.x, initial.y, next.x, next.y]);\n  };\n\n  // update superstate (updating in onDragStop causes tiles to vanish)\n  const handleLayoutChange = () => {\n    if (layout) {\n      const [x1, y1, x2, y2] = layout;\n      if (!(x1 === x2 && y1 === y2)) {\n        // allows the animation to finish\n        setTimeout(() => state.swapTiles(x1, y1, x2, y2), 300);\n      }\n      setLayout(null);\n    }\n  };\n\n  // Generate children for GridLayout component\n  const generateTiles = () => {\n    const tiles = [];\n    for (let i = 0; i < state.dimensions.height; i++) {\n      for (let j = 0; j < state.dimensions.width; j++) {\n        // tile will contain all form data and stair data, or be empty\n        const tile = state.getTileAt(j, i, state.currFloor);\n        // tile data is used in the key to force GridLayout to rerender the div component\n        // and update isDraggable under data-grid\n        const key = `${state.currFloor} ${j} ${i} ${\n          tile && tile && tile.room ? tile.room.id : \"\"\n        }`;\n        tiles.push(\n          <div\n            key={key}\n            data-grid={{\n              x: j,\n              y: i,\n              w: 1,\n              h: 1,\n              draggableHandle: \".react-grid-item-handle\",\n              draggableCancel: \".react-grid-item\",\n              isDraggable: !isEmpty(tile)\n            }}\n            onClick={() => {\n              if (\n                !dragging &&\n                (!selected ||\n                  (selected && (selected.x !== j || selected.y !== i)))\n              ) {\n                setSelected({ x: j, y: i });\n              } else {\n                setDragging(false);\n              }\n            }}\n          >\n            <Tile\n              x={j}\n              y={i}\n              tile={tile}\n              selected={selected}\n              setSelected={setSelected}\n              showAdvanced={showAdvanced}\n              setShowAdvanced={setShowAdvanced}\n              setTile={state.setTile}\n              clearTile={state.clearTile}\n              getTileAt={state.getTileAt}\n              currFloor={state.currFloor}\n              tileStyle={{\n                width: SIZE,\n                height: SIZE,\n                maxWidth: SIZE,\n                maxHeight: SIZE\n              }}\n              state={state}\n            />\n          </div>\n        );\n      }\n    }\n    return tiles;\n  };\n\n  // Generate all walls for the floor\n  const generateWalls = () => {\n    const walls = [];\n    for (let i = 0; i < state.dimensions.height; i++) {\n      for (let j = 0; j < state.dimensions.width; j++) {\n        // vertical walls\n        if (j > 0) {\n          const key = `${j - 1} ${i}|${j} ${i}`;\n          walls.push(\n            <div\n              key={key}\n              onClick={() => state.toggleWall(key)}\n              className={`wall ${\n                state.map[state.currFloor].walls[key] ? \"active\" : \"\"\n              }`}\n              style={{\n                top: MARGIN + (MARGIN + SIZE) * i,\n                left: (MARGIN + SIZE) * j + (MARGIN - 10) / 2,\n                height: SIZE\n              }}\n            />\n          );\n        }\n        // horizontal walls\n        if (i > 0) {\n          const key = `${j} ${i - 1}|${j} ${i}`;\n          walls.push(\n            <div\n              key={key}\n              onClick={() => state.toggleWall(key)}\n              className={`wall ${\n                state.map[state.currFloor].walls[key] ? \"active\" : \"\"\n              }`}\n              style={{\n                left: MARGIN + (MARGIN + SIZE) * j,\n                top: (MARGIN + SIZE) * i + (MARGIN - 10) / 2,\n                width: SIZE\n              }}\n            />\n          );\n        }\n      }\n    }\n    return walls;\n  };\n\n  return (\n    <>\n      <div\n        style={{\n          width:\n            state.dimensions.width * SIZE +\n            (state.dimensions.width + 1) * MARGIN +\n            60,\n          margin: \"0 auto 75px auto\",\n          textAlign: \"center\"\n        }}\n      >\n        <Button\n          className=\"bp3-button\"\n          disabled={state.dimensions.height >= 10}\n          style={{\n            width:\n              state.dimensions.width * SIZE +\n              (state.dimensions.width + 1) * MARGIN -\n              20,\n            margin: \"auto\"\n          }}\n          onClick={state.addRowTop}\n          icon=\"add\"\n        />\n        <div style={{ display: \"flex\" }}>\n          <Button\n            className=\"bp3-button\"\n            disabled={state.dimensions.width >= 10}\n            style={{\n              height:\n                state.dimensions.height * SIZE +\n                (state.dimensions.height + 1) * MARGIN -\n                20,\n              margin: \"10px 0\"\n            }}\n            onClick={state.addColFront}\n            icon=\"add\"\n          />\n          <div\n            className=\"map-container\"\n            style={{\n              width:\n                state.dimensions.width * SIZE +\n                (state.dimensions.width + 1) * MARGIN,\n              height:\n                state.dimensions.height * SIZE +\n                (state.dimensions.height + 1) * MARGIN\n            }}\n          >\n            <div className=\"walls\">{generateWalls()}</div>\n            <GridLayout\n              cols={state.dimensions.width}\n              rowHeight={SIZE}\n              width={\n                state.dimensions.width * SIZE +\n                (state.dimensions.width + 1) * MARGIN\n              }\n              onDragStart={onDragStart}\n              onDrag={onDragEvent}\n              onDragStop={onDragStop}\n              margin={[MARGIN, MARGIN]}\n              onLayoutChange={handleLayoutChange}\n              isResizable={false}\n              maxRows={state.dimensions.height}\n              style={{\n                width:\n                  state.dimensions.width * SIZE +\n                  (state.dimensions.width + 1) * MARGIN\n              }}\n            >\n              {generateTiles()}\n            </GridLayout>\n          </div>\n          <Button\n            className=\"bp3-button\"\n            disabled={state.dimensions.width >= MAX_WIDTH}\n            style={{\n              height:\n                state.dimensions.height * SIZE +\n                (state.dimensions.height + 1) * MARGIN -\n                20,\n              margin: \"10px 0\"\n            }}\n            onClick={state.addColEnd}\n            icon=\"add\"\n          />\n        </div>\n        <Button\n          className=\"bp3-button\"\n          disabled={state.dimensions.height >= MAX_HEIGHT}\n          style={{\n            width:\n              state.dimensions.width * SIZE +\n              (state.dimensions.width + 1) * MARGIN -\n              20,\n            margin: \"auto\"\n          }}\n          onClick={state.addRowBot}\n          icon=\"add\"\n        />\n      </div>\n      <AdvancedEditor\n        showAdvanced={showAdvanced}\n        selected={selected}\n        setSelected={setSelected}\n        resetShowAdvanced={resetShowAdvanced}\n        state={state}\n      />\n    </>\n  );\n}\n\nfunction AdvancedEditor({\n  selected,\n  setSelected,\n  resetShowAdvanced,\n  showAdvanced,\n  state\n}) {\n  const handleSubmit = data => {\n    state.setTile(selected.x, selected.y, {\n      ...state.getTileAt(selected.x, selected.y),\n      ...data\n    });\n    setSelected(null);\n    resetShowAdvanced();\n  };\n\n  const handleClear = () => {\n    state.clearTile(selected.x, selected.y);\n    setSelected(null);\n    resetShowAdvanced();\n  };\n\n  return (\n    <Drawer\n      icon=\"build\"\n      title=\"Build Tile\"\n      isOpen={showAdvanced && selected}\n      onClose={() => {\n        setSelected(null);\n        resetShowAdvanced();\n      }}\n    >\n      <div className={Classes.DRAWER_BODY}>\n        <div className={Classes.DIALOG_BODY}>\n          {selected && (\n            <AdvancedTileForm\n              x={selected.x}\n              y={selected.y}\n              currFloor={state.currFloor}\n              getTileAt={state.getTileAt}\n              initialInputs={state.getTileAt(selected.x, selected.y)}\n              inheritedInputs={selected.data}\n              handleSubmit={handleSubmit}\n              handleClear={handleClear}\n              tileStyle={{\n                width: SIZE,\n                height: SIZE,\n                maxWidth: SIZE,\n                maxHeight: SIZE\n              }}\n              entities={state.entities}\n              findOrAddEntity={state.findOrAddEntity}\n              editEntity={state.editEntity}\n            />\n          )}\n        </div>\n      </div>\n    </Drawer>\n  );\n}\n\nexport default Grid;\n","import React from \"react\";\nimport {\n  ContextMenuTarget,\n  Menu,\n  MenuItem,\n  Button,\n  InputGroup,\n  Alert,\n  Intent\n} from \"@blueprintjs/core\";\nimport Reorder from \"react-reorder\";\nimport createReactClass from \"create-react-class\";\nimport { isEmpty } from \"lodash\";\n\nimport { MAX_FLOORS } from \"./utils\";\n\n/**\n * Component for interacting with floors of the map.\n * Uses react-reorder for the reorderable list.\n */\nfunction FloorSelector({ manager, map, currFloor }) {\n  // Prevents switching floors on a context click (which can cause several components to remount and break links)\n  const [contextShowing, setContextShowing] = React.useState(false);\n  const [editing, setEditing] = React.useState(null);\n  // Contains all data for a confirm alert (on Delete, or Reorder actions)\n  const [confirmAlert, setConfirmAlert] = React.useState({});\n  const inputRef = React.createRef();\n\n  const floors = map.map(({ name }, index) => {\n    return { name, index };\n  });\n\n  // Template component for each Floor Button\n  const FloorButton = ContextMenuTarget(\n    createReactClass({\n      keypressHandler: function(event) {\n        if (event.key === \"Enter\") {\n          inputRef.current.blur();\n        }\n      },\n      renderContextMenu: function() {\n        setContextShowing(true);\n        return (\n          <Menu>\n            <MenuItem\n              icon=\"edit\"\n              onClick={() => setEditing(this.props.item.index)}\n              text=\"Edit Floor Name\"\n            />\n            <MenuItem\n              icon=\"delete\"\n              disabled={floors.length <= 1}\n              onClick={() => {\n                setConfirmAlert({\n                  confirmButtonText: \"Confirm Delete\",\n                  icon: \"trash\",\n                  intent: Intent.DANGER,\n                  onConfirm: () => {\n                    manager.deleteFloor(this.props.item.index);\n                    setConfirmAlert({});\n                  },\n                  content: `Are you sure you want to delete the entire ${this.props.item.name} floor? All data on this floor and connections to this floor will be reset.`\n                });\n              }}\n              text=\"Delete Floor\"\n            />\n          </Menu>\n        );\n      },\n      onContextMenuClose: function() {\n        setContextShowing(false);\n      },\n      handleBlur: function(e) {\n        manager.editFloorName(e.target.value, this.props.item.index);\n        setEditing(null);\n      },\n      componentDidMount: function() {\n        if (editing === this.props.item.index) {\n          inputRef.current.focus();\n          inputRef.current.select();\n        }\n      },\n      render: function() {\n        return (\n          <div\n            style={{\n              textAlign: \"center\",\n              width: \"100%\",\n              height: \"100%\",\n              lineHeight: \"30px\",\n              padding: \"0px 5px\"\n            }}\n          >\n            {editing !== null && editing === this.props.item.index ? (\n              <InputGroup\n                inputRef={inputRef}\n                onBlur={this.handleBlur}\n                defaultValue={this.props.item.name}\n                onKeyPress={event => this.keypressHandler(event)}\n              />\n            ) : (\n              <div>{this.props.item.name}</div>\n            )}\n          </div>\n        );\n      }\n    })\n  );\n\n  // Prevent floor selection if context or editing has been triggered (prevents unintended switching)\n  const selectFloor = (_e, _floor, index) => {\n    if (!contextShowing && !editing) {\n      manager.setCurrFloor(index);\n    }\n  };\n\n  const handleReorder = (_e, _floor, initialIndex, newIndex) => {\n    if (initialIndex !== newIndex) {\n      setConfirmAlert({\n        confirmButtonText: \"Confirm Reorder\",\n        icon: \"layers\",\n        intent: Intent.WARNING,\n        onConfirm: () => {\n          manager.reorderFloors(initialIndex, newIndex);\n          setConfirmAlert({});\n        },\n        content: `Are you sure you want to reorder the entire ${floors[newIndex].name} floor? All connections to and from this floor, in both positions, will be reset.`\n      });\n    }\n  };\n\n  return (\n    <>\n      <Alert\n        confirmButtonText={confirmAlert.confirmButtonText}\n        cancelButtonText=\"Cancel\"\n        icon={confirmAlert.icon}\n        intent={confirmAlert.intent}\n        isOpen={!isEmpty(confirmAlert)}\n        onCancel={() => {\n          if (confirmAlert.onCancel) {\n            confirmAlert.onCancel();\n          }\n          setConfirmAlert({});\n        }}\n        onConfirm={confirmAlert.onConfirm}\n      >\n        <p>{confirmAlert.content}</p>\n      </Alert>\n      <div\n        style={{\n          display: \"flex\"\n        }}\n      >\n        <Button\n          disabled={map.length >= MAX_FLOORS}\n          icon=\"add\"\n          onClick={manager.addFloor}\n          style={{\n            height: \"30px\"\n          }}\n        />\n        <Reorder\n          holdTime=\"200\"\n          callback={handleReorder}\n          template={FloorButton}\n          itemKey=\"index\"\n          list={floors}\n          selected={floors[currFloor]}\n          itemClicked={selectFloor}\n          lock=\"vertical\"\n          itemClass=\"bp3-button floor-button\"\n        />\n      </div>\n    </>\n  );\n}\n\nexport default FloorSelector;\n","import React from \"react\";\nimport {\n  NumericInput,\n  ControlGroup,\n  FormGroup,\n  Tooltip,\n  Position,\n  Icon,\n  Switch,\n  Button\n} from \"@blueprintjs/core\";\n\nimport {\n  useWorldBuilder,\n  MAX_HEIGHT,\n  MAX_WIDTH,\n  MAX_FLOORS\n} from \"./worldbuilding/utils\";\nimport Grid from \"./worldbuilding/Grid\";\nimport FloorSelector from \"./worldbuilding/FloorSelector\";\n\nfunction WorldBuilderPage({ location }) {\n  return (\n    <div>\n      <h2 data-testid=\"header\" className=\"bp3-heading\">\n        World Builder\n      </h2>\n      <div>\n        <WorldBuilder upload={location.state} />\n      </div>\n    </div>\n  );\n}\n\nfunction WorldBuilder({ upload }) {\n  const state = useWorldBuilder(upload);\n  const [advanced, setAdvanced] = React.useState(false);\n\n  return (\n    <>\n      <FormGroup\n        inline\n        label=\"World Dimensions\"\n        labelInfo={`WxH (Max ${MAX_WIDTH}x${MAX_HEIGHT})`}\n      >\n        <ControlGroup>\n          <NumericInput\n            value={state.dimensions.width}\n            style={{ width: \"3rem\" }}\n            max={MAX_WIDTH}\n            min={1}\n            onValueChange={value => {\n              state.setDimensions({ ...state.dimensions, width: value });\n            }}\n          />\n\n          <NumericInput\n            value={state.dimensions.height}\n            style={{ width: \"3rem\" }}\n            max={MAX_HEIGHT}\n            min={1}\n            onValueChange={value => {\n              state.setDimensions({ ...state.dimensions, height: value });\n            }}\n          />\n        </ControlGroup>\n      </FormGroup>\n      <FormGroup\n        inline\n        label={\n          <>\n            Floor{\" \"}\n            <Tooltip\n              content={\n                \"Right click floor for more options. Click and hold floor to reorder.\"\n              }\n              position={Position.BOTTOM}\n              className=\"inline\"\n            >\n              <Icon icon=\"help\" />\n            </Tooltip>\n          </>\n        }\n        labelInfo={`Max ${MAX_FLOORS}`}\n        style={{ marginBottom: \"0px\" }}\n      >\n        <FloorSelector\n          max={MAX_FLOORS}\n          manager={state.floorManager}\n          map={state.map}\n          currFloor={state.currFloor}\n        />\n      </FormGroup>\n      <FormGroup inline label=\"Advanced\">\n        <Switch onChange={() => setAdvanced(!advanced)} checked={!!advanced} />\n      </FormGroup>\n      <Grid state={state} initialShowAdvanced={advanced} />\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"flex-end\",\n          position: \"fixed\",\n          bottom: 0,\n          left: 0,\n          right: 0,\n          height: \"50px\"\n        }}\n        className=\"bp3-navbar\"\n      >\n        <Button\n          onClick={state.exportWorld}\n          intent=\"primary\"\n          style={{ margin: \"10px\" }}\n        >\n          Export\n        </Button>\n        <Button\n          onClick={state.postEdges}\n          intent=\"primary\"\n          style={{ margin: \"10px\" }}\n        >\n          Commit Edges\n        </Button>\n      </div>\n    </>\n  );\n}\n\nexport default WorldBuilderPage;\n","import React from \"react\";\nimport { isEmpty } from \"lodash\";\nimport { Button, Classes, Dialog, Intent, Spinner } from \"@blueprintjs/core\";\nimport { useHistory } from \"react-router-dom\";\n\nimport CONFIG from \"../config\";\nimport { useAPI, post } from \"../utils\";\nimport ObjectForm from \"./forms/ObjectForm\";\nimport CharacterForm from \"./forms/CharacterForm\";\nimport RoomForm from \"./forms/RoomForm\";\nimport AppToaster from \"./AppToaster\";\n\nfunction EditPage({ match, location }) {\n  const [formType, setFormType] = React.useState(undefined);\n  const { loading, result } = useAPI(\n    CONFIG,\n    `/entities/${match.params.id}`,\n    {},\n    location.state\n  );\n  const [initialInputs, setInitialInputs] = React.useState({});\n  const [showDialog, setShowDialog] = React.useState(false);\n  const [pendingEdits, setPendingEdits] = React.useState([]);\n  const history = useHistory();\n\n  if (!loading && isEmpty(initialInputs)) {\n    if (isEmpty(result) || isEmpty(result.entity)) {\n      setInitialInputs({ id: match.params.id });\n      setFormType(\"invalid\");\n    } else {\n      setInitialInputs(result.entity);\n      setFormType(result.type);\n    }\n  }\n\n  const showEdits = values => {\n    const edits = [];\n    for (let property in values) {\n      if (values[property] !== initialInputs[property]) {\n        edits.push({ property: property, editedValue: values[property] });\n      }\n    }\n    setPendingEdits(edits);\n    setShowDialog(true);\n  };\n\n  return (\n    <div>\n      <Dialog\n        icon=\"info-sign\"\n        onClose={() => setShowDialog(false)}\n        title={`Confirm edits for Entity ${match.params.id}`}\n        isOpen={showDialog}\n        usePortal={false}\n      >\n        <div className={Classes.DIALOG_BODY}>\n          {pendingEdits.map((edit, index) => {\n            return (\n              <p key={index}>\n                <strong>{edit.property}</strong>: {edit.editedValue.toString()}\n              </p>\n            );\n          })}\n        </div>\n        <div className={Classes.DIALOG_FOOTER}>\n          <div className={Classes.DIALOG_FOOTER_ACTIONS}>\n            <Button onClick={() => setShowDialog(false)}>Close</Button>\n            <Button\n              intent={Intent.PRIMARY}\n              onClick={() =>\n                submitEdits(match.params.id, pendingEdits, history)\n              }\n            >\n              Confirm Edits\n            </Button>\n          </div>\n        </div>\n      </Dialog>\n      <h2 data-testid=\"header\" className=\"bp3-heading\">\n        Editing Entity {match.params.id}\n      </h2>\n      <div className=\"bp3-text-large\">\n        {loading ? (\n          <Spinner intent={Intent.PRIMARY} />\n        ) : (\n          <EditForm\n            type={formType}\n            initialInputs={initialInputs}\n            handleSubmit={showEdits}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction EditForm({ type, initialInputs, handleSubmit }) {\n  switch (type) {\n    case \"object\":\n      return (\n        <ObjectForm\n          type={type}\n          initialInputs={initialInputs}\n          handleSubmit={handleSubmit}\n        />\n      );\n    case \"character\":\n      return (\n        <CharacterForm\n          type={type}\n          initialInputs={initialInputs}\n          handleSubmit={handleSubmit}\n        />\n      );\n    case \"room\":\n      return (\n        <RoomForm\n          type={type}\n          initialInputs={initialInputs}\n          handleSubmit={handleSubmit}\n        />\n      );\n    default:\n      return \"This entity cannot be edited at the moment\";\n  }\n}\n\nasync function submitEdits(id, edits, history) {\n  const reqs = edits.map(edit =>\n    submitEdit(id, edit.property, edit.editedValue)\n  );\n  await Promise.all(reqs).then(() => {\n    history.push(\"/\");\n  });\n  AppToaster.show({\n    intent: Intent.SUCCESS,\n    message: \"Successfully created edits\"\n  });\n}\n\nfunction submitEdit(id, field, edited_value) {\n  const payload = {\n    id,\n    field,\n    edited_value,\n    player: 1\n  };\n\n  return post(\"edits\", payload);\n}\n\nexport default EditPage;\n","import React from \"react\";\nimport  {HashRouter, Route, Redirect} from \"react-router-dom\";\n\nimport NavBar from \"./components/NavBar\";\nimport ExplorePage from \"./components/ExplorePage\";\nimport CreatePage from \"./components/CreatePage\";\nimport ReviewPage from \"./components/ReviewPage\";\nimport WorldBuilderPage from \"./components/WorldBuilderPage\";\nimport EditPage from \"./components/EditPage\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <HashRouter>\n        <Routes />\n      </HashRouter>\n    </div>\n  );\n}\n\nexport function Routes() {\n  return (\n    <>\n      <NavBar />\n      <div style={{ margin: \"40px 30px\" }}>\n        <Route path=\"/explore\" component={ExplorePage} exact/>\n        <Route path=\"/create\" component={CreatePage} exact/>\n        <Route path=\"/review\" component={ReviewPage} exact/>\n        <Route\n          path=\"/world_builder\"\n          render={props => <WorldBuilderPage {...props} key={Math.random()} exact/>}\n        />\n        <Route path=\"/edit/:id\" component={EditPage} exact/>\n        <Route exact path=\"/\" render={() => <Redirect to=\"/explore\" />} exact/>\n      </div>\n    </>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nimport \"normalize.css\";\nimport \"@blueprintjs/core/lib/css/blueprint.css\";\nimport \"@blueprintjs/icons/lib/css/blueprint-icons.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}